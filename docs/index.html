<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Sports Analytics</title>
  <meta name="description" content="Sports Analytics Notes" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Sports Analytics" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://aaron-nielsen.github.io/SportsAnalyticsBook/images/csu.png" />
  <meta property="og:description" content="Sports Analytics Notes" />
  <meta name="github-repo" content="aaron-nielsen.github.io/SportsAnalyticsBook/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Sports Analytics" />
  
  <meta name="twitter:description" content="Sports Analytics Notes" />
  <meta name="twitter:image" content="https://aaron-nielsen.github.io/SportsAnalyticsBook/images/csu.png" />

<meta name="author" content="Aaron Nielsen, Department of Statistics, Colorado State University" />


<meta name="date" content="2022-07-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />

<link rel="next" href="probability.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Sports Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#getting-started-with-r"><i class="fa fa-check"></i><b>0.1</b> Getting Started With R</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#installing-r"><i class="fa fa-check"></i><b>0.1.1</b> Installing R</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#some-r-basics"><i class="fa fa-check"></i><b>0.1.2</b> Some R Basics</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#descriptive-statistics"><i class="fa fa-check"></i><b>0.2</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#definitions"><i class="fa fa-check"></i><b>0.2.1</b> Definitions</a></li>
<li class="chapter" data-level="0.2.2" data-path="index.html"><a href="index.html#descriptive-statistics-1"><i class="fa fa-check"></i><b>0.2.2</b> Descriptive Statistics</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#visualizations"><i class="fa fa-check"></i><b>0.3</b> Visualizations</a>
<ul>
<li class="chapter" data-level="0.3.1" data-path="index.html"><a href="index.html#histograms"><i class="fa fa-check"></i><b>0.3.1</b> Histograms</a></li>
<li class="chapter" data-level="0.3.2" data-path="index.html"><a href="index.html#bar-plots"><i class="fa fa-check"></i><b>0.3.2</b> Bar Plots</a></li>
<li class="chapter" data-level="0.3.3" data-path="index.html"><a href="index.html#scatter-plots"><i class="fa fa-check"></i><b>0.3.3</b> Scatter Plots</a></li>
<li class="chapter" data-level="0.3.4" data-path="index.html"><a href="index.html#kable-tables"><i class="fa fa-check"></i><b>0.3.4</b> Kable Tables</a></li>
</ul></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#baseball"><i class="fa fa-check"></i><b>0.4</b> Baseball</a>
<ul>
<li class="chapter" data-level="0.4.1" data-path="index.html"><a href="index.html#basic-hitting-statistics"><i class="fa fa-check"></i><b>0.4.1</b> Basic Hitting Statistics</a></li>
<li class="chapter" data-level="0.4.2" data-path="index.html"><a href="index.html#basic-pitching-statistics"><i class="fa fa-check"></i><b>0.4.2</b> Basic Pitching Statistics</a></li>
<li class="chapter" data-level="0.4.3" data-path="index.html"><a href="index.html#advanced-baseball-hitting-statistics"><i class="fa fa-check"></i><b>0.4.3</b> Advanced Baseball Hitting Statistics</a></li>
<li class="chapter" data-level="0.4.4" data-path="index.html"><a href="index.html#advanced-baseball-pitching-statistics"><i class="fa fa-check"></i><b>0.4.4</b> Advanced Baseball Pitching Statistics</a></li>
<li class="chapter" data-level="0.4.5" data-path="index.html"><a href="index.html#wins-above-replacement"><i class="fa fa-check"></i><b>0.4.5</b> Wins Above Replacement</a></li>
<li class="chapter" data-level="0.4.6" data-path="index.html"><a href="index.html#calculating-advanced-hitting-statistics"><i class="fa fa-check"></i><b>0.4.6</b> Calculating Advanced Hitting Statistics</a></li>
<li class="chapter" data-level="0.4.7" data-path="index.html"><a href="index.html#evaluating-advanced-pitching-statistics"><i class="fa fa-check"></i><b>0.4.7</b> Evaluating Advanced Pitching Statistics</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#football"><i class="fa fa-check"></i><b>0.5</b> Football</a>
<ul>
<li class="chapter" data-level="0.5.1" data-path="index.html"><a href="index.html#basic-football-statistics"><i class="fa fa-check"></i><b>0.5.1</b> Basic Football Statistics</a></li>
<li class="chapter" data-level="0.5.2" data-path="index.html"><a href="index.html#advanced-football-statistics"><i class="fa fa-check"></i><b>0.5.2</b> Advanced Football Statistics</a></li>
</ul></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#basketball"><i class="fa fa-check"></i><b>0.6</b> Basketball</a>
<ul>
<li class="chapter" data-level="0.6.1" data-path="index.html"><a href="index.html#basic-basketball-statistics"><i class="fa fa-check"></i><b>0.6.1</b> Basic Basketball Statistics</a></li>
<li class="chapter" data-level="0.6.2" data-path="index.html"><a href="index.html#advanced-basketball-statistics"><i class="fa fa-check"></i><b>0.6.2</b> Advanced Basketball Statistics</a></li>
<li class="chapter" data-level="0.6.3" data-path="index.html"><a href="index.html#four-factors"><i class="fa fa-check"></i><b>0.6.3</b> Four Factors</a></li>
<li class="chapter" data-level="0.6.4" data-path="index.html"><a href="index.html#shot-charts"><i class="fa fa-check"></i><b>0.6.4</b> Shot Charts</a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#hockey"><i class="fa fa-check"></i><b>0.7</b> Hockey</a>
<ul>
<li class="chapter" data-level="0.7.1" data-path="index.html"><a href="index.html#basic-hockey-statistics"><i class="fa fa-check"></i><b>0.7.1</b> Basic Hockey Statistics</a></li>
<li class="chapter" data-level="0.7.2" data-path="index.html"><a href="index.html#advanced-hockey-statistics"><i class="fa fa-check"></i><b>0.7.2</b> Advanced Hockey Statistics</a></li>
<li class="chapter" data-level="0.7.3" data-path="index.html"><a href="index.html#actual-vs.-expected-goals"><i class="fa fa-check"></i><b>0.7.3</b> Actual vs. Expected Goals</a></li>
<li class="chapter" data-level="0.7.4" data-path="index.html"><a href="index.html#goalie-statistics"><i class="fa fa-check"></i><b>0.7.4</b> Goalie Statistics</a></li>
<li class="chapter" data-level="0.7.5" data-path="index.html"><a href="index.html#correlation-plots"><i class="fa fa-check"></i><b>0.7.5</b> Correlation Plots</a></li>
</ul></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#volleyball"><i class="fa fa-check"></i><b>0.8</b> Volleyball</a>
<ul>
<li class="chapter" data-level="0.8.1" data-path="index.html"><a href="index.html#basic-volleyball-statistics"><i class="fa fa-check"></i><b>0.8.1</b> Basic Volleyball Statistics</a></li>
<li class="chapter" data-level="0.8.2" data-path="index.html"><a href="index.html#scatter-plot"><i class="fa fa-check"></i><b>0.8.2</b> Scatter Plot</a></li>
<li class="chapter" data-level="0.8.3" data-path="index.html"><a href="index.html#box-plot"><i class="fa fa-check"></i><b>0.8.3</b> Box Plot</a></li>
</ul></li>
<li class="chapter" data-level="0.9" data-path="index.html"><a href="index.html#soccer"><i class="fa fa-check"></i><b>0.9</b> Soccer</a>
<ul>
<li class="chapter" data-level="0.9.1" data-path="index.html"><a href="index.html#basic-soccer-statistics"><i class="fa fa-check"></i><b>0.9.1</b> Basic Soccer Statistics</a></li>
<li class="chapter" data-level="0.9.2" data-path="index.html"><a href="index.html#advanced-soccer-statistics"><i class="fa fa-check"></i><b>0.9.2</b> Advanced Soccer Statistics</a></li>
<li class="chapter" data-level="0.9.3" data-path="index.html"><a href="index.html#bar-plot"><i class="fa fa-check"></i><b>0.9.3</b> Bar Plot</a></li>
<li class="chapter" data-level="0.9.4" data-path="index.html"><a href="index.html#scatter-plot-1"><i class="fa fa-check"></i><b>0.9.4</b> Scatter Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>1</b> Probability</a>
<ul>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html#chapter-preview"><i class="fa fa-check"></i>Chapter Preview</a></li>
<li class="chapter" data-level="1.1" data-path="probability.html"><a href="probability.html#definitions-1"><i class="fa fa-check"></i><b>1.1</b> Definitions</a></li>
<li class="chapter" data-level="1.2" data-path="probability.html"><a href="probability.html#set-theory"><i class="fa fa-check"></i><b>1.2</b> Set Theory</a></li>
<li class="chapter" data-level="1.3" data-path="probability.html"><a href="probability.html#axioms-properties-and-laws"><i class="fa fa-check"></i><b>1.3</b> Axioms, Properties, and Laws</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="probability.html"><a href="probability.html#axioms-of-probability"><i class="fa fa-check"></i><b>1.3.1</b> Axioms of Probability</a></li>
<li class="chapter" data-level="1.3.2" data-path="probability.html"><a href="probability.html#properties-of-probability"><i class="fa fa-check"></i><b>1.3.2</b> Properties of Probability</a></li>
<li class="chapter" data-level="1.3.3" data-path="probability.html"><a href="probability.html#laws-of-probability"><i class="fa fa-check"></i><b>1.3.3</b> Laws of Probability</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="probability.html"><a href="probability.html#combinatorics"><i class="fa fa-check"></i><b>1.4</b> Combinatorics</a></li>
<li class="chapter" data-level="1.5" data-path="probability.html"><a href="probability.html#odds-and-gambling"><i class="fa fa-check"></i><b>1.5</b> Odds and Gambling</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="probability.html"><a href="probability.html#sports-betting-in-usa"><i class="fa fa-check"></i><b>1.5.1</b> Sports Betting in USA</a></li>
<li class="chapter" data-level="1.5.2" data-path="probability.html"><a href="probability.html#gambling-addiction"><i class="fa fa-check"></i><b>1.5.2</b> Gambling Addiction</a></li>
<li class="chapter" data-level="1.5.3" data-path="probability.html"><a href="probability.html#odds-definition"><i class="fa fa-check"></i><b>1.5.3</b> Odds Definition</a></li>
<li class="chapter" data-level="1.5.4" data-path="probability.html"><a href="probability.html#gambling-odds"><i class="fa fa-check"></i><b>1.5.4</b> Gambling Odds</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="probability.html"><a href="probability.html#random-variables"><i class="fa fa-check"></i><b>1.6</b> Random Variables</a></li>
<li class="chapter" data-level="1.7" data-path="probability.html"><a href="probability.html#common-random-variables"><i class="fa fa-check"></i><b>1.7</b> Common Random Variables</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="probability.html"><a href="probability.html#binomial-rvs"><i class="fa fa-check"></i><b>1.7.1</b> Binomial RVs</a></li>
<li class="chapter" data-level="1.7.2" data-path="probability.html"><a href="probability.html#geometric-rvs"><i class="fa fa-check"></i><b>1.7.2</b> Geometric RVs</a></li>
<li class="chapter" data-level="1.7.3" data-path="probability.html"><a href="probability.html#poisson-rvs"><i class="fa fa-check"></i><b>1.7.3</b> Poisson RVs</a></li>
<li class="chapter" data-level="1.7.4" data-path="probability.html"><a href="probability.html#negative-binomial-rvs"><i class="fa fa-check"></i><b>1.7.4</b> Negative Binomial RVs</a></li>
<li class="chapter" data-level="1.7.5" data-path="probability.html"><a href="probability.html#normal-rvs"><i class="fa fa-check"></i><b>1.7.5</b> Normal RVs</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="probability.html"><a href="probability.html#extra-stuff"><i class="fa fa-check"></i><b>1.8</b> Extra Stuff</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="probability.html"><a href="probability.html#sets-and-conditional-probability"><i class="fa fa-check"></i><b>1.8.1</b> Sets and Conditional Probability</a></li>
<li class="chapter" data-level="1.8.2" data-path="probability.html"><a href="probability.html#binomials-and-multinomials"><i class="fa fa-check"></i><b>1.8.2</b> Binomials and Multinomials</a></li>
<li class="chapter" data-level="1.8.3" data-path="probability.html"><a href="probability.html#expectation---baseball"><i class="fa fa-check"></i><b>1.8.3</b> Expectation - Baseball</a></li>
<li class="chapter" data-level="1.8.4" data-path="probability.html"><a href="probability.html#basketball-scenario"><i class="fa fa-check"></i><b>1.8.4</b> Basketball Scenario</a></li>
<li class="chapter" data-level="1.8.5" data-path="probability.html"><a href="probability.html#multiple-probability-distributions---basketball"><i class="fa fa-check"></i><b>1.8.5</b> Multiple Probability Distributions - Basketball</a></li>
<li class="chapter" data-level="1.8.6" data-path="probability.html"><a href="probability.html#law-of-total-probability---baseball"><i class="fa fa-check"></i><b>1.8.6</b> Law of Total Probability - Baseball</a></li>
<li class="chapter" data-level="1.8.7" data-path="probability.html"><a href="probability.html#multinomial-distribution---baseball"><i class="fa fa-check"></i><b>1.8.7</b> Multinomial Distribution - Baseball</a></li>
<li class="chapter" data-level="1.8.8" data-path="probability.html"><a href="probability.html#bayes---injured-baseball-player"><i class="fa fa-check"></i><b>1.8.8</b> Bayes - injured baseball player</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html"><i class="fa fa-check"></i><b>2</b> Monte Carlo Simulation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#basics"><i class="fa fa-check"></i><b>2.1</b> Basics</a></li>
<li class="chapter" data-level="2.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#estimating-probabilities"><i class="fa fa-check"></i><b>2.2</b> Estimating Probabilities</a></li>
<li class="chapter" data-level="2.3" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#simulating-streaks"><i class="fa fa-check"></i><b>2.3</b> Simulating Streaks</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#winning-streak-simulation"><i class="fa fa-check"></i><b>2.3.1</b> Winning Streak Simulation</a></li>
<li class="chapter" data-level="2.3.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#hitting-streak-simulation"><i class="fa fa-check"></i><b>2.3.2</b> Hitting Streak Simulation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#gambling-simulations"><i class="fa fa-check"></i><b>2.4</b> Gambling Simulations</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#martingale-system"><i class="fa fa-check"></i><b>2.4.1</b> Martingale System</a></li>
<li class="chapter" data-level="2.4.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#gamblers-ruin"><i class="fa fa-check"></i><b>2.4.2</b> Gambler’s Ruin</a></li>
<li class="chapter" data-level="2.4.3" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#simulating-a-winning-system"><i class="fa fa-check"></i><b>2.4.3</b> Simulating a Winning System</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#extra-stuff-1"><i class="fa fa-check"></i><b>2.5</b> Extra stuff</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#shaq-ft-simulation"><i class="fa fa-check"></i><b>2.5.1</b> Shaq FT simulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>3</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="3.1" data-path="statistical-inference.html"><a href="statistical-inference.html#one-sample-and-two-sample-t-tests-and-confidence-intervals"><i class="fa fa-check"></i><b>3.1</b> One Sample and Two Sample t-tests and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>4</b> Correlation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="correlation.html"><a href="correlation.html#pearsons-correlation-coefficient"><i class="fa fa-check"></i><b>4.1</b> Pearson’s Correlation Coefficient</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="correlation.html"><a href="correlation.html#properties-of-the-linear-correlation-coefficient"><i class="fa fa-check"></i><b>4.1.1</b> Properties of the Linear Correlation Coefficient</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="correlation.html"><a href="correlation.html#rank-correlation"><i class="fa fa-check"></i><b>4.2</b> Rank Correlation</a></li>
<li class="chapter" data-level="4.3" data-path="correlation.html"><a href="correlation.html#autocorrelation"><i class="fa fa-check"></i><b>4.3</b> Autocorrelation</a></li>
<li class="chapter" data-level="4.4" data-path="correlation.html"><a href="correlation.html#association-of-categorical-variables"><i class="fa fa-check"></i><b>4.4</b> Association of Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>5.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.2</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="5.3" data-path="linear-regression.html"><a href="linear-regression.html#confounding-variables"><i class="fa fa-check"></i><b>5.3</b> Confounding Variables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Sports Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Sports Analytics</h1>
<p class="author"><em>Aaron Nielsen, Department of Statistics, Colorado State University</em></p>
<p class="date"><em>2022-07-21</em></p>
</div>
<div id="about" class="section level1 unnumbered hasAnchor">
<h1>About<a href="index.html#about" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This book serves as the course textbook for the following courses at Colorado State University:</p>
<ul>
<li><p>STAT 351 (Sports Statistics and Analytics 1)</p></li>
<li><p>STAT 451 (Sports Statistics and Analytics 2</p></li>
</ul>
<p><br />
</p>
<p>CSU students contributed to the creation of this book. Many thanks to the following student collaborators:</p>
<ul>
<li><p>Levi Kipp</p></li>
<li><p>Ellie Martinez</p></li>
<li><p>Isaac Moorman</p></li>
</ul>
<!-- usethis::use_git() -->

<div id="getting-started-with-r" class="section level2 hasAnchor" number="0.1">
<h2><span class="header-section-number">0.1</span> Getting Started With R<a href="index.html#getting-started-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="installing-r" class="section level3 hasAnchor" number="0.1.1">
<h3><span class="header-section-number">0.1.1</span> Installing R<a href="index.html#installing-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this class, you will be using R Studio to complete statistical analyses on your computer.</p>
<p>To begin using R Studio, you will need to install “R” first and then install “R Studio” on your computer.</p>
<p><strong><em>Step 1: Download R</em></strong><br />
(a) Visit <a href="https://www.r-project.org/">https://www.r-project.org/</a><br />
(b) Click <strong>CRAN</strong> under <strong>Download</strong>
(c) Select any of the mirrors<br />
(d) Click the appropriate link for your type of system (Mac, Windows, Linux)<br />
(e) Download R on this next page.<br />
(For Windows, this will say <strong>install R for the first time</strong>. For Mac, this will be under <strong>Latest release</strong> and will be something like <strong>R-4.1.0.pkg</strong> – the numbers may differ depending on the most recent version)<br />
(f) Install R on your computer<br />
</p>
<p><strong><em>Step 2: Download R Studio</em></strong><br />
(a) Visit <a href="https://www.rstudio.com/products/rstudio/download/#download">https://www.rstudio.com/products/rstudio/download/#download</a><br />
(b) Click to download<br />
(c) Install R Studio on your computer<br />
</p>
<div style="page-break-after: always;"></div>
<p><strong><em>Step 3: Verify R Studio is working</em></strong><br />
(a) Open R Studio<br />
(b) Let’s enter a small dataset and calculate the average to make sure everything is working correctly.<br />
(c) In the console, type in the following dataset of Sammy Sosa’s season home run totals from 1998–2002:<br />
</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="index.html#cb1-1" aria-hidden="true" tabindex="-1"></a>sosa.HR <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">66</span>,<span class="dv">63</span>,<span class="dv">50</span>,<span class="dv">64</span>,<span class="dv">49</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>In the console, calculate the average season home run total for Sammy Sosa between 1998–2002:<br />
</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="index.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sosa.HR)</span></code></pre></div>
<pre><code>## [1] 58.4</code></pre>
<p>(e) Did you find Slammin’ Sammy’s average home run total from 1998–2002 was 58.4? If so, you should be set up correctly!</p>
<div style="page-break-after: always;"></div>
</div>
<div id="some-r-basics" class="section level3 hasAnchor" number="0.1.2">
<h3><span class="header-section-number">0.1.2</span> Some R Basics<a href="index.html#some-r-basics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the following examples, let’s consider Peyton Manning’s career with the Denver Broncos. In his four seasons with the Broncos, Manning’s passing yard totals were: 4659, 5477, 4727, 2249. Let’s enter this data into R. To enter a vector of data, use the <strong>c()</strong> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="index.html#cb4-1" aria-hidden="true" tabindex="-1"></a>peyton <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4659</span>, <span class="dv">5477</span>, <span class="dv">4727</span>, <span class="dv">2249</span>)</span></code></pre></div>
<p>To look at the data you just put in the variable <em>peyton</em>, type <em>peyton</em> into the console and press enter.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="index.html#cb5-1" aria-hidden="true" tabindex="-1"></a>peyton</span></code></pre></div>
<pre><code>## [1] 4659 5477 4727 2249</code></pre>
<p>Some basic function for calculating summary statistics include <strong>summary</strong>, <strong>mean()</strong>, <strong>median()</strong>, <strong>var()</strong>, and <strong>sd()</strong>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="index.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peyton)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    2249    4056    4693    4278    4914    5477</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="index.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(peyton)</span></code></pre></div>
<pre><code>## [1] 4278</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="index.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(peyton)</span></code></pre></div>
<pre><code>## [1] 1402.522</code></pre>
<p>R allows you to install additional packages (collections of functions) that aren’t offered in the base version of R. To install a package, use <strong>install.packages(<name_of_package>)</strong> and to load a package, use <strong>library(<name_of_package>)</strong>.</p>
<p>One package that we will use frequently is <strong>tidyverse</strong>. This package includes several other packages and functions such as <strong>ggplot</strong> (plotting function), <strong>dplyr</strong> (data manipulation package), and <strong>stringr</strong> (string manipulation package).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="index.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb13-2"><a href="index.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>You will also need to know how to load datasets from files. For this class, we will typically provide data files is .csv format.</p>
<p>Here is how to load a file:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="index.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load readr package and load example dataset</span></span>
<span id="cb14-2"><a href="index.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb14-3"><a href="index.html#cb14-3" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/NFL_2021_Team_Passing.csv&quot;</span>)</span>
<span id="cb14-4"><a href="index.html#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="index.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># we can look at the header (first few entries) using &quot;head()&quot;</span></span>
<span id="cb14-6"><a href="index.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(NFL_2021_Team_Passing)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 25
##      Rk Tm             G   Cmp   Att `Cmp%`   Yds    TD `TD%`   Int `Int%`   Lng
##   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1     1 Tampa Bay…    17   492   731   67.3  5229    43   5.9    12    1.6    62
## 2     2 Los Angel…    17   443   674   65.7  4800    38   5.6    15    2.2    72
## 3     3 Dallas Co…    17   444   647   68.6  4800    40   6.2    11    1.7    73
## 4     4 Kansas Ci…    17   448   675   66.4  4791    37   5.5    13    1.9    75
## 5     5 Los Angel…    17   406   607   66.9  4642    41   6.8    18    3      79
## 6     6 Las Vegas…    17   429   628   68.3  4567    23   3.7    14    2.2    61
## # … with 13 more variables: `Y/A` &lt;dbl&gt;, `AY/A` &lt;dbl&gt;, `Y/C` &lt;dbl&gt;,
## #   `Y/G` &lt;dbl&gt;, Rate &lt;dbl&gt;, Sk &lt;dbl&gt;, SKYds &lt;dbl&gt;, `Sk%` &lt;dbl&gt;, `NY/A` &lt;dbl&gt;,
## #   `ANY/A` &lt;dbl&gt;, `4QC` &lt;dbl&gt;, GWD &lt;dbl&gt;, EXP &lt;dbl&gt;</code></pre>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="descriptive-statistics" class="section level2 hasAnchor" number="0.2">
<h2><span class="header-section-number">0.2</span> Descriptive Statistics<a href="index.html#descriptive-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="definitions" class="section level3 hasAnchor" number="0.2.1">
<h3><span class="header-section-number">0.2.1</span> Definitions<a href="index.html#definitions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="definition">
<p><span id="def:unlabeled-div-1" class="definition"><strong>Definition 0.1  </strong></span>A <strong><em>population</em></strong> is a well-defined complete collection of objects.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-2" class="definition"><strong>Definition 0.2  </strong></span>A <strong><em>sample</em></strong> is a subset of the population.</p>
</div>
<div class="example">
<p><span id="exm:unlabeled-div-3" class="example"><strong>Example 0.1  </strong></span>Suppose we are interested in studying Peyton’s Manning’s season passing yards totals. How could you define the population and what is one possible sample?</p>
</div>
<p><br />
<br />
<br />
<br />
<br />
</p>
<div class="definition">
<p><span id="def:unlabeled-div-4" class="definition"><strong>Definition 0.3  </strong></span><strong><em>Quantitative data</em></strong> is numeric data or numbers. It can be broken into two further categories: discrete and continuous data.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-5" class="definition"><strong>Definition 0.4  </strong></span><strong><em>Discrete data</em></strong> is quantitative data with a finite or countably infinite number of values.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-6" class="definition"><strong>Definition 0.5  </strong></span><strong><em>Continuous data</em></strong> is quantitative data with an uncountably infinite number of values or data taken from an interval.</p>
</div>
<div class="example">
<p><span id="exm:unlabeled-div-7" class="example"><strong>Example 0.2  </strong></span>What are possible discrete and continuous data associated with Peyton Manning?</p>
</div>
<p><br />
<br />
<br />
<br />
<br />
</p>
<div class="definition">
<p><span id="def:unlabeled-div-8" class="definition"><strong>Definition 0.6  </strong></span><strong><em>Qualitative data</em></strong> refers to names, categories, or descriptions. It can also be broken down into
two further categories, nominal data and ordinal data.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-9" class="definition"><strong>Definition 0.7  </strong></span><strong><em>Nominal data</em></strong> is qualitative data with no natural ordering.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-10" class="definition"><strong>Definition 0.8  </strong></span><strong><em>Ordinal data</em></strong> is qualitative data with a natural ordering.</p>
</div>
<div class="example">
<p><span id="exm:unlabeled-div-11" class="example"><strong>Example 0.3  </strong></span>What are possible nominal and ordinal data associated with Peyton Manning?</p>
</div>
<p><br />
<br />
<br />
<br />
<br />
</p>
<div style="page-break-after: always;"></div>
</div>
<div id="descriptive-statistics-1" class="section level3 hasAnchor" number="0.2.2">
<h3><span class="header-section-number">0.2.2</span> Descriptive Statistics<a href="index.html#descriptive-statistics-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While we will learn about some descriptive statistics that are unique to specific sports, there are some descriptive statistics that are frequently used in many applications.</p>
<div id="quantitative-data" class="section level4 hasAnchor" number="0.2.2.1">
<h4><span class="header-section-number">0.2.2.1</span> Quantitative Data<a href="index.html#quantitative-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are different descriptive statistics depending on the type of data you are analyzing. We will begin by looking at descriptive statistics for quantitative data.</p>
<p>To begin, let <span class="math inline">\(x_1, x_2, \ldots, x_n\)</span> represent a numerical dataset with a sample of size <span class="math inline">\(n\)</span>, where <span class="math inline">\(x_i\)</span> is the <span class="math inline">\(i^\text{th}\)</span> value in the dataset.</p>
<div class="definition">
<p><span id="def:unlabeled-div-12" class="definition"><strong>Definition 0.9  </strong></span>The <strong><em>sum</em></strong> of the data values is given by: <span class="math inline">\(\sum_{i=1}^n x_i = x_1 + x_2 + \ldots + x_n\)</span></p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-13" class="definition"><strong>Definition 0.10  </strong></span>The <strong><em>sample mean</em></strong> (or sample average), <span class="math inline">\(\bar{x}\)</span>, of the numerical dataset is given by <span class="math inline">\(\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i\)</span></p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-14" class="definition"><strong>Definition 0.11  </strong></span>The <strong><em>population mean</em></strong> (or population average), <span class="math inline">\(\mu\)</span>, is the mean value for the entire population.</p>
</div>
<p>The mean can be thought of as a measure of center or more generally, a measure of location.</p>
<div class="example">
<p><span id="exm:unlabeled-div-15" class="example"><strong>Example 0.4  </strong></span>Recall that Peyton Manning’s season passing yards total while with the Broncos were: 4659, 5477, 4727, 2249. Calculate the sample mean of these values.</p>
</div>
<p><br />
<br />
<br />
<br />
<br />
</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="index.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sample of Peyton Manning&#39;s passing yards season totals with Colts</span></span>
<span id="cb16-2"><a href="index.html#cb16-2" aria-hidden="true" tabindex="-1"></a>peyton.broncos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4659</span>, <span class="dv">5477</span>, <span class="dv">4727</span>, <span class="dv">2249</span>)</span>
<span id="cb16-3"><a href="index.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(peyton.broncos)</span></code></pre></div>
<pre><code>## [1] 4278</code></pre>
<p>In sports statistics, we often have to choose between using a descriptive statistic that summarizes a quantity versus a descriptive statistic that summarizes a rate. For instance, in basketball, we can compare two players based on how many points they score in a game (total quantity) or we can compare two players based on how many points per minute played (rate statistic). Many applications in sports analytics focus more on rate statistics rather than quantity statistics. Why?</p>
<p>We can measure the spread or variability of a dataset using <em>variance</em> and <em>standard devatiation</em>.</p>
<div class="definition">
<p><span id="def:unlabeled-div-16" class="definition"><strong>Definition 0.12  </strong></span>The <strong><em>sample variance</em></strong>, <span class="math inline">\(s^2\)</span>, of the numerical dataset is a measure of spread and is given by <span class="math inline">\(s^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2\)</span></p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-17" class="definition"><strong>Definition 0.13  </strong></span>The <strong><em>sample standard deviation</em></strong>, <span class="math inline">\(s\)</span>, of the numerical dataset is a measure of spread and is given by <span class="math inline">\(s = \sqrt{s^2} = \sqrt{\frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2}\)</span></p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-18" class="definition"><strong>Definition 0.14  </strong></span>The <strong><em>population variance</em></strong>, <span class="math inline">\(\sigma^2\)</span>, is the variance for an entire population and is given by <span class="math inline">\(\sigma^2 = \frac{1}{N} \sum_{i=1}^N (x_i - \mu)^2\)</span>, where <span class="math inline">\(N\)</span> is the population size.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-19" class="definition"><strong>Definition 0.15  </strong></span>The <strong><em>population standard deviation</em></strong>, <span class="math inline">\(\sigma\)</span>, is the standard deviation for an entire population and is given by <span class="math inline">\(\sigma = \sqrt{\frac{1}{N} \sum_{i=1}^N (x_i - \mu)^2}\)</span></p>
</div>
<p>We often prefer to work with standard deviations as a measure of spread as opposed to variance because standard deviations are given in our original units.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="index.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the variance and standard deviation of Peyton Manning&#39;s passing yards</span></span>
<span id="cb18-2"><a href="index.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># season totals with Broncos</span></span>
<span id="cb18-3"><a href="index.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(peyton.broncos) <span class="co"># units: yards^2</span></span></code></pre></div>
<pre><code>## [1] 1967068</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="index.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(peyton.broncos) <span class="co"># units: yards</span></span></code></pre></div>
<pre><code>## [1] 1402.522</code></pre>
<div class="definition">
<p><span id="def:unlabeled-div-20" class="definition"><strong>Definition 0.16  </strong></span>The <strong>sample median</strong>, <span class="math inline">\(\tilde{x}\)</span>, of a numerical dataset is the middle value when the data are ordered from smallest to largest. In other words, let <span class="math inline">\(x_1, x_2, \ldots, x_n\)</span> be the (unordered) dataset and let <span class="math inline">\(x_{(1)},x_{(2)}, \ldots, x_{(n)}\)</span> be the same dataset but ordered from smallest to largest. If <span class="math inline">\(n\)</span> is odd, then <span class="math inline">\(\tilde{x} = x_{(n+1)/2}\)</span> and if <span class="math inline">\(n\)</span> is even, then <span class="math inline">\(\tilde{x} = \frac{1}{2} \cdot \left[x_{\left(\frac{n}{2}\right)} + x_{\left(\frac{n+1}{2}\right)}\right]\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:unlabeled-div-21" class="example"><strong>Example 0.5  </strong></span>Calculate the sample median of Peyton Manning’s season passing yards total while with the Colts (3739, 4135, 4413, 4131, 4200, 4267, 4557, 3747, 4397, 4040, 4002, 4500, 4700).</p>
</div>
<p><br />
<br />
<br />
<br />
<br />
</p>
<p>Like sample mean, sample median is a measure of center. It gives you an idea of where the ``middle” of your dataset is.</p>
<p>We can calculate sample mean and sample median in R as follows:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="index.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the median of Peyton Manning&#39;s passing yards season totals with </span></span>
<span id="cb22-2"><a href="index.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Broncos and Colts</span></span>
<span id="cb22-3"><a href="index.html#cb22-3" aria-hidden="true" tabindex="-1"></a>peyton.colts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3739</span>, <span class="dv">4135</span>, <span class="dv">4413</span>, <span class="dv">4131</span>, <span class="dv">4200</span>, <span class="dv">4267</span>, <span class="dv">4557</span>, <span class="dv">3747</span>, <span class="dv">4397</span>, <span class="dv">4040</span>, </span>
<span id="cb22-4"><a href="index.html#cb22-4" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">4002</span>, <span class="dv">4500</span>, <span class="dv">4700</span>)</span>
<span id="cb22-5"><a href="index.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(peyton.broncos)</span></code></pre></div>
<pre><code>## [1] 4693</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="index.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(peyton.colts)</span></code></pre></div>
<pre><code>## [1] 4200</code></pre>
<div style="page-break-after: always;"></div>
<div class="definition">
<p><span id="def:unlabeled-div-22" class="definition"><strong>Definition 0.17  </strong></span>A <strong><em>percentile</em></strong> is a measure of relative standing. The <span class="math inline">\(p^\text{th}\)</span> percentile is the number where at least
p% of the data values are less than or equal to this number.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-23" class="definition"><strong>Definition 0.18  </strong></span>A <strong><em>quantile</em></strong> is a measure of relative standing and are the cut points for breaking a distribution of values into equal sized bins.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-24" class="definition"><strong>Definition 0.19  </strong></span>A <strong><em>quartile</em></strong> is a measure of relative standing and are the cut points for breaking a distribution of values into four equal parts.</p>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="index.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the 10th and 90th percentile of Peyton Manning&#39;s passing yards season</span></span>
<span id="cb26-2"><a href="index.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># totals with Colts</span></span>
<span id="cb26-3"><a href="index.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(peyton.colts,<span class="fl">0.10</span>)</span></code></pre></div>
<pre><code>##  10% 
## 3798</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="index.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(peyton.colts,<span class="fl">0.90</span>)</span></code></pre></div>
<pre><code>##    90% 
## 4545.6</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="index.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(peyton.colts,<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>))</span></code></pre></div>
<pre><code>##    10%    90% 
## 3798.0 4545.6</code></pre>
<p><strong>Special percentiles:</strong><br />
1. 25th percentile = 1st quartile = <span class="math inline">\(Q_1\)</span><br />
2. 50th percentile = 2nd quartile = <span class="math inline">\(Q_2\)</span> = <span class="math inline">\(\tilde{x}\)</span><br />
3. 75th percentile = 3rd quartile = <span class="math inline">\(Q_3\)</span><br />
</p>
<div class="definition">
<p><span id="def:unlabeled-div-25" class="definition"><strong>Definition 0.20  </strong></span><strong><em>Range</em></strong> is a measure of spread, measures the full width of a dataset, and is given by: <span class="math inline">\(Range = Max - Min\)</span>.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-26" class="definition"><strong>Definition 0.21  </strong></span><strong><em>Interquartile range</em></strong> is a measure of spread, measures the width of the middle 50% of a dataset, and is given by: <span class="math inline">\(IQR = Q_3 - Q_1\)</span>.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-27" class="definition"><strong>Definition 0.22  </strong></span>A <strong><em>five number summary</em></strong> describes the center, spread, and edges of a dataset and is given by: <span class="math inline">\((Min,Q_1,Q_2,Q_3,max)\)</span>.</p>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="index.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(peyton.colts)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    3739    4040    4200    4218    4413    4700</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="index.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(peyton.colts,<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##   0%  25%  50%  75% 100% 
## 3739 4040 4200 4413 4700</code></pre>
</div>
<div id="qualitative-data" class="section level4 hasAnchor" number="0.2.2.2">
<h4><span class="header-section-number">0.2.2.2</span> Qualitative Data<a href="index.html#qualitative-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In sports statistics, we also encounter qualitative (categorical) data which is names or labels which has its own descriptive statistics.</p>
<p>To begin, let <span class="math inline">\(x_1, x_2, \ldots, x_n\)</span> represent a categorical dataset with a sample of size <span class="math inline">\(n\)</span>, where <span class="math inline">\(x_i\)</span> is the <span class="math inline">\(i^\text{th}\)</span> value in the dataset.</p>
<div class="definition">
<p><span id="def:unlabeled-div-28" class="definition"><strong>Definition 0.23  </strong></span>The <strong><em>proportion</em></strong> of sampled data that fall into a category is given by: <span class="math inline">\(p = \frac{\#\text{ in category}}{\#\text{ total}}\)</span></p>
</div>
<p>’’Proportion” and “Probability” are often used interchangeably. Both have a minimum value of 0 and a maximum value of 1.</p>
<div class="definition">
<p><span id="def:unlabeled-div-29" class="definition"><strong>Definition 0.24  </strong></span>The <strong><em>percentage</em></strong> of sampled data that fall into a category is given by: <span class="math inline">\(P\% = 100 \cdot p = 100 \cdot \frac{\#\text{ in category}}{\#\text{ total}}\)</span></p>
</div>
<p>Percentages in this context can have a minimum value of 0% and a maximum value of 100%.</p>
<div class="example">
<p><span id="exm:unlabeled-div-30" class="example"><strong>Example 0.6  </strong></span>In 2014, Peyton Manning started as quarterback for the Denver Broncos. The result of the Broncos’ 16-game season was:<br />
Win, Win, Loss, Win, Win, Win, Win, Loss, Win, Loss, Win, Win, Win, Win, Loss, Win</p>
<p>Calculate the proportion and percentage of Broncos’ winning games in 2014.</p>
</div>
<p><br />
<br />
<br />
<br />
<br />
</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="index.html#cb36-1" aria-hidden="true" tabindex="-1"></a>broncos2014 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Win&quot;</span>, <span class="st">&quot;Win&quot;</span>, <span class="st">&quot;Loss&quot;</span>, <span class="st">&quot;Win&quot;</span>, <span class="st">&quot;Win&quot;</span>, <span class="st">&quot;Win&quot;</span>, <span class="st">&quot;Win&quot;</span>, <span class="st">&quot;Loss&quot;</span>, <span class="st">&quot;Win&quot;</span>,</span>
<span id="cb36-2"><a href="index.html#cb36-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Loss&quot;</span>, <span class="st">&quot;Win&quot;</span>, <span class="st">&quot;Win&quot;</span>, <span class="st">&quot;Win&quot;</span>, <span class="st">&quot;Win&quot;</span>, <span class="st">&quot;Loss&quot;</span>, <span class="st">&quot;Win&quot;</span>)</span>
<span id="cb36-3"><a href="index.html#cb36-3" aria-hidden="true" tabindex="-1"></a>broncos.prop <span class="ot">&lt;-</span> <span class="fu">sum</span>(broncos2014 <span class="sc">==</span> <span class="st">&quot;Win&quot;</span>)<span class="sc">/</span><span class="fu">length</span>(broncos2014); broncos.prop</span></code></pre></div>
<pre><code>## [1] 0.75</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="index.html#cb38-1" aria-hidden="true" tabindex="-1"></a>broncos.perc <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>broncos.prop; broncos.perc</span></code></pre></div>
<pre><code>## [1] 75</code></pre>
<p>We can also build a frequency table that summarizes the categories and their occurrences using <strong>table()</strong> in R. Note that <strong>table()</strong> works for quantitative and qualitative data.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="index.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(broncos2014)</span></code></pre></div>
<pre><code>## broncos2014
## Loss  Win 
##    4   12</code></pre>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="visualizations" class="section level2 hasAnchor" number="0.3">
<h2><span class="header-section-number">0.3</span> Visualizations<a href="index.html#visualizations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Conveying information visually is also an important part in providing a description of a dataset.</p>
<p>R provides some basic plotting functions such as <strong>plot</strong>, <strong>hist</strong>, and <strong>barplot</strong>. These plotting functions are simple and not always very clean looking.</p>
<p>In this class, we will use analogous plotting functions in <strong>ggplot2</strong> that are much improved plotting functions.</p>
<p>If you have already installed the <strong>tidyverse</strong> package, it should have also installed the <strong>ggplot2</strong> package.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="index.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;tidyverse&quot;)</span></span>
<span id="cb42-2"><a href="index.html#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="index.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the tidyverse package (which includes ggplot2)</span></span>
<span id="cb42-4"><a href="index.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Let’s load the file ``NFL_2021_Team_Passing.csv” which contains NFL Team Passing Statistics, 2021 from <a href="https://www.pro-football-reference.com/years/2021/index.htm#passing" class="uri">https://www.pro-football-reference.com/years/2021/index.htm#passing</a></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="index.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb43-2"><a href="index.html#cb43-2" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/NFL_2021_Team_Passing.csv&quot;</span>)</span>
<span id="cb43-3"><a href="index.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(NFL_2021_Team_Passing)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 25
##      Rk Tm             G   Cmp   Att `Cmp%`   Yds    TD `TD%`   Int `Int%`   Lng
##   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1     1 Tampa Bay…    17   492   731   67.3  5229    43   5.9    12    1.6    62
## 2     2 Los Angel…    17   443   674   65.7  4800    38   5.6    15    2.2    72
## 3     3 Dallas Co…    17   444   647   68.6  4800    40   6.2    11    1.7    73
## 4     4 Kansas Ci…    17   448   675   66.4  4791    37   5.5    13    1.9    75
## 5     5 Los Angel…    17   406   607   66.9  4642    41   6.8    18    3      79
## 6     6 Las Vegas…    17   429   628   68.3  4567    23   3.7    14    2.2    61
## # … with 13 more variables: `Y/A` &lt;dbl&gt;, `AY/A` &lt;dbl&gt;, `Y/C` &lt;dbl&gt;,
## #   `Y/G` &lt;dbl&gt;, Rate &lt;dbl&gt;, Sk &lt;dbl&gt;, SKYds &lt;dbl&gt;, `Sk%` &lt;dbl&gt;, `NY/A` &lt;dbl&gt;,
## #   `ANY/A` &lt;dbl&gt;, `4QC` &lt;dbl&gt;, GWD &lt;dbl&gt;, EXP &lt;dbl&gt;</code></pre>
<div id="histograms" class="section level3 hasAnchor" number="0.3.1">
<h3><span class="header-section-number">0.3.1</span> Histograms<a href="index.html#histograms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Histograms are one of the most common and basic ways to visualize a dataset’s distribution of values. To make a histogram, you will use <strong>ggplot</strong> and <strong>geom_histogram</strong>.</p>
<div class="example">
<p><span id="exm:unlabeled-div-31" class="example"><strong>Example 0.7  </strong></span>Create a histogram of the NFL Team Passing Yards in 2021.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="index.html#cb45-1" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Yds)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/hist-1.png" width="672" /></p>
<p>Notice how <strong>%&gt;%</strong> is used to <strong>pipe</strong> the dataset into ggplot. This is using the pipe function from the <strong>dplyr</strong> package.</p>
<p>By default, <strong>geom_histogram</strong> uses 30 bins but this is customizable. Let’s make the bins have a width of 200.</p>
<p>All good visualizations have good labels. Let’s improve the axis labels and give the figure a title.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="index.html#cb46-1" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Yds)) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="index.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb46-3"><a href="index.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Team Passing Yards&quot;</span>,<span class="at">y=</span><span class="st">&quot;Team Passing Touchdowns&quot;</span>,<span class="at">title=</span><span class="st">&quot;NFL Team Passing Yards, 2021&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/hist2-1.png" width="672" /></p>
<p>We also have numerous options to change the appearance of plots when using <strong>ggplot</strong>. Let’s change the bins color to <em>blue</em> and change the bin borders to <em>white</em>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="index.html#cb47-1" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Yds)) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="index.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">binwidth =</span> <span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="index.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Team Passing Yards&quot;</span>, <span class="at">y=</span><span class="st">&quot;Team Passing Touchdowns&quot;</span>, <span class="at">title=</span><span class="st">&quot;NFL Team Passing Yards, 2021&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/hist3-1.png" width="672" /></p>
</div>
</div>
<div id="bar-plots" class="section level3 hasAnchor" number="0.3.2">
<h3><span class="header-section-number">0.3.2</span> Bar Plots<a href="index.html#bar-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also create bar plots using ggplot using the <strong>geom_bar</strong> function.</p>
<div class="example">
<p><span id="exm:unlabeled-div-32" class="example"><strong>Example 0.8  </strong></span>Create a bar plot with teams on the horizontal axis and passing touchdowns on the vertical axis.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="index.html#cb48-1" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Tm,<span class="at">y=</span>Yds)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="index.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/bar-1.png" width="672" /></p>
<p>The team labels are a complete mess. Let’s fix this and make some adjustments to the axis labels and figure title.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="index.html#cb49-1" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Tm,<span class="at">y=</span>Yds)) <span class="sc">+</span></span>
<span id="cb49-2"><a href="index.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb49-3"><a href="index.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Team&quot;</span>, <span class="at">y=</span><span class="st">&quot;Team Passing Yards&quot;</span>, </span>
<span id="cb49-4"><a href="index.html#cb49-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;NFL Team Passing Yards, 2021&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-5"><a href="index.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="textbook_files/figure-html/bar2-1.png" width="672" /></p>
<p>We can flip this graph if we like as well. Note that when we flip the graph, our labels get in reverse ordering, so this can be fixed using <strong>fct_rev()</strong> which is part of the <strong>forcats</strong> package.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="index.html#cb50-1" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="index.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">fct_rev</span>(Tm),<span class="at">y=</span>Yds)) <span class="sc">+</span></span>
<span id="cb50-3"><a href="index.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-4"><a href="index.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Team Passing Yards&quot;</span>,<span class="at">y=</span><span class="st">&quot;Team&quot;</span>,<span class="at">title=</span><span class="st">&quot;NFL Team Passing Yards, 2021&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="index.html#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/bar3-1.png" width="672" /></p>
</div>
<p>We can also order the teams from most team passing touchdowns to least using the <code>forcats</code> package.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="index.html#cb51-1" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Tm =</span> <span class="fu">fct_reorder</span>(Tm,Yds)) <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="index.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Tm,<span class="at">y=</span>Yds)) <span class="sc">+</span></span>
<span id="cb51-3"><a href="index.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="index.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Team Passing Yards&quot;</span>,<span class="at">y=</span><span class="st">&quot;Team Passing Yards&quot;</span>,<span class="at">title=</span><span class="st">&quot;NFL Team Passing Yards, 2021&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-5"><a href="index.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="scatter-plots" class="section level3 hasAnchor" number="0.3.3">
<h3><span class="header-section-number">0.3.3</span> Scatter Plots<a href="index.html#scatter-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another common and useful visualization is a scatterplot which shows the relationship between two numeric variable. In ggplot, you use <strong>geom_point()</strong>.</p>
<div class="example">
<p><span id="exm:unlabeled-div-33" class="example"><strong>Example 0.9  </strong></span>Create a scatterplot of Team Passing Yards and Team Passing Touchdowns from the NFL 2021 dataset.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="index.html#cb52-1" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="index.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Yds,<span class="at">y=</span>TD,<span class="at">label=</span>Tm)) <span class="sc">+</span> </span>
<span id="cb52-3"><a href="index.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-4"><a href="index.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Team Passing Yards&quot;</span>,<span class="at">y=</span><span class="st">&quot;Team Passing Touchdowns&quot;</span>,<span class="at">title=</span><span class="st">&quot;NFL Team Passing Yards, 2021&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/scatter1-1.png" width="672" /></p>
<p>We may want to include team labels on this plot, however, it can get messy very quickly with a lot of points.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="index.html#cb53-1" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="index.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Yds,<span class="at">y=</span>TD,<span class="at">label=</span>Tm)) <span class="sc">+</span> </span>
<span id="cb53-3"><a href="index.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-4"><a href="index.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Team Passing Yards&quot;</span>,<span class="at">y=</span><span class="st">&quot;Team Passing Touchdowns&quot;</span>,<span class="at">title=</span><span class="st">&quot;NFL Team Passing Yards, 2021&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-5"><a href="index.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/scatter2-1.png" width="672" /></p>
<p>Many sports leagues have around 30 teams, so a clean scatterplot with labels can be tricky to make. Here are some options below.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="index.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install ggrepel package</span></span>
<span id="cb54-2"><a href="index.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb54-3"><a href="index.html#cb54-3" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="index.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Yds,<span class="at">y=</span>TD,<span class="at">label=</span>Tm)) <span class="sc">+</span> </span>
<span id="cb54-5"><a href="index.html#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb54-6"><a href="index.html#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Team Passing Yards&quot;</span>,<span class="at">y=</span><span class="st">&quot;Team Passing Touchdowns&quot;</span>,<span class="at">title=</span><span class="st">&quot;NFL Team Passing Yards, 2021&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-7"><a href="index.html#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>()</span></code></pre></div>
<pre><code>## Warning: ggrepel: 6 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="textbook_files/figure-html/scatter3-1.png" width="672" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="index.html#cb56-1" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing<span class="sc">$</span>Abbr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TB&quot;</span>,<span class="st">&quot;LAC&quot;</span>,<span class="st">&quot;DAL&quot;</span>,<span class="st">&quot;KC&quot;</span>,<span class="st">&quot;LAR&quot;</span>,<span class="st">&quot;LV&quot;</span>,<span class="st">&quot;CIN&quot;</span>,<span class="st">&quot;GB&quot;</span>,<span class="st">&quot;BUF&quot;</span>,<span class="st">&quot;AZ&quot;</span>,<span class="st">&quot;MN&quot;</span>,<span class="st">&quot;SF&quot;</span>,</span>
<span id="cb56-2"><a href="index.html#cb56-2" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;BAL&quot;</span>,<span class="st">&quot;NE&quot;</span>,<span class="st">&quot;PIT&quot;</span>,<span class="st">&quot;ATL&quot;</span>,<span class="st">&quot;MIA&quot;</span>,<span class="st">&quot;DET&quot;</span>,<span class="st">&quot;DEN&quot;</span>,<span class="st">&quot;NYJ&quot;</span>,<span class="st">&quot;WAS&quot;</span>,<span class="st">&quot;JAC&quot;</span>,<span class="st">&quot;SEA&quot;</span>,</span>
<span id="cb56-3"><a href="index.html#cb56-3" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;TEN&quot;</span>,<span class="st">&quot;PHI&quot;</span>,<span class="st">&quot;IND&quot;</span>,<span class="st">&quot;CLE&quot;</span>,<span class="st">&quot;HOU&quot;</span>,<span class="st">&quot;CAR&quot;</span>,<span class="st">&quot;CHI&quot;</span>,<span class="st">&quot;NYG&quot;</span>,<span class="st">&quot;NO&quot;</span>)</span>
<span id="cb56-4"><a href="index.html#cb56-4" aria-hidden="true" tabindex="-1"></a>NFL_2021_Team_Passing <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="index.html#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Yds,<span class="at">y=</span>TD,<span class="at">label=</span>Abbr)) <span class="sc">+</span> </span>
<span id="cb56-6"><a href="index.html#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-7"><a href="index.html#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2750</span>,<span class="dv">5250</span>)) <span class="sc">+</span></span>
<span id="cb56-8"><a href="index.html#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Team Passing Yards&quot;</span>,<span class="at">y=</span><span class="st">&quot;Team Passing Touchdowns&quot;</span>,<span class="at">title=</span><span class="st">&quot;NFL Team Passing Yards, 2021&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-9"><a href="index.html#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">box.padding =</span> <span class="fl">0.3</span>) </span></code></pre></div>
<p><img src="textbook_files/figure-html/scatter4-1.png" width="672" /></p>
</div>
<div style="page-break-after: always;"></div>
</div>
<div id="kable-tables" class="section level3 hasAnchor" number="0.3.4">
<h3><span class="header-section-number">0.3.4</span> Kable Tables<a href="index.html#kable-tables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can build nice tables using <code>kableR</code> and <code>kableExtra</code>. Let’s look at a few options.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="index.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a smaller dataset as an example</span></span>
<span id="cb57-2"><a href="index.html#cb57-2" aria-hidden="true" tabindex="-1"></a>NFL21 <span class="ot">&lt;-</span> NFL_2021_Team_Passing <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb57-3"><a href="index.html#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="index.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Default output for tabular data</span></span>
<span id="cb57-5"><a href="index.html#cb57-5" aria-hidden="true" tabindex="-1"></a>NFL21</span></code></pre></div>
<pre><code>## # A tibble: 5 × 7
##   Tm                       G   Cmp   Att `Cmp%`   Yds    TD
##   &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Tampa Bay Buccaneers    17   492   731   67.3  5229    43
## 2 Los Angeles Chargers    17   443   674   65.7  4800    38
## 3 Dallas Cowboys          17   444   647   68.6  4800    40
## 4 Kansas City Chiefs      17   448   675   66.4  4791    37
## 5 Los Angeles Rams        17   406   607   66.9  4642    41</code></pre>
<p>You can find additional details on customizing kable tables at  <a href="https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf" class="uri">https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf</a></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="index.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Output using Kable (with no additional options)</span></span>
<span id="cb59-2"><a href="index.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb59-3"><a href="index.html#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="index.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Output using Kable and Kable-Styling and some additional options</span></span>
<span id="cb59-5"><a href="index.html#cb59-5" aria-hidden="true" tabindex="-1"></a>NFL21 <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">latex_options=</span><span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Tm
</th>
<th style="text-align:right;">
G
</th>
<th style="text-align:right;">
Cmp
</th>
<th style="text-align:right;">
Att
</th>
<th style="text-align:right;">
Cmp%
</th>
<th style="text-align:right;">
Yds
</th>
<th style="text-align:right;">
TD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tampa Bay Buccaneers
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
492
</td>
<td style="text-align:right;">
731
</td>
<td style="text-align:right;">
67.3
</td>
<td style="text-align:right;">
5229
</td>
<td style="text-align:right;">
43
</td>
</tr>
<tr>
<td style="text-align:left;">
Los Angeles Chargers
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
443
</td>
<td style="text-align:right;">
674
</td>
<td style="text-align:right;">
65.7
</td>
<td style="text-align:right;">
4800
</td>
<td style="text-align:right;">
38
</td>
</tr>
<tr>
<td style="text-align:left;">
Dallas Cowboys
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
444
</td>
<td style="text-align:right;">
647
</td>
<td style="text-align:right;">
68.6
</td>
<td style="text-align:right;">
4800
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:left;">
Kansas City Chiefs
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
448
</td>
<td style="text-align:right;">
675
</td>
<td style="text-align:right;">
66.4
</td>
<td style="text-align:right;">
4791
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:left;">
Los Angeles Rams
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
406
</td>
<td style="text-align:right;">
607
</td>
<td style="text-align:right;">
66.9
</td>
<td style="text-align:right;">
4642
</td>
<td style="text-align:right;">
41
</td>
</tr>
</tbody>
</table>
<p>If you are going to use kable tables frequently in a document, you can write a short function to set your default options. After I ran the function below, the function <code>kt</code> will produce a kable table with my options set.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="index.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kable table global setup</span></span>
<span id="cb60-2"><a href="index.html#cb60-2" aria-hidden="true" tabindex="-1"></a>kt <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb60-3"><a href="index.html#cb60-3" aria-hidden="true" tabindex="-1"></a>   knitr<span class="sc">::</span><span class="fu">kable</span>(data, <span class="at">digits=</span><span class="dv">3</span>, <span class="at">align=</span><span class="fu">c</span>(<span class="st">&#39;l&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;c&#39;</span>)) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">bootstrap_options=</span><span class="st">&#39;striped&#39;</span>, <span class="at">latex_options=</span><span class="st">&#39;HOLD_position&#39;</span>, <span class="at">full_width =</span> F, <span class="at">position =</span> <span class="st">&quot;center&quot;</span>)</span>
<span id="cb60-4"><a href="index.html#cb60-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="index.html#cb61-1" aria-hidden="true" tabindex="-1"></a>NFL21 <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Tm
</th>
<th style="text-align:center;">
G
</th>
<th style="text-align:center;">
Cmp
</th>
<th style="text-align:center;">
Att
</th>
<th style="text-align:center;">
Cmp%
</th>
<th style="text-align:center;">
Yds
</th>
<th style="text-align:center;">
TD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tampa Bay Buccaneers
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
492
</td>
<td style="text-align:center;">
731
</td>
<td style="text-align:center;">
67.3
</td>
<td style="text-align:center;">
5229
</td>
<td style="text-align:center;">
43
</td>
</tr>
<tr>
<td style="text-align:left;">
Los Angeles Chargers
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
443
</td>
<td style="text-align:center;">
674
</td>
<td style="text-align:center;">
65.7
</td>
<td style="text-align:center;">
4800
</td>
<td style="text-align:center;">
38
</td>
</tr>
<tr>
<td style="text-align:left;">
Dallas Cowboys
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
444
</td>
<td style="text-align:center;">
647
</td>
<td style="text-align:center;">
68.6
</td>
<td style="text-align:center;">
4800
</td>
<td style="text-align:center;">
40
</td>
</tr>
<tr>
<td style="text-align:left;">
Kansas City Chiefs
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
448
</td>
<td style="text-align:center;">
675
</td>
<td style="text-align:center;">
66.4
</td>
<td style="text-align:center;">
4791
</td>
<td style="text-align:center;">
37
</td>
</tr>
<tr>
<td style="text-align:left;">
Los Angeles Rams
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
406
</td>
<td style="text-align:center;">
607
</td>
<td style="text-align:center;">
66.9
</td>
<td style="text-align:center;">
4642
</td>
<td style="text-align:center;">
41
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="baseball" class="section level2 hasAnchor" number="0.4">
<h2><span class="header-section-number">0.4</span> Baseball<a href="index.html#baseball" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Baseball rules YouTube video: <a href="https://www.youtube.com/watch?v=skOsApsF0jQ&amp;t=63s" class="uri">https://www.youtube.com/watch?v=skOsApsF0jQ&amp;t=63s</a></p>
<div id="basic-hitting-statistics" class="section level3 hasAnchor" number="0.4.1">
<h3><span class="header-section-number">0.4.1</span> Basic Hitting Statistics<a href="index.html#basic-hitting-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Plate Appearances</strong> (PA): number of completed batting appearances</p></li>
<li><p><strong>At-Bats</strong> (AB): Batting appearances, not including bases on balls, hit by pitch, sacrifices, interference, or obstruction</p></li>
<li><p><strong>Hits</strong> (H): Times reached base because of a batted, fair ball without error by the defense</p></li>
<li><p><strong>Singles</strong> (1B): Hits on which the batter reached first base safely without the contribution of a fielding error</p></li>
<li><p><strong>Doubles</strong> (2B): Hits on which the batter reached second base safely without the contribution of a fielding error</p></li>
<li><p><strong>Triples</strong> (3B): Hits on which the batter reached third base safely without the contribution of a fielding error</p></li>
<li><p><strong>Home Runs</strong> (HR): Hits on which the batter successfully touched all four bases, without the contribution of a fielding error</p></li>
<li><p><strong>Total Bases</strong> (TB): One for each single, two for each double, three for each triple, and four for each home run</p></li>
<li><p><strong>Hit by Pitch</strong> (HBP): Times touched by a pitch and awarded first base as a result</p></li>
<li><p><strong>Sacrifice Fly</strong> (SF): Number of fly ball outs which allow another runner to advance on the basepaths or score</p></li>
<li><p><strong>Base on Balls</strong> (BB or Walk): Times receiving four balls and advancing to first base</p></li>
<li><p><strong>Intentional Base on Balls</strong> (IBB or Intentional Walk): Times receiving four balls <em>intentionally</em> and advancing to first base</p></li>
<li><p><strong>Strikeout</strong> (K): Number of times that strike three is taken or swung at and missed, or bunted foul</p></li>
<li><p><strong>Runs</strong> (R): Times reached home base legally and safely</p></li>
<li><p><strong>Runs Batted In</strong> (RBI): Number of runners who scored due to a batters’s action, except when batter grounded into double play or reached on an error</p></li>
<li><p><strong>Batting Average</strong> (AVG or BA): Hits divided by at bats</p></li>
<li><p><strong>On Base Percentage/Average</strong> (OBP or OBA): Times reached base (H + BB + HBP) divided by at bats plus walks plus hit by pitch plus sacrifice flies (AB + BB + HBP + SF)</p></li>
<li><p><strong>Slugging Percentage/Average</strong> (SLG): Total bases divided by at-bats</p></li>
<li><p><strong>On-base Plus Slugging</strong> (OPS): On-base percentage plus slugging average</p></li>
</ul>
<div style="page-break-after: always;"></div>
</div>
<div id="basic-pitching-statistics" class="section level3 hasAnchor" number="0.4.2">
<h3><span class="header-section-number">0.4.2</span> Basic Pitching Statistics<a href="index.html#basic-pitching-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Innings Pitched</strong> (IP): Number of outs recorded while pitching divided by three</p></li>
<li><p><strong>Strikeout</strong> (K): Number of batters who received strike three</p></li>
<li><p><strong>Base on Balls</strong> (BB or Walk): Times pitching four balls, allowing the batter-runner to advance to first base</p></li>
<li><p><strong>Hits Allowed</strong> (H): Total hits allowed</p></li>
<li><p><strong>Wins</strong> (W): Number of games where pitcher was pitching while his team took the lead and went on to win</p></li>
<li><p><strong>Losses</strong> (L): Number of games where pitcher was pitching while the opposing team took the lead, never lost the lead, and went on to win</p></li>
<li><p><strong>Earned Runs</strong> (ER): Number of runs that did not occur as a result of errors or passed balls</p></li>
<li><p><strong>Earned Run Average</strong> (ERA): Earned runs times innings in a game (usually nine) divided by innings pitched</p></li>
<li><p><strong>Walks and Hits Per Inning Pitched</strong> (WHIP): Walks plus hits allowed divided by innings pitched</p></li>
</ul>
</div>
<div id="advanced-baseball-hitting-statistics" class="section level3 hasAnchor" number="0.4.3">
<h3><span class="header-section-number">0.4.3</span> Advanced Baseball Hitting Statistics<a href="index.html#advanced-baseball-hitting-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Isolated Power</strong> (ISO): Slugging percentage minus Batting average</p></li>
<li><p><strong>On-base Plus Slugging Plus</strong> (OPS+): OPS normalized for park effects with 100 being league average</p></li>
<li><p><strong>Weighted On-Base Average</strong> (wOBA): Hitting rate statistic that attempts to credit the hitter for the value of each outcome. The following formula can be updated each year based on the scoring environment. The following formula was updated for the 2021 season.</p></li>
</ul>
<p><span class="math display">\[wOBA = \frac{0.69 \cdot (BB - IBB) + 0.719 \cdot HBP + 0.87 \cdot 1B + 1.217 \cdot 2B + 1.529 \cdot 3B + 1.94 \cdot HR}{AB + BB - IBB + SF + HBP}\]</span></p>
<ul>
<li><strong>Expected Weighted On-Base Average</strong> (xwOBA): Hitting rate statistic that attempts to credit the hitter for the value of each <em>expected</em> outcome based on Statcast data.</li>
</ul>
</div>
<div id="advanced-baseball-pitching-statistics" class="section level3 hasAnchor" number="0.4.4">
<h3><span class="header-section-number">0.4.4</span> Advanced Baseball Pitching Statistics<a href="index.html#advanced-baseball-pitching-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Fielding Independent Pitching</strong> (FIP): Statistic that estimates a pitcher’s run prevention independent of the performance of the defense</li>
</ul>
<p><span class="math display">\[FIP = \frac{13 \cdot HR + 3 \cdot (BB + HBP) - 2 \cdot K}{IP} + FIP_{constant}\]</span></p>
<p>The <span class="math inline">\(FIP_{constant}\)</span> is generally around 3.10 and is put FIP on a scale similar to ERA.</p>
<ul>
<li><strong>Expected Fielding Independent Pitching</strong> (xFIP): Statistic that estimates a pitcher’s expected run prevention independent of the performance of the defense</li>
</ul>
<p><span class="math display">\[xFIP = \frac{13 \cdot (Fly Balls \cdot LgHR/FB\%)+3 \cdot (BB + HBP) - 2 \cdot K}{IP} + FIP_{constant}\]</span></p>
</div>
<div id="wins-above-replacement" class="section level3 hasAnchor" number="0.4.5">
<h3><span class="header-section-number">0.4.5</span> Wins Above Replacement<a href="index.html#wins-above-replacement" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Wins Above Replacement</strong> (WAR): Estimated number of wins that a player has outperformed a replacement player by with the same playing time. This is one of the most crucial statistics in Sabermetrics.</li>
</ul>
<p>More about WAR from Fangraphs: <a href="https://library.fangraphs.com/misc/war/" class="uri">https://library.fangraphs.com/misc/war/</a></p>
<p><em>References:</em><br />
<a href="https://www.baseball-reference.com/bullpen/Baseball_statistics" class="uri">https://www.baseball-reference.com/bullpen/Baseball_statistics</a><br />
<a href="https://blogs.fangraphs.com/glossary/" class="uri">https://blogs.fangraphs.com/glossary/</a><br />
<a href="https://library.fangraphs.com/fangraphs-library-glossary/" class="uri">https://library.fangraphs.com/fangraphs-library-glossary/</a><br />
</p>
<div style="page-break-after: always;"></div>
</div>
<div id="calculating-advanced-hitting-statistics" class="section level3 hasAnchor" number="0.4.6">
<h3><span class="header-section-number">0.4.6</span> Calculating Advanced Hitting Statistics<a href="index.html#calculating-advanced-hitting-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="example">
<p><span id="exm:unlabeled-div-34" class="example"><strong>Example 0.10  </strong></span>Using the Colorado Rockies 2021 individual hitting statistics, calculate the AVG, OBA, SLG, OPS, ISO, wOBA.</p>
</div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="index.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data file and look at the header</span></span>
<span id="cb62-2"><a href="index.html#cb62-2" aria-hidden="true" tabindex="-1"></a>rox21 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/rockies_hitting2021.csv&quot;</span>)</span>
<span id="cb62-3"><a href="index.html#cb62-3" aria-hidden="true" tabindex="-1"></a>rox21 <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:center;">
PA
</th>
<th style="text-align:center;">
AB
</th>
<th style="text-align:center;">
R
</th>
<th style="text-align:center;">
H
</th>
<th style="text-align:center;">
2B
</th>
<th style="text-align:center;">
3B
</th>
<th style="text-align:center;">
HR
</th>
<th style="text-align:center;">
RBI
</th>
<th style="text-align:left;">
BB
</th>
<th style="text-align:center;">
IBB
</th>
<th style="text-align:center;">
SO
</th>
<th style="text-align:center;">
HBP
</th>
<th style="text-align:center;">
SF
</th>
<th style="text-align:center;">
oWAR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Elias Diaz
</td>
<td style="text-align:center;">
371
</td>
<td style="text-align:center;">
338
</td>
<td style="text-align:center;">
52
</td>
<td style="text-align:center;">
83
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
44
</td>
<td style="text-align:left;">
30
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
60
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1.1
</td>
</tr>
<tr>
<td style="text-align:left;">
C.J. Cron
</td>
<td style="text-align:center;">
547
</td>
<td style="text-align:center;">
470
</td>
<td style="text-align:center;">
70
</td>
<td style="text-align:center;">
132
</td>
<td style="text-align:center;">
31
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
28
</td>
<td style="text-align:center;">
92
</td>
<td style="text-align:left;">
60
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
117
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
3.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Brendan Rodgers
</td>
<td style="text-align:center;">
415
</td>
<td style="text-align:center;">
387
</td>
<td style="text-align:center;">
49
</td>
<td style="text-align:center;">
110
</td>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
51
</td>
<td style="text-align:left;">
19
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
84
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Trevor Story
</td>
<td style="text-align:center;">
595
</td>
<td style="text-align:center;">
526
</td>
<td style="text-align:center;">
88
</td>
<td style="text-align:center;">
132
</td>
<td style="text-align:center;">
34
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
24
</td>
<td style="text-align:center;">
75
</td>
<td style="text-align:left;">
53
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
139
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
3.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Ryan McMahon*
</td>
<td style="text-align:center;">
596
</td>
<td style="text-align:center;">
528
</td>
<td style="text-align:center;">
80
</td>
<td style="text-align:center;">
134
</td>
<td style="text-align:center;">
32
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
86
</td>
<td style="text-align:left;">
59
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
147
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
1.7
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="index.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new variables using the mutate function</span></span>
<span id="cb63-2"><a href="index.html#cb63-2" aria-hidden="true" tabindex="-1"></a>rox21 <span class="ot">&lt;-</span> rox21 <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="index.html#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AVG =</span> H<span class="sc">/</span>AB,<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="index.html#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OBA =</span> (H <span class="sc">+</span> BB <span class="sc">+</span> HBP)<span class="sc">/</span>(AB <span class="sc">+</span> BB <span class="sc">+</span> HBP <span class="sc">+</span> SF)) <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="index.html#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SLG =</span> ((H<span class="sc">-</span><span class="st">`</span><span class="at">2B</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">3B</span><span class="st">`</span><span class="sc">-</span>HR) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="st">`</span><span class="at">2B</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span><span class="st">`</span><span class="at">3B</span><span class="st">`</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>HR)<span class="sc">/</span>AB) <span class="sc">%&gt;%</span></span>
<span id="cb63-6"><a href="index.html#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OPS =</span> SLG <span class="sc">+</span> OBA) <span class="sc">%&gt;%</span></span>
<span id="cb63-7"><a href="index.html#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wOBA =</span> (<span class="fl">0.692</span> <span class="sc">*</span> (BB <span class="sc">-</span> IBB) <span class="sc">+</span> <span class="fl">0.722</span> <span class="sc">*</span> HBP <span class="sc">+</span> <span class="fl">0.879</span> <span class="sc">*</span> (H<span class="sc">-</span><span class="st">`</span><span class="at">2B</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">3B</span><span class="st">`</span><span class="sc">-</span>HR) <span class="sc">+</span> <span class="fl">1.242</span> <span class="sc">*</span> <span class="st">`</span><span class="at">2B</span><span class="st">`</span> <span class="sc">+</span> <span class="fl">1.568</span> <span class="sc">*</span> <span class="st">`</span><span class="at">3B</span><span class="st">`</span> <span class="sc">+</span> <span class="fl">2.007</span> <span class="sc">*</span> HR)<span class="sc">/</span>(AB <span class="sc">+</span> BB <span class="sc">-</span> IBB <span class="sc">+</span> SF <span class="sc">+</span> HBP)) <span class="sc">%&gt;%</span></span>
<span id="cb63-8"><a href="index.html#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ISO =</span> SLG<span class="sc">-</span>AVG)</span>
<span id="cb63-9"><a href="index.html#cb63-9" aria-hidden="true" tabindex="-1"></a>rox21 <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Name,PA,AVG,OBA,SLG,OPS,wOBA,ISO) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:center;">
PA
</th>
<th style="text-align:center;">
AVG
</th>
<th style="text-align:center;">
OBA
</th>
<th style="text-align:center;">
SLG
</th>
<th style="text-align:center;">
OPS
</th>
<th style="text-align:center;">
wOBA
</th>
<th style="text-align:center;">
ISO
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Elias Diaz
</td>
<td style="text-align:center;">
371
</td>
<td style="text-align:center;">
0.246
</td>
<td style="text-align:center;">
0.310
</td>
<td style="text-align:center;">
0.464
</td>
<td style="text-align:center;">
0.774
</td>
<td style="text-align:center;">
0.330
</td>
<td style="text-align:center;">
0.219
</td>
</tr>
<tr>
<td style="text-align:left;">
C.J. Cron
</td>
<td style="text-align:center;">
547
</td>
<td style="text-align:center;">
0.281
</td>
<td style="text-align:center;">
0.375
</td>
<td style="text-align:center;">
0.530
</td>
<td style="text-align:center;">
0.905
</td>
<td style="text-align:center;">
0.383
</td>
<td style="text-align:center;">
0.249
</td>
</tr>
<tr>
<td style="text-align:left;">
Brendan Rodgers
</td>
<td style="text-align:center;">
415
</td>
<td style="text-align:center;">
0.284
</td>
<td style="text-align:center;">
0.328
</td>
<td style="text-align:center;">
0.470
</td>
<td style="text-align:center;">
0.798
</td>
<td style="text-align:center;">
0.341
</td>
<td style="text-align:center;">
0.186
</td>
</tr>
<tr>
<td style="text-align:left;">
Trevor Story
</td>
<td style="text-align:center;">
595
</td>
<td style="text-align:center;">
0.251
</td>
<td style="text-align:center;">
0.329
</td>
<td style="text-align:center;">
0.471
</td>
<td style="text-align:center;">
0.801
</td>
<td style="text-align:center;">
0.341
</td>
<td style="text-align:center;">
0.221
</td>
</tr>
<tr>
<td style="text-align:left;">
Ryan McMahon*
</td>
<td style="text-align:center;">
596
</td>
<td style="text-align:center;">
0.254
</td>
<td style="text-align:center;">
0.331
</td>
<td style="text-align:center;">
0.449
</td>
<td style="text-align:center;">
0.779
</td>
<td style="text-align:center;">
0.334
</td>
<td style="text-align:center;">
0.195
</td>
</tr>
</tbody>
</table>
<div class="example">
<p><span id="exm:unlabeled-div-35" class="example"><strong>Example 0.11  </strong></span>oWAR is Baseball Reference’s offensive WAR statistic. Note that Baseball Reference and Fangraphs use different formulas when calculating WAR though their results are typically similar. For Rockies players with at least 100 at-bats in 2021, what hitting statistics are most and least correlated to oWAR?</p>
</div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="index.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s remove players with less than 100 ABs</span></span>
<span id="cb64-2"><a href="index.html#cb64-2" aria-hidden="true" tabindex="-1"></a>rox21_100 <span class="ot">&lt;-</span> rox21 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(AB <span class="sc">&gt;=</span> <span class="dv">100</span>)</span>
<span id="cb64-3"><a href="index.html#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="index.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># GGally package has a nice pairs plotting function</span></span>
<span id="cb64-5"><a href="index.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;GGally&quot;</span>)</span>
<span id="cb64-6"><a href="index.html#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="index.html#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard hitting statistics</span></span>
<span id="cb64-8"><a href="index.html#cb64-8" aria-hidden="true" tabindex="-1"></a>rox21_100 <span class="sc">%&gt;%</span> <span class="fu">select</span>(oWAR,H,<span class="st">`</span><span class="at">2B</span><span class="st">`</span>,<span class="st">`</span><span class="at">3B</span><span class="st">`</span>,HR,R,RBI) <span class="sc">%&gt;%</span> <span class="fu">ggpairs</span>() <span class="sc">+</span></span>
<span id="cb64-9"><a href="index.html#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="index.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rate statistics</span></span>
<span id="cb65-2"><a href="index.html#cb65-2" aria-hidden="true" tabindex="-1"></a>rox21_100 <span class="sc">%&gt;%</span> <span class="fu">select</span>(oWAR,AVG,OBA,SLG,OPS,wOBA) <span class="sc">%&gt;%</span> <span class="fu">ggpairs</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="evaluating-advanced-pitching-statistics" class="section level3 hasAnchor" number="0.4.7">
<h3><span class="header-section-number">0.4.7</span> Evaluating Advanced Pitching Statistics<a href="index.html#evaluating-advanced-pitching-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Earned run average (ERA) has been traditionally used to evaluate a pitcher, however, it has some flaws. First of all, it is highly dependent on the fielders playing behind the pitcher. If a pitcher’s shortstop has poor range, he won’t convert as many groundballs into outs as a shortstop with good range. ERA is also a noisy measurement in that can be affected easily by random luck.</p>
<p>To overcome some of the downsides of ERA, FIP and xFIP were developed to help reduce the variance (noise) of the measurement and to remove factors, like defense, that are not a function of the pitcher’s ability.</p>
<p>Let’s look at the twenty starting pitchers that had the most innings pitched in MLB for the total of the 2020 and 2021 seasons. We want to examine the year-to-year correlation between ERA, FIP, and xFIP.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="index.html#cb66-1" aria-hidden="true" tabindex="-1"></a>pitchers2021 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/MLBpitchers20-21.csv&quot;</span>)</span>
<span id="cb66-2"><a href="index.html#cb66-2" aria-hidden="true" tabindex="-1"></a>pitchers2021 <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Player
</th>
<th style="text-align:center;">
ERA20
</th>
<th style="text-align:center;">
FIP20
</th>
<th style="text-align:center;">
xFIP20
</th>
<th style="text-align:center;">
ERA21
</th>
<th style="text-align:center;">
FIP21
</th>
<th style="text-align:center;">
xFIP21
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Zack Wheeler
</td>
<td style="text-align:center;">
2.92
</td>
<td style="text-align:center;">
3.22
</td>
<td style="text-align:center;">
3.76
</td>
<td style="text-align:center;">
2.78
</td>
<td style="text-align:center;">
2.59
</td>
<td style="text-align:center;">
2.84
</td>
</tr>
<tr>
<td style="text-align:left;">
Adam Wainwright
</td>
<td style="text-align:center;">
3.15
</td>
<td style="text-align:center;">
4.11
</td>
<td style="text-align:center;">
4.23
</td>
<td style="text-align:center;">
3.05
</td>
<td style="text-align:center;">
3.66
</td>
<td style="text-align:center;">
3.87
</td>
</tr>
<tr>
<td style="text-align:left;">
Kyle Hendricks
</td>
<td style="text-align:center;">
2.88
</td>
<td style="text-align:center;">
3.55
</td>
<td style="text-align:center;">
3.78
</td>
<td style="text-align:center;">
0.77
</td>
<td style="text-align:center;">
4.89
</td>
<td style="text-align:center;">
4.61
</td>
</tr>
<tr>
<td style="text-align:left;">
German Marquez
</td>
<td style="text-align:center;">
3.75
</td>
<td style="text-align:center;">
3.28
</td>
<td style="text-align:center;">
3.83
</td>
<td style="text-align:center;">
4.40
</td>
<td style="text-align:center;">
3.86
</td>
<td style="text-align:center;">
3.64
</td>
</tr>
<tr>
<td style="text-align:left;">
Luis Castillo
</td>
<td style="text-align:center;">
3.21
</td>
<td style="text-align:center;">
2.65
</td>
<td style="text-align:center;">
2.82
</td>
<td style="text-align:center;">
3.98
</td>
<td style="text-align:center;">
3.75
</td>
<td style="text-align:center;">
3.63
</td>
</tr>
</tbody>
</table>
<p>Let’s look at the correlations between these variables, paying close attention to what variables are most correlated with ERA20, a pitcher’s ERA in 2020.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="index.html#cb67-1" aria-hidden="true" tabindex="-1"></a>pitchers2021 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Player) <span class="sc">%&gt;%</span> <span class="fu">ggpairs</span>(<span class="at">title=</span><span class="st">&quot;Correlation plot of pitching statistics, MLB 2020-2021&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>This is a small dataset that only contains twenty pitchers (samples), but you will notice that ERA20 is more highly correlated with FIP21 and xFIP21 than ERA21. In other words, FIP and xFIP are likely better predictors of ERA success in the future rather than ERA success in the past.</p>
</div>
</div>
<div id="football" class="section level2 hasAnchor" number="0.5">
<h2><span class="header-section-number">0.5</span> Football<a href="index.html#football" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://www.youtube.com/watch?v=Ddwp1HyEFRE">Link to YouTube video describing football rules</a></p>
<div id="basic-football-statistics" class="section level3 hasAnchor" number="0.5.1">
<h3><span class="header-section-number">0.5.1</span> Basic Football Statistics<a href="index.html#basic-football-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Yards</strong> (Yd): Number of yards gained from the line of scrimmage (can be broken down into Offense: Rushing and Passing Yards, Defense: Rushing and Passing Yards Allowed, and Special Teams: Kick and Punt Return Yards)</p></li>
<li><p><strong>Touchdowns</strong> (TD): Number of times the offense carries or passes the ball successfully into the end zone of the opposing side (can be broken down into: Offensive TDs: Rushing and Passing TDs, Defensive TDs: interception or fumble recovery for a touchdown, and Special Teams TDs: kick or punt return touchdowns)</p></li>
<li><p><strong>Sacks</strong> (Sk): Number of times a player or a team tackles the quarterback behind the line of scrimmage before he can throw a pass</p></li>
<li><p><strong>Interceptions</strong> (INT): Number of times a player or a team catches an opponent’s pass</p></li>
</ul>
</div>
<div id="advanced-football-statistics" class="section level3 hasAnchor" number="0.5.2">
<h3><span class="header-section-number">0.5.2</span> Advanced Football Statistics<a href="index.html#advanced-football-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Passer Rating (or Passing Efficiency)</strong>: Measure of performance of a quarterback</li>
</ul>
<p>For NFL, the formula is as follows:<br />
</p>
<p><span class="math display">\[Passer Rating_{NFL} = \left(\frac{a+b+c+d}{6}\right) \cdot 100\]</span></p>
<p>where:
<span class="math display">\[a = \left(\frac{COMP}{ATT}-0.3\right) \cdot 5\]</span>
<span class="math display">\[b = \left(\frac{YDS}{ATT} - 3\right) \cdot 0.25\]</span>
<span class="math display">\[c = \left(\frac{TD}{ATT}\right) \cdot 20\]</span>
<span class="math display">\[d = 2.375 - \left(\frac{INT}{ATT} \cdot 25\right)\]</span></p>
<p>ATT = Number of passing attempts, COMP = Number of completions, YDS = Passing yards, TD = Touchdown passes, INT = Interceptions<br />
</p>
<p><em>Note:</em> If the result of any calculation is greater than 2.375, it is set to 2.375. If the result is a negative number, it is set to zero.<br />
</p>
<p>For College Football, the formula is as follows:<br />
</p>
<p><span class="math display">\[Passer Rating_{NCAAF} = \frac{(8.4 \cdot YDS) + (330 \cdot TD) + (100 \cdot COMP) - (200 \cdot INT)}{ATT}\]</span></p>
<ul>
<li><p><strong>Total Quarterback Rating</strong> (QBR): Proprietary measure of performance of a quarterback developed by ESPN in 2011. This is a more comprehensive measurement of quarterback performance that accounts for the quarterback’s impact on his team’s passes, rushes, turnovers, and penalties in terms of <strong>expected points added</strong>.</p></li>
<li><p><strong>Expected Points Added</strong> (EPA): Measure of how many points a player or a play is worth to a team.</p></li>
</ul>
<p><em>References:</em><br />
<a href="https://www.pro-football-reference.com/about/glossary.htm" class="uri">https://www.pro-football-reference.com/about/glossary.htm</a><br />
<a href="https://en.wikipedia.org/wiki/Passer_rating" class="uri">https://en.wikipedia.org/wiki/Passer_rating</a></p>
<div style="page-break-after: always;"></div>
<div class="example">
<p><span id="exm:unlabeled-div-36" class="example"><strong>Example 0.12  </strong></span>Individual NFL quarterback passing statistics for the 2021 season are provided in <code>NFL_Ind_Passing_2021.csv</code>. Note that this dataset only includes quarterbacks with at least 100 passing yards in 2021. Passer efficiency is given in the <code>RTG</code> column.</p>
</div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="index.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data: https://www.espn.com/nfl/stats/player</span></span>
<span id="cb68-2"><a href="index.html#cb68-2" aria-hidden="true" tabindex="-1"></a>QB_21 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/NFL_Ind_Passing_2021.csv&quot;</span>)</span>
<span id="cb68-3"><a href="index.html#cb68-3" aria-hidden="true" tabindex="-1"></a>QB_21 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>,<span class="dv">15</span><span class="sc">:</span><span class="dv">16</span>) <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:center;">
GP
</th>
<th style="text-align:center;">
CMP
</th>
<th style="text-align:center;">
ATT
</th>
<th style="text-align:center;">
CMP%
</th>
<th style="text-align:center;">
YDS
</th>
<th style="text-align:center;">
AVG
</th>
<th style="text-align:center;">
TD
</th>
<th style="text-align:center;">
INT
</th>
<th style="text-align:left;">
QBR
</th>
<th style="text-align:center;">
RTG
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tom Brady
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
485
</td>
<td style="text-align:center;">
719
</td>
<td style="text-align:center;">
67.5
</td>
<td style="text-align:center;">
5316
</td>
<td style="text-align:center;">
7.4
</td>
<td style="text-align:center;">
43
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:left;">
68.1
</td>
<td style="text-align:center;">
102.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Justin Herbert
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
443
</td>
<td style="text-align:center;">
672
</td>
<td style="text-align:center;">
65.9
</td>
<td style="text-align:center;">
5014
</td>
<td style="text-align:center;">
7.5
</td>
<td style="text-align:center;">
38
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:left;">
65.6
</td>
<td style="text-align:center;">
97.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Patrick Mahomes
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
436
</td>
<td style="text-align:center;">
658
</td>
<td style="text-align:center;">
66.3
</td>
<td style="text-align:center;">
4839
</td>
<td style="text-align:center;">
7.4
</td>
<td style="text-align:center;">
37
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:left;">
62.2
</td>
<td style="text-align:center;">
98.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Josh Allen
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
409
</td>
<td style="text-align:center;">
646
</td>
<td style="text-align:center;">
63.3
</td>
<td style="text-align:center;">
4407
</td>
<td style="text-align:center;">
6.8
</td>
<td style="text-align:center;">
36
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:left;">
60.7
</td>
<td style="text-align:center;">
92.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Derek Carr
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
428
</td>
<td style="text-align:center;">
626
</td>
<td style="text-align:center;">
68.4
</td>
<td style="text-align:center;">
4804
</td>
<td style="text-align:center;">
7.7
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:left;">
52.4
</td>
<td style="text-align:center;">
94.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Ben Roethlisberger
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
390
</td>
<td style="text-align:center;">
605
</td>
<td style="text-align:center;">
64.5
</td>
<td style="text-align:center;">
3740
</td>
<td style="text-align:center;">
6.2
</td>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:left;">
35.6
</td>
<td style="text-align:center;">
86.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Trevor Lawrence
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
359
</td>
<td style="text-align:center;">
602
</td>
<td style="text-align:center;">
59.6
</td>
<td style="text-align:center;">
3641
</td>
<td style="text-align:center;">
6.0
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:left;">
33.5
</td>
<td style="text-align:center;">
71.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Matthew Stafford
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
404
</td>
<td style="text-align:center;">
601
</td>
<td style="text-align:center;">
67.2
</td>
<td style="text-align:center;">
4886
</td>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
41
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:left;">
63.8
</td>
<td style="text-align:center;">
102.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Dak Prescott
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
410
</td>
<td style="text-align:center;">
596
</td>
<td style="text-align:center;">
68.8
</td>
<td style="text-align:center;">
4449
</td>
<td style="text-align:center;">
7.5
</td>
<td style="text-align:center;">
37
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:left;">
54.6
</td>
<td style="text-align:center;">
104.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Kirk Cousins
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
372
</td>
<td style="text-align:center;">
561
</td>
<td style="text-align:center;">
66.3
</td>
<td style="text-align:center;">
4221
</td>
<td style="text-align:center;">
7.5
</td>
<td style="text-align:center;">
33
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:left;">
52.3
</td>
<td style="text-align:center;">
103.1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="index.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(QB_21)</span></code></pre></div>
<pre><code>##  [1] &quot;Name&quot;  &quot;Team&quot;  &quot;GP&quot;    &quot;CMP&quot;   &quot;ATT&quot;   &quot;CMP%&quot;  &quot;YDS&quot;   &quot;AVG&quot;   &quot;YDS/G&quot;
## [10] &quot;LNG&quot;   &quot;TD&quot;    &quot;INT&quot;   &quot;SACK&quot;  &quot;SYL&quot;   &quot;QBR&quot;   &quot;RTG&quot;</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Confirm this is passer rating by creating a new variable to calculate passer rating using the provided statistics.</li>
</ol>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="index.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create intermediate variables</span></span>
<span id="cb71-2"><a href="index.html#cb71-2" aria-hidden="true" tabindex="-1"></a>QB_21 <span class="ot">&lt;-</span> QB_21 <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="index.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a =</span> (CMP<span class="sc">/</span>ATT<span class="fl">-0.3</span>)<span class="sc">*</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="index.html#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">b =</span> (YDS<span class="sc">/</span>ATT<span class="dv">-3</span>)<span class="sc">*</span><span class="fl">0.25</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-5"><a href="index.html#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c =</span> (TD<span class="sc">/</span>ATT)<span class="sc">*</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-6"><a href="index.html#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fl">2.375</span> <span class="sc">-</span>(INT<span class="sc">/</span>ATT<span class="sc">*</span><span class="dv">25</span>))</span>
<span id="cb71-7"><a href="index.html#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="index.html#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check to see if a,b,c,d are less than 0 or greater than 2.375</span></span>
<span id="cb71-9"><a href="index.html#cb71-9" aria-hidden="true" tabindex="-1"></a>QB_21 <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="fu">min</span>(a),<span class="fu">max</span>(a),<span class="fu">min</span>(b),<span class="fu">max</span>(b),<span class="fu">min</span>(c),<span class="fu">max</span>(c),<span class="fu">min</span>(d),<span class="fu">max</span>(d))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 8
##   `min(a)` `max(a)` `min(b)` `max(b)` `min(c)` `max(c)` `min(d)` `max(d)`
##      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1     1.19     2.02    0.433     1.47    0.319     1.74    0.860     2.19</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="index.html#cb73-1" aria-hidden="true" tabindex="-1"></a>QB_21 <span class="ot">&lt;-</span> QB_21 <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="index.html#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR =</span> (a<span class="sc">+</span>b<span class="sc">+</span>c<span class="sc">+</span>d)<span class="sc">/</span><span class="dv">6</span><span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb73-3"><a href="index.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="index.html#cb73-4" aria-hidden="true" tabindex="-1"></a>QB_21 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Name,RTG,PR) <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:center;">
RTG
</th>
<th style="text-align:center;">
PR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tom Brady
</td>
<td style="text-align:center;">
102.1
</td>
<td style="text-align:center;">
102.083
</td>
</tr>
<tr>
<td style="text-align:left;">
Justin Herbert
</td>
<td style="text-align:center;">
97.7
</td>
<td style="text-align:center;">
97.656
</td>
</tr>
<tr>
<td style="text-align:left;">
Patrick Mahomes
</td>
<td style="text-align:center;">
98.5
</td>
<td style="text-align:center;">
98.455
</td>
</tr>
<tr>
<td style="text-align:left;">
Josh Allen
</td>
<td style="text-align:center;">
92.2
</td>
<td style="text-align:center;">
92.170
</td>
</tr>
<tr>
<td style="text-align:left;">
Derek Carr
</td>
<td style="text-align:center;">
94.0
</td>
<td style="text-align:center;">
93.963
</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: lower-alpha">
<li>What counting statistics are most correlated with passer rating and with QBR?</li>
</ol>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="index.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grab the counting statistics and create a correlation plot with PR and QBR</span></span>
<span id="cb74-2"><a href="index.html#cb74-2" aria-hidden="true" tabindex="-1"></a>QB_21 <span class="sc">%&gt;%</span> <span class="fu">select</span>(PR,QBR,CMP,ATT,YDS,TD,INT,SACK,SYL) <span class="sc">%&gt;%</span> <span class="fu">ggpairs</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>What rate statistics are most correlated with passer efficiency and with QBR? Use CMP% (completion percentage, completions per attempt), AVG (average yards per attempt), YDS/G (yards per game), and create new variables for interceptions per attempt, touchdowns per attempt, and sacks per attempt.</li>
</ol>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="index.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grab the counting statistics and create a correlation plot with PR and QBR</span></span>
<span id="cb75-2"><a href="index.html#cb75-2" aria-hidden="true" tabindex="-1"></a>QB_21 <span class="ot">&lt;-</span> QB_21 <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="index.html#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">INTp =</span> INT<span class="sc">/</span>ATT) <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="index.html#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TDp =</span> TD<span class="sc">/</span>ATT) <span class="sc">%&gt;%</span></span>
<span id="cb75-5"><a href="index.html#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SACKp =</span> SACK<span class="sc">/</span>ATT)</span>
<span id="cb75-6"><a href="index.html#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="index.html#cb75-7" aria-hidden="true" tabindex="-1"></a>QB_21 <span class="sc">%&gt;%</span> <span class="fu">select</span>(PR,QBR,<span class="st">`</span><span class="at">CMP%</span><span class="st">`</span>,AVG,<span class="st">`</span><span class="at">YDS/G</span><span class="st">`</span>,INTp,TDp,SACKp) <span class="sc">%&gt;%</span> <span class="fu">ggpairs</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="basketball" class="section level2 hasAnchor" number="0.6">
<h2><span class="header-section-number">0.6</span> Basketball<a href="index.html#basketball" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://www.youtube.com/watch?v=wYjp2zoqQrs">Link to YouTube video describing basketball rules</a></p>
<div id="basic-basketball-statistics" class="section level3 hasAnchor" number="0.6.1">
<h3><span class="header-section-number">0.6.1</span> Basic Basketball Statistics<a href="index.html#basic-basketball-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Field Goal (FG)</strong>: A made shot from either 2- or 3-point range. Free throws, worth 1 point, are not considered field goals. Field goal statistics often include attempts, makes, and percentage.</p></li>
<li><p><strong>Free Throw (FT)</strong>: After certain fouls, the clock stops and a player shoots an uncontested shot from the foul line. These free throws are worth 1 point each; like with field goals, FT statistics often include attempts, makes, and percentage.</p></li>
<li><p><strong>Assists (AST)</strong>: A player is credited with an assist if they pass the ball to a teammate and the teammate scores a field goal after zero or one dribbles. No more than one assist can be recorded per field goal.</p></li>
<li><p><strong>Turnover (TO)</strong>: A player or team can be charged with a turnover for an action or violation that ends their offensive possession before being able to attempt a field goal. For a player (especially a guard), TOs can be compared to assists using Assist:Turnover ratio.</p></li>
<li><p><strong>Rebound (REB)</strong>: The first player to gain control of the ball following a missed field goal is credited with a rebound. If the player is on the same team as the field goal shooter, it is an offensive rebound; otherwise, a defensive rebound.</p></li>
<li><p><strong>Points per Possession (PPP)</strong>: Divides a team’s points by number of possessions to account for a team’s pace.</p></li>
</ul>
</div>
<div id="advanced-basketball-statistics" class="section level3 hasAnchor" number="0.6.2">
<h3><span class="header-section-number">0.6.2</span> Advanced Basketball Statistics<a href="index.html#advanced-basketball-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>True Shooting Percentage (TS%)</strong>: Unlike traditional shooting percentage, this statistic considers both field goals and free throws. It also gives more weight to shots that are worth more points.</p></li>
<li><p><strong>Win Shares</strong>: Win shares give each player points for actions that contribute to a team’s success. Win shares take into account a variety of offensive and defensive statistics, but can be calculated using different methods on different platforms.</p></li>
<li><p><strong>Value Over Replacement Player (VORP)</strong>: This is basketball’s response to baseball’s WAR. VORP is a rate statistic that estimates a player’s offensive output as compared to an “average” player.</p></li>
<li><p><strong>Player Efficiency Rating (PER)</strong>: According to its creator John Hollinger,
“The PER sums up all a player’s positive accomplishments, subtracts the negative accomplishments, and returns a per-minute rating of a player’s performance.” This statistic rewards great offensive performance more than great defensive plays.</p></li>
</ul>
<p><em>References:</em><br />
<a href="https://www.basketball-reference.com/about/per.html" class="uri">https://www.basketball-reference.com/about/per.html</a><br />
<a href="https://www.basketball-reference.com/about/ws.html" class="uri">https://www.basketball-reference.com/about/ws.html</a><br />
<a href="https://www.basketball-reference.com/about/glossary.html" class="uri">https://www.basketball-reference.com/about/glossary.html</a></p>
</div>
<div id="four-factors" class="section level3 hasAnchor" number="0.6.3">
<h3><span class="header-section-number">0.6.3</span> Four Factors<a href="index.html#four-factors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tibbles are a type of data frame supported by the <code>tidyverse</code> package. The following tibble contains data from a Mountain West tournament game played between the CSU and Wyoming women’s basketball teams during the 2021-2022 season, which CSU won 51-38. <a href="https://csurams.com/sports/womens-basketball/stats/2021-22/wyoming/boxscore/16095">(Here’s the link to the box score on the CSU athletics website.)</a></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="index.html#cb76-1" aria-hidden="true" tabindex="-1"></a>basketball_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">team =</span> <span class="fu">c</span>(<span class="st">&quot;CSU&quot;</span>,<span class="st">&quot;WYO&quot;</span>), <span class="at">FG =</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">15</span>), <span class="at">FGA =</span> <span class="fu">c</span>(<span class="dv">48</span>,<span class="dv">60</span>), <span class="at">THREEP =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>), <span class="at">FT =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">4</span>), <span class="at">FTA =</span> <span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">4</span>), <span class="at">ORB =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">14</span>), <span class="at">DRB =</span> <span class="fu">c</span>(<span class="dv">31</span>,<span class="dv">30</span>), <span class="at">TOV =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">12</span>))</span>
<span id="cb76-2"><a href="index.html#cb76-2" aria-hidden="true" tabindex="-1"></a>basketball_data <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
team
</th>
<th style="text-align:center;">
FG
</th>
<th style="text-align:center;">
FGA
</th>
<th style="text-align:center;">
THREEP
</th>
<th style="text-align:center;">
FT
</th>
<th style="text-align:center;">
FTA
</th>
<th style="text-align:center;">
ORB
</th>
<th style="text-align:center;">
DRB
</th>
<th style="text-align:center;">
TOV
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
CSU
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
48
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
31
</td>
<td style="text-align:center;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
WYO
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
60
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
30
</td>
<td style="text-align:center;">
12
</td>
</tr>
</tbody>
</table>
<p>This tibble contains all the data needed to calculate the <em>Four Factors</em>. The Four Factors of a basketball game are statistics formulated by Dean Oliver, former Director of Quantitative Analysis for the Denver Nuggets (among other roles). These statistics are also promoted by sports data platforms like Hudl.com.</p>
<p>The Four Factors each have offensive and defensive versions; for this example, we’ll focus on the offensive perspective.</p>
<p>The first is <strong>Effective Field Goal Percentage</strong>, commonly abbreviated eFG%. The formula is as follows:</p>
<p><span class="math inline">\(eFG\% = \frac{FG\ +\ 0.5(3P)}{FGA}\)</span></p>
<p>Secondly, <strong>Turnover Percentage</strong> (TOV%) is calculated as:</p>
<p><span class="math inline">\(TOV\% = \frac{TOV}{FGA\ +\ 0.44(FTA)\ +\ TOV}\)</span></p>
<p>Next, <strong>Rebounding Percentage</strong> (ORB%) is computed as:</p>
<p><span class="math inline">\(ORB\% = \frac{ORB}{ORB\ +\ Opponent\ DRB}\)</span></p>
<p>Finally, the <strong>Free Throw Factor</strong> is found using:</p>
<p><span class="math inline">\(FT\ factor = \frac{FT}{FGA}\)</span></p>
<p>Note: You do not have to know these formulas for the test. They are just used for this example.</p>
<p>Let’s calculate the values of eFG%, TOV%, ORB%, and Free Throw Factor for both CSU and Wyoming and add them as new columns in the tibble using the <code>add_column</code> function.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="index.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(basketball_data)</span>
<span id="cb77-2"><a href="index.html#cb77-2" aria-hidden="true" tabindex="-1"></a>eFG <span class="ot">&lt;-</span> <span class="fu">round</span>((FG <span class="sc">+</span> .<span class="dv">5</span> <span class="sc">*</span> THREEP)<span class="sc">/</span>FGA, <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb77-3"><a href="index.html#cb77-3" aria-hidden="true" tabindex="-1"></a>TOVPCT <span class="ot">&lt;-</span> <span class="fu">round</span>(TOV <span class="sc">/</span> (FGA <span class="sc">+</span> .<span class="dv">44</span> <span class="sc">*</span> FTA <span class="sc">+</span> TOV), <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb77-4"><a href="index.html#cb77-4" aria-hidden="true" tabindex="-1"></a>ORBPCT <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(ORB[<span class="dv">1</span>]<span class="sc">/</span>(ORB[<span class="dv">1</span>]<span class="sc">+</span>DRB[<span class="dv">2</span>]), ORB[<span class="dv">2</span>]<span class="sc">/</span>(ORB[<span class="dv">2</span>]<span class="sc">+</span>DRB[<span class="dv">1</span>])), <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb77-5"><a href="index.html#cb77-5" aria-hidden="true" tabindex="-1"></a>FTFACTOR <span class="ot">&lt;-</span> <span class="fu">round</span>(FT<span class="sc">/</span>FGA, <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb77-6"><a href="index.html#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="index.html#cb77-7" aria-hidden="true" tabindex="-1"></a>basketball_data <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(eFG, TOVPCT, ORBPCT, FTFACTOR) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
team
</th>
<th style="text-align:center;">
FG
</th>
<th style="text-align:center;">
FGA
</th>
<th style="text-align:center;">
THREEP
</th>
<th style="text-align:center;">
FT
</th>
<th style="text-align:center;">
FTA
</th>
<th style="text-align:center;">
ORB
</th>
<th style="text-align:center;">
DRB
</th>
<th style="text-align:center;">
TOV
</th>
<th style="text-align:left;">
eFG
</th>
<th style="text-align:center;">
TOVPCT
</th>
<th style="text-align:center;">
ORBPCT
</th>
<th style="text-align:center;">
FTFACTOR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
CSU
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
48
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
31
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:left;">
34.4
</td>
<td style="text-align:center;">
8.5
</td>
<td style="text-align:center;">
6.2
</td>
<td style="text-align:center;">
20.8
</td>
</tr>
<tr>
<td style="text-align:left;">
WYO
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
60
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
30
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:left;">
28.3
</td>
<td style="text-align:center;">
16.3
</td>
<td style="text-align:center;">
31.1
</td>
<td style="text-align:center;">
6.7
</td>
</tr>
</tbody>
</table>
<p>While this method does produce Four Factors data, it could be difficult to scale for calculating the same statistics for a sample of several games. In the next section, we will introduce an <code>R</code> package that aids in the calculation of Four Factors.</p>
<div id="basketballanalyzer-four-factors" class="section level4 hasAnchor" number="0.6.3.1">
<h4><span class="header-section-number">0.6.3.1</span> BasketballAnalyzeR Four Factors<a href="index.html#basketballanalyzer-four-factors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The authors of “Basketball Data Science With Applications in R” developed the <code>BasketballAnalyzeR</code> package to be used in conjunction with the book. <code>BasketballAnalyzeR</code> includes built-in datasets from the 2017-18 NBA season and provides many functions for analyzing and plotting basketball data. One such function is <code>fourfactors</code>, which offers a simpler way to perform a four factors analysis.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="index.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;BasketballAnalyzeR&quot;</span>)</span>
<span id="cb78-2"><a href="index.html#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="index.html#cb78-3" aria-hidden="true" tabindex="-1"></a>teams <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DEN&quot;</span>, <span class="st">&quot;CLE&quot;</span>, <span class="st">&quot;GSW&quot;</span>) <span class="co">#Nuggets, Cavaliers, Warriors</span></span>
<span id="cb78-4"><a href="index.html#cb78-4" aria-hidden="true" tabindex="-1"></a>team_data <span class="ot">&lt;-</span> <span class="fu">which</span>(Tadd<span class="sc">$</span>team <span class="sc">%in%</span> teams)</span>
<span id="cb78-5"><a href="index.html#cb78-5" aria-hidden="true" tabindex="-1"></a>four_factors_teams <span class="ot">&lt;-</span> <span class="fu">fourfactors</span>(Tbox[team_data, ], Obox[team_data, ])</span>
<span id="cb78-6"><a href="index.html#cb78-6" aria-hidden="true" tabindex="-1"></a>four_factors_teams <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">15</span>) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Team
</th>
<th style="text-align:center;">
F1.Off
</th>
<th style="text-align:center;">
F2.Off
</th>
<th style="text-align:center;">
F3.Off
</th>
<th style="text-align:center;">
F4.Off
</th>
<th style="text-align:center;">
F1.Def
</th>
<th style="text-align:center;">
F2.Def
</th>
<th style="text-align:center;">
F3.Def
</th>
<th style="text-align:center;">
F4.Def
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Cleveland Cavaliers
</td>
<td style="text-align:center;">
54.70
</td>
<td style="text-align:center;">
13.70
</td>
<td style="text-align:center;">
20.06
</td>
<td style="text-align:center;">
21.41
</td>
<td style="text-align:center;">
53.98
</td>
<td style="text-align:center;">
13.43
</td>
<td style="text-align:center;">
77.27
</td>
<td style="text-align:center;">
16.58
</td>
</tr>
<tr>
<td style="text-align:left;">
Denver Nuggets
</td>
<td style="text-align:center;">
53.62
</td>
<td style="text-align:center;">
14.90
</td>
<td style="text-align:center;">
25.66
</td>
<td style="text-align:center;">
19.77
</td>
<td style="text-align:center;">
53.88
</td>
<td style="text-align:center;">
13.83
</td>
<td style="text-align:center;">
77.45
</td>
<td style="text-align:center;">
17.35
</td>
</tr>
<tr>
<td style="text-align:left;">
Golden State Warriors
</td>
<td style="text-align:center;">
56.91
</td>
<td style="text-align:center;">
15.26
</td>
<td style="text-align:center;">
21.05
</td>
<td style="text-align:center;">
19.48
</td>
<td style="text-align:center;">
50.44
</td>
<td style="text-align:center;">
13.89
</td>
<td style="text-align:center;">
76.31
</td>
<td style="text-align:center;">
18.55
</td>
</tr>
</tbody>
</table>
<p>This is a much simpler and neater way to calculate Four Factors.</p>
<p>In the 2017-18 season, the Warriors and Cavaliers met in the NBA Finals, while the Nuggets just missed the playoffs. It would be expected that the two Finals teams would have higher values for the Four Factors. While this is mostly true, for which of the Four Factors did the Nuggets have the highest value?</p>
<p>A: Factor 3 (rebounding percentage), both offensive and defensive.</p>
</div>
</div>
<div id="shot-charts" class="section level3 hasAnchor" number="0.6.4">
<h3><span class="header-section-number">0.6.4</span> Shot Charts<a href="index.html#shot-charts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>BasketballAnalyzeR</code> package includes shot location data for all players for the 2017-18 NBA season and has a function called <code>shotchart</code> that allows for the plotting of shot data.</p>
<p>Let’s plot shot location data for Nikola Jokic. First, the coordinates must be transformed so that the point (0,0) is located at the corner of the court; the original coordinates place the origin at the center of the hoop.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="index.html#cb79-1" aria-hidden="true" tabindex="-1"></a>PbP <span class="ot">&lt;-</span> <span class="fu">PbPmanipulation</span>(PbP.BDB)</span>
<span id="cb79-2"><a href="index.html#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="index.html#cb79-3" aria-hidden="true" tabindex="-1"></a>jokic_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(PbP, player <span class="sc">==</span> <span class="st">&quot;Nikola Jokic&quot;</span>)</span>
<span id="cb79-4"><a href="index.html#cb79-4" aria-hidden="true" tabindex="-1"></a>jokic_data<span class="sc">$</span>xx <span class="ot">&lt;-</span> jokic_data<span class="sc">$</span>original_x<span class="sc">/</span><span class="dv">10</span> <span class="co">#transformation</span></span>
<span id="cb79-5"><a href="index.html#cb79-5" aria-hidden="true" tabindex="-1"></a>jokic_data<span class="sc">$</span>yy <span class="ot">&lt;-</span> jokic_data<span class="sc">$</span>original_y<span class="sc">/</span><span class="dv">10</span> <span class="sc">-</span> <span class="fl">41.75</span> <span class="co">#transformation</span></span></code></pre></div>
<p><code>BasketballAnalyzeR</code> supports three types of density visualizations within <code>shotchart</code>, one being <code>density-polygons</code>. Since <code>shotchart</code> is a <code>ggplot</code> object, a chart title can be added using <code>ggtitle</code>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="index.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shotchart</span>(<span class="at">data =</span> jokic_data, <span class="at">x=</span><span class="st">&quot;xx&quot;</span>, <span class="at">y=</span><span class="st">&quot;yy&quot;</span>, <span class="at">type=</span><span class="st">&quot;density-polygons&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Nikola Jokic Shot Data, 2017-18&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/basketballanalyzer%203-1.png" width="672" /></p>
<p>It seems most shots attempts from Jokic were in the paint; this is hardly surprising, since he plays the center position. Here’s the same chart with <code>density-hexbin</code>:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="index.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shotchart</span>(<span class="at">data =</span> jokic_data, <span class="at">x=</span><span class="st">&quot;xx&quot;</span>, <span class="at">y=</span><span class="st">&quot;yy&quot;</span>, <span class="at">type=</span><span class="st">&quot;density-hexbin&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Nikola Jokic Shot Data, 2017-18&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/basketballanalyzer%204-1.png" width="672" /></p>
<p>The same chart with <code>density-raster</code>:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="index.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shotchart</span>(<span class="at">data =</span> jokic_data, <span class="at">x=</span><span class="st">&quot;xx&quot;</span>, <span class="at">y=</span><span class="st">&quot;yy&quot;</span>, <span class="at">type=</span><span class="st">&quot;density-raster&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Nikola Jokic Shot Data, 2017-18&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/basketballanalyzer%205-1.png" width="672" /></p>
<p>Within the <code>shotchart</code> function, setting <code>scatter=TRUE</code> overlays the shots on the chart. Point size and transparency can also be customized.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="index.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shotchart</span>(<span class="at">data =</span> jokic_data, <span class="at">x=</span><span class="st">&quot;xx&quot;</span>, <span class="at">y=</span><span class="st">&quot;yy&quot;</span>, <span class="at">type=</span><span class="st">&quot;density-raster&quot;</span>, <span class="at">scatter=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Nikola Jokic Shot Data, 2017-18&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/basketballanalyzer%206-1.png" width="672" /></p>
<p>Let’s now compare shot charts of Nikola Jokic, Steph Curry, and Lebron James. This group of players includes one member of each team for which we calculated Four Factors.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="index.html#cb84-1" aria-hidden="true" tabindex="-1"></a>curry_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(PbP, player <span class="sc">==</span> <span class="st">&quot;Stephen Curry&quot;</span>)</span>
<span id="cb84-2"><a href="index.html#cb84-2" aria-hidden="true" tabindex="-1"></a>curry_data<span class="sc">$</span>xx <span class="ot">&lt;-</span> curry_data<span class="sc">$</span>original_x<span class="sc">/</span><span class="dv">10</span> <span class="co">#transformation</span></span>
<span id="cb84-3"><a href="index.html#cb84-3" aria-hidden="true" tabindex="-1"></a>curry_data<span class="sc">$</span>yy <span class="ot">&lt;-</span> curry_data<span class="sc">$</span>original_y<span class="sc">/</span><span class="dv">10</span> <span class="sc">-</span> <span class="fl">41.75</span> <span class="co">#transformation</span></span>
<span id="cb84-4"><a href="index.html#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="index.html#cb84-5" aria-hidden="true" tabindex="-1"></a>james_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(PbP, player <span class="sc">==</span> <span class="st">&quot;LeBron James&quot;</span>)</span>
<span id="cb84-6"><a href="index.html#cb84-6" aria-hidden="true" tabindex="-1"></a>james_data<span class="sc">$</span>xx <span class="ot">&lt;-</span> james_data<span class="sc">$</span>original_x<span class="sc">/</span><span class="dv">10</span> <span class="co">#transformation</span></span>
<span id="cb84-7"><a href="index.html#cb84-7" aria-hidden="true" tabindex="-1"></a>james_data<span class="sc">$</span>yy <span class="ot">&lt;-</span> james_data<span class="sc">$</span>original_y<span class="sc">/</span><span class="dv">10</span> <span class="sc">-</span> <span class="fl">41.75</span> <span class="co">#transformation</span></span>
<span id="cb84-8"><a href="index.html#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="index.html#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="fu">shotchart</span>(<span class="at">data =</span> jokic_data, <span class="at">x=</span><span class="st">&quot;xx&quot;</span>, <span class="at">y=</span><span class="st">&quot;yy&quot;</span>, <span class="at">type=</span><span class="st">&quot;density-raster&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Nikola Jokic Shot Data, 2017-18&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/basketballanalyzer%207-1.png" width="672" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="index.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shotchart</span>(<span class="at">data =</span> curry_data, <span class="at">x=</span><span class="st">&quot;xx&quot;</span>, <span class="at">y=</span><span class="st">&quot;yy&quot;</span>, <span class="at">type=</span><span class="st">&quot;density-raster&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Steph Curry Shot Data, 2017-18&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/basketballanalyzer%207-2.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="index.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shotchart</span>(<span class="at">data =</span> james_data, <span class="at">x=</span><span class="st">&quot;xx&quot;</span>, <span class="at">y=</span><span class="st">&quot;yy&quot;</span>, <span class="at">type=</span><span class="st">&quot;density-raster&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Lebron James Shot Data, 2017-18&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/basketballanalyzer%207-3.png" width="672" /></p>
<p>Q: Of the three players (Jokic, Curry, James), which took the highest percentage of their three-point shots from the right side of the court (when facing the basket)?</p>
<p>A: Nikola Jokic shot almost all of his attempts from the right side. Steph Curry took many shots from beyond the arc and tended toward the left side, while James was split between the right side and the center.</p>
<p>Now, let’s focus on Steph Curry’s shooting. The following chart splits the court into zones based on angle and distance from the basket. The color in each zone represents the average length of the play leading up to that shot among shots taken in that zone.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="index.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shotchart</span>(<span class="at">data =</span> curry_data, <span class="at">x=</span><span class="st">&quot;xx&quot;</span>, <span class="at">y=</span><span class="st">&quot;yy&quot;</span>, <span class="at">z=</span><span class="st">&quot;playlength&quot;</span>, <span class="at">type=</span><span class="st">&quot;sectors&quot;</span>, <span class="at">num.sect =</span> <span class="dv">7</span>, <span class="at">scatter=</span><span class="cn">TRUE</span>, <span class="at">pt.alpha=</span>.<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Steph Curry Shot Data, 2017-18&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/basketballanalyzer%208-1.png" width="672" /></p>
<p>Q: In general, did Steph Curry tend to shoot closer to the basket during plays of a longer duration or a shorter duration?</p>
<p>A: There is not a perfect correlation, but it seems that two-point field goals were attempted more often during longer plays, while shots taken outside the three-point arc were taken during plays of a shorter duration.</p>
<p><em>References:</em>
<a href="https://rdrr.io/cran/BasketballAnalyzeR/" class="uri">https://rdrr.io/cran/BasketballAnalyzeR/</a><br />
Basketball Data Science (Zuccolotto and Manisera, 2020)</p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="hockey" class="section level2 hasAnchor" number="0.7">
<h2><span class="header-section-number">0.7</span> Hockey<a href="index.html#hockey" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://www.youtube.com/watch?v=nv2FUnHceqU">Link to YouTube video describing hockey rules</a></p>
<div id="basic-hockey-statistics" class="section level3 hasAnchor" number="0.7.1">
<h3><span class="header-section-number">0.7.1</span> Basic Hockey Statistics<a href="index.html#basic-hockey-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here are some basic statistics that are used often to describe hockey games.</p>
<ul>
<li><p><strong>Goals (G)</strong>: If a team scores, the skater on the scoring team who last touched the puck is credited with a goal.</p></li>
<li><p><strong>Assists (A)</strong>: The players (up to two) on the scoring team who last touch the puck before the goalscorer are credited with assists, unless the opposing team has possession of the puck in between.</p></li>
<li><p><strong>Points (PTS)</strong>: Goals plus assists. [Not to be confused with team points awarded in the regular season standings by the many hockey leagues, including the NHL (two points for a win, one point for an overtime/shootout loss, zero points for a regulation loss)].</p></li>
<li><p><strong>Shots On Goal (SOG)</strong>: Shot attempts in which the puck has been shot directly on goal. Shot attempts which are blocked or miss the goal are not considered SOGs. A team’s shots on goal should equal the opposing goaltender’s saves plus the team’s goals scored.</p></li>
<li><p><strong>Goals Against Average (GAA)</strong>: Of a goaltender, the number of goals allowed by that goaltender adjusted to a per-60 minute rate.</p></li>
<li><p><strong>Penalty Minutes (PIM)</strong>: The amount of penalty time an individual player is assigned for their infractions. PIM may be different than the amount of time the player actually spends in the penalty box.</p></li>
</ul>
<p><em>Reference:</em><br />
<a href="https://www.milehighhockey.com/pages/stats" class="uri">https://www.milehighhockey.com/pages/stats</a></p>
</div>
<div id="advanced-hockey-statistics" class="section level3 hasAnchor" number="0.7.2">
<h3><span class="header-section-number">0.7.2</span> Advanced Hockey Statistics<a href="index.html#advanced-hockey-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>CORSI</strong>: CORSI only applies to 5 on 5 (“even-strength”) situations. It is calculated as the difference between shot attempts on offense (shots on goal + blocked shots + missed shots) minus shot attempts allowed on defense. CORSI can also be expressed as a percentage, with percentages over 50% indicating that the player is on ice for more offensive shots than defensive shots.</p></li>
<li><p><strong>Expected Goals (xG)</strong>: Expected Goals statistics give each shot an estimated probability of scoring a goal based on factors such as shot location and game situation. xG cannot be less than 0 or greater than 1 for any particular shot, and different platforms may have different methods of calculating expected goals.</p></li>
<li><p><strong>Fenwick/Unblocked Shot Attempts (USAT)</strong>: Similar to CORSI, but omits blocked shots from the calculation. This statistic is used in many Expected Goals calculations.</p></li>
</ul>
<p>Because the flow of a hockey game is usually quite different in situations other than the normal 5 on 5, such as a power play (5 on 4) or concurrent penalties (4 on 4), many hockey databases separate data by the type of game situation. We will see this below with a dataset from <a href="www.moneypuck.com">MoneyPuck</a>, but it is also present on <a href="https://www.naturalstattrick.com/">Natural Stat Trick</a>, <a href="www.quanthockey.com">QuantHockey</a>, and <a href="www.hockey-reference.com">hockey-reference</a>.</p>
<p><em>References:</em><br />
<a href="https://www.nhl.com/lightning/news/hockey-analytics-101-understanding-advanced-stats-and-how-theyre-measured/c-735819" class="uri">https://www.nhl.com/lightning/news/hockey-analytics-101-understanding-advanced-stats-and-how-theyre-measured/c-735819</a><br />
<a href="https://theathletic.com/121980/2017/10/09/an-advanced-stat-primer-understanding-basic-hockey-metrics/" class="uri">https://theathletic.com/121980/2017/10/09/an-advanced-stat-primer-understanding-basic-hockey-metrics/</a></p>
</div>
<div id="actual-vs.-expected-goals" class="section level3 hasAnchor" number="0.7.3">
<h3><span class="header-section-number">0.7.3</span> Actual vs. Expected Goals<a href="index.html#actual-vs.-expected-goals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="example">
<p><span id="exm:unlabeled-div-37" class="example"><strong>Example 0.13  </strong></span>For this example, we’ll use a set of NHL data from moneypuck.com. First, let’s load the data into <code>R</code> and open the data frame.</p>
</div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="index.html#cb88-1" aria-hidden="true" tabindex="-1"></a>nhl_2022_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://moneypuck.com/moneypuck/playerData/seasonSummary/2021/regular/teams.csv&quot;</span>)</span>
<span id="cb88-2"><a href="index.html#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="index.html#cb88-3" aria-hidden="true" tabindex="-1"></a>nhl_2022_data <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:center;">
situation
</th>
<th style="text-align:center;">
xGoalsPercentage
</th>
<th style="text-align:center;">
corsiPercentage
</th>
<th style="text-align:center;">
fenwickPercentage
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
WPG
</td>
<td style="text-align:center;">
other
</td>
<td style="text-align:center;">
0.49
</td>
<td style="text-align:center;">
0.50
</td>
<td style="text-align:center;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
WPG
</td>
<td style="text-align:center;">
all
</td>
<td style="text-align:center;">
0.49
</td>
<td style="text-align:center;">
0.50
</td>
<td style="text-align:center;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
WPG
</td>
<td style="text-align:center;">
5on5
</td>
<td style="text-align:center;">
0.49
</td>
<td style="text-align:center;">
0.49
</td>
<td style="text-align:center;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
WPG
</td>
<td style="text-align:center;">
4on5
</td>
<td style="text-align:center;">
0.16
</td>
<td style="text-align:center;">
0.14
</td>
<td style="text-align:center;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
WPG
</td>
<td style="text-align:center;">
5on4
</td>
<td style="text-align:center;">
0.86
</td>
<td style="text-align:center;">
0.86
</td>
<td style="text-align:center;">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;">
CBJ
</td>
<td style="text-align:center;">
other
</td>
<td style="text-align:center;">
0.52
</td>
<td style="text-align:center;">
0.49
</td>
<td style="text-align:center;">
0.49
</td>
</tr>
<tr>
<td style="text-align:left;">
CBJ
</td>
<td style="text-align:center;">
all
</td>
<td style="text-align:center;">
0.45
</td>
<td style="text-align:center;">
0.48
</td>
<td style="text-align:center;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
CBJ
</td>
<td style="text-align:center;">
5on5
</td>
<td style="text-align:center;">
0.45
</td>
<td style="text-align:center;">
0.48
</td>
<td style="text-align:center;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
CBJ
</td>
<td style="text-align:center;">
4on5
</td>
<td style="text-align:center;">
0.14
</td>
<td style="text-align:center;">
0.18
</td>
<td style="text-align:center;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
CBJ
</td>
<td style="text-align:center;">
5on4
</td>
<td style="text-align:center;">
0.81
</td>
<td style="text-align:center;">
0.84
</td>
<td style="text-align:center;">
0.82
</td>
</tr>
</tbody>
</table>
<p>We can create nice looking tables using the ``kableExtra’’ package. Let’s look at the first eight rows and a small selection of columns of the data frame and format the table output using a kable table.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="index.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>)</span>
<span id="cb89-2"><a href="index.html#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="index.html#cb89-3" aria-hidden="true" tabindex="-1"></a>nhl_2022_data[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">9</span>)] <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:center;">
situation
</th>
<th style="text-align:center;">
games_played
</th>
<th style="text-align:center;">
xGoalsPercentage
</th>
<th style="text-align:center;">
corsiPercentage
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
WPG
</td>
<td style="text-align:center;">
other
</td>
<td style="text-align:center;">
82
</td>
<td style="text-align:center;">
0.49
</td>
<td style="text-align:center;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
WPG
</td>
<td style="text-align:center;">
all
</td>
<td style="text-align:center;">
82
</td>
<td style="text-align:center;">
0.49
</td>
<td style="text-align:center;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
WPG
</td>
<td style="text-align:center;">
5on5
</td>
<td style="text-align:center;">
82
</td>
<td style="text-align:center;">
0.49
</td>
<td style="text-align:center;">
0.49
</td>
</tr>
<tr>
<td style="text-align:left;">
WPG
</td>
<td style="text-align:center;">
4on5
</td>
<td style="text-align:center;">
82
</td>
<td style="text-align:center;">
0.16
</td>
<td style="text-align:center;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
WPG
</td>
<td style="text-align:center;">
5on4
</td>
<td style="text-align:center;">
82
</td>
<td style="text-align:center;">
0.86
</td>
<td style="text-align:center;">
0.86
</td>
</tr>
<tr>
<td style="text-align:left;">
CBJ
</td>
<td style="text-align:center;">
other
</td>
<td style="text-align:center;">
82
</td>
<td style="text-align:center;">
0.52
</td>
<td style="text-align:center;">
0.49
</td>
</tr>
<tr>
<td style="text-align:left;">
CBJ
</td>
<td style="text-align:center;">
all
</td>
<td style="text-align:center;">
82
</td>
<td style="text-align:center;">
0.45
</td>
<td style="text-align:center;">
0.48
</td>
</tr>
<tr>
<td style="text-align:left;">
CBJ
</td>
<td style="text-align:center;">
5on5
</td>
<td style="text-align:center;">
82
</td>
<td style="text-align:center;">
0.45
</td>
<td style="text-align:center;">
0.48
</td>
</tr>
</tbody>
</table>
<p>This dataset includes a <em>lot</em> of covariates. It also splits these data by different game situations: even-strength (5 on 5), power play (5 on 4), etc. Let’s subset the data to include all game situations.</p>
<p>Use the <code>nrow</code> command to check the number of columns in the new data frame. Check: Is it the same as the number of teams in the league for the 2021-2022 season?</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="index.html#cb90-1" aria-hidden="true" tabindex="-1"></a>nhl_data_all <span class="ot">&lt;-</span> <span class="fu">filter</span>(nhl_2022_data, situation <span class="sc">==</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb90-2"><a href="index.html#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="index.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(nhl_data_all)</span></code></pre></div>
<pre><code>## [1] 32</code></pre>
<p>The dataset includes an Expected Goals statistic for each team in the <code>xGoalsFor</code> column. Let’s plot this quantity against the team’s actual number of goals scored; this is given by the <code>goalsFor</code> column.</p>
<p>(Remember to always have a good title and axis labels!)</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="index.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>nhl_data_all, <span class="fu">aes</span>(<span class="at">x=</span>xGoalsFor, <span class="at">y=</span>goalsFor)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Expected Goals Scored&quot;</span>, <span class="at">y=</span><span class="st">&quot;Actual Goals Scored&quot;</span>, <span class="at">title=</span><span class="st">&quot;NHL Teams: Expected vs. Actual Goals, 2021-22&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>As expected, there is a general positive correlation between expected and actual goals (<span class="math inline">\(r \approx 0.8\)</span>). However, there is some variability - for example, the Kings only scored 7 more actual goals than the Ducks, despite having 56.6 more expected goals.</p>
<p>Let’s add a line to the graph using the <code>geom_abline</code> function corresponding to the line <span class="math inline">\(y=x\)</span>, the line on which data points would fall if expected goals were equal to actual goals. We can also customize the line’s color and type.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="index.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>nhl_data_all, <span class="fu">aes</span>(<span class="at">x=</span>xGoalsFor, <span class="at">y=</span>goalsFor)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Expected Goals Scored&quot;</span>, <span class="at">y=</span><span class="st">&quot;Actual Goals Scored&quot;</span>,<span class="at">title=</span><span class="st">&quot;NHL Teams: Expected vs. Actual Goals, 2021-22&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p><em>Note: A slope of 0 and an intercept of 1 are actually the default parameters for the function.</em></p>
<p>Q: What does it mean for a team’s data point to fall below this line? Above it?</p>
<p>A: If the data point is below the line, it means the expected goals were greater than the actual goals; if the data point is above the line, it means the actual goals were greater than the expected goals.</p>
<p>Q: Do you think that a team’s expected goals would be more likely to be closer to its actual goals for a ten-game stretch, an entire season, or five consecutive seasons? Why?</p>
<!-- Question could be reworded/clarified to mean "closer" in a relative (ratio) sense, rather than an absolute sense. -->
<p>A: We would expect that as sample size increases, the result would become closer to expectation. So, actual goals would be most likely closer to expected goals over a span of five seasons.</p>
<!--- This is basically conceptualizing the LLN, but that would rely on this calculation of expected goals being an unbiased estimator of actual goals. -->
</div>
<div id="goalie-statistics" class="section level3 hasAnchor" number="0.7.4">
<h3><span class="header-section-number">0.7.4</span> Goalie Statistics<a href="index.html#goalie-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="example">
<p><span id="exm:unlabeled-div-38" class="example"><strong>Example 0.14  </strong></span>For this next example, let’s use goalie data from the 2021-2022 season from <a href="https://www.naturalstattrick.com/">Natural Stat Trick</a>.</p>
</div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="index.html#cb94-1" aria-hidden="true" tabindex="-1"></a>goalie_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/GoalieTotals_NaturalStatTrick.csv&quot;</span>)</span>
<span id="cb94-2"><a href="index.html#cb94-2" aria-hidden="true" tabindex="-1"></a>goalie_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="sc">-</span>TOI) <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Player
</th>
<th style="text-align:center;">
Team
</th>
<th style="text-align:center;">
GP
</th>
<th style="text-align:center;">
TOI
</th>
<th style="text-align:center;">
Shots.Against
</th>
<th style="text-align:center;">
Saves
</th>
<th style="text-align:center;">
Goals.Against
</th>
<th style="text-align:center;">
xG.Against
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Juuse Saros
</td>
<td style="text-align:center;">
NSH
</td>
<td style="text-align:center;">
67
</td>
<td style="text-align:center;">
3931.383
</td>
<td style="text-align:center;">
2107
</td>
<td style="text-align:center;">
1934
</td>
<td style="text-align:center;">
173
</td>
<td style="text-align:center;">
180.69
</td>
</tr>
<tr>
<td style="text-align:left;">
Connor Hellebuyck
</td>
<td style="text-align:center;">
WPG
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
3903.500
</td>
<td style="text-align:center;">
2155
</td>
<td style="text-align:center;">
1962
</td>
<td style="text-align:center;">
193
</td>
<td style="text-align:center;">
199.26
</td>
</tr>
<tr>
<td style="text-align:left;">
Andrei Vasilevskiy
</td>
<td style="text-align:center;">
T.B
</td>
<td style="text-align:center;">
63
</td>
<td style="text-align:center;">
3760.750
</td>
<td style="text-align:center;">
1869
</td>
<td style="text-align:center;">
1713
</td>
<td style="text-align:center;">
156
</td>
<td style="text-align:center;">
165.89
</td>
</tr>
<tr>
<td style="text-align:left;">
Thatcher Demko
</td>
<td style="text-align:center;">
VAN
</td>
<td style="text-align:center;">
64
</td>
<td style="text-align:center;">
3699.550
</td>
<td style="text-align:center;">
1967
</td>
<td style="text-align:center;">
1799
</td>
<td style="text-align:center;">
168
</td>
<td style="text-align:center;">
173.26
</td>
</tr>
<tr>
<td style="text-align:left;">
Jacob Markstrom
</td>
<td style="text-align:center;">
CGY
</td>
<td style="text-align:center;">
63
</td>
<td style="text-align:center;">
3695.833
</td>
<td style="text-align:center;">
1754
</td>
<td style="text-align:center;">
1617
</td>
<td style="text-align:center;">
137
</td>
<td style="text-align:center;">
152.26
</td>
</tr>
<tr>
<td style="text-align:left;">
Tristan Jarry
</td>
<td style="text-align:center;">
PIT
</td>
<td style="text-align:center;">
58
</td>
<td style="text-align:center;">
3414.717
</td>
<td style="text-align:center;">
1711
</td>
<td style="text-align:center;">
1573
</td>
<td style="text-align:center;">
138
</td>
<td style="text-align:center;">
143.92
</td>
</tr>
<tr>
<td style="text-align:left;">
Elvis Merzlikins
</td>
<td style="text-align:center;">
CBJ
</td>
<td style="text-align:center;">
59
</td>
<td style="text-align:center;">
3320.400
</td>
<td style="text-align:center;">
1922
</td>
<td style="text-align:center;">
1744
</td>
<td style="text-align:center;">
178
</td>
<td style="text-align:center;">
164.94
</td>
</tr>
<tr>
<td style="text-align:left;">
Marc-Andre Fleury
</td>
<td style="text-align:center;">
CHI, MIN
</td>
<td style="text-align:center;">
56
</td>
<td style="text-align:center;">
3284.867
</td>
<td style="text-align:center;">
1732
</td>
<td style="text-align:center;">
1573
</td>
<td style="text-align:center;">
159
</td>
<td style="text-align:center;">
148.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Darcy Kuemper
</td>
<td style="text-align:center;">
COL
</td>
<td style="text-align:center;">
57
</td>
<td style="text-align:center;">
3258.117
</td>
<td style="text-align:center;">
1755
</td>
<td style="text-align:center;">
1617
</td>
<td style="text-align:center;">
138
</td>
<td style="text-align:center;">
154.23
</td>
</tr>
<tr>
<td style="text-align:left;">
John Gibson
</td>
<td style="text-align:center;">
ANA
</td>
<td style="text-align:center;">
56
</td>
<td style="text-align:center;">
3235.583
</td>
<td style="text-align:center;">
1789
</td>
<td style="text-align:center;">
1617
</td>
<td style="text-align:center;">
172
</td>
<td style="text-align:center;">
163.53
</td>
</tr>
</tbody>
</table>
<p>The dataset includes 119 goalies, but many of them didn’t play very much. We can subset the data to include only goaltenders that faced at least 500 shots.</p>
<p>Which player among qualified goalies had the best goals against average? On which team did he play, and what was his GAA?</p>
<p>Which goalie had the most playing time? What was his team, and how much time did he spend on the ice?</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="index.html#cb95-1" aria-hidden="true" tabindex="-1"></a>filtered_goalie_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(goalie_data, Shots.Against <span class="sc">&gt;=</span> <span class="dv">500</span>)</span>
<span id="cb95-2"><a href="index.html#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="index.html#cb95-3" aria-hidden="true" tabindex="-1"></a>filtered_goalie_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(GAA <span class="sc">==</span> <span class="fu">min</span>(GAA)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Player, Team, GAA) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Player
</th>
<th style="text-align:center;">
Team
</th>
<th style="text-align:center;">
GAA
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Igor Shesterkin
</td>
<td style="text-align:center;">
NYR
</td>
<td style="text-align:center;">
2.07
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="index.html#cb96-1" aria-hidden="true" tabindex="-1"></a>filtered_goalie_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TOI <span class="sc">==</span> <span class="fu">max</span>(TOI)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Player, Team, TOI) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Player
</th>
<th style="text-align:center;">
Team
</th>
<th style="text-align:center;">
TOI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Juuse Saros
</td>
<td style="text-align:center;">
NSH
</td>
<td style="text-align:center;">
3931.383
</td>
</tr>
</tbody>
</table>
<p>The following plot compares save percentage to the number of shots on goal faced for the qualified goalies. The dashed horizontal line is placed at the average shots on goal faced among qualified players, and the dashed vertical line is placed at the average save percentage among qualified players.</p>
<p><img src="textbook_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>Q: Which quadrant of the graph represents goalies that faced a higher than average number of shots, but had a below-average save percentage?</p>
<p>A: The second (upper left) quadrant.</p>
<p>Q: Which quadrant represents goalies that had a high save percentage and faced a high volume of shots?</p>
<p>A: The first (upper right) quadrant.</p>
</div>
<div id="correlation-plots" class="section level3 hasAnchor" number="0.7.5">
<h3><span class="header-section-number">0.7.5</span> Correlation Plots<a href="index.html#correlation-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When analyzing sports data, there may be many circumstances where statisticians consider which of several variables are most highly correlated to an outcome variable of interest. In this case, it can be useful to use a correlation plot (also known as a correlation matrix or correlogram). Tidyverse and related packages provide many options for creating correlation plots.</p>
<p>Suppose a statistician has recently learned about some advanced hockey statistics and is interested in researching which stat has the highest correlation with goals scored. The statistician wants to compare team shots on goal, CORSI, and Fenwick to observe the association with goals scored for NHL teams.</p>
<div class="example">
<p><span id="exm:unlabeled-div-39" class="example"><strong>Example 0.15  </strong></span>The following plot uses the same 2021-2022 data from Moneypuck.com; it gives the pairwise scatterplots and correlation values for each of the variables, as well as smoothed plots of each individual variable along the diagonals.</p>
</div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="index.html#cb97-1" aria-hidden="true" tabindex="-1"></a>goal_stats <span class="ot">&lt;-</span> nhl_data_all <span class="sc">%&gt;%</span> <span class="fu">select</span>(shotsOnGoalFor, corsiPercentage, fenwickPercentage, goalsFor)</span>
<span id="cb97-2"><a href="index.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(goal_stats, <span class="at">title=</span><span class="st">&quot;Correlation plot of goals and relevant predictors, NHL 2021-22&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Q: Which of the variables has the strongest correlation with goals scored?</p>
<p>A: CORSI percentage, r = .702.</p>
<p>In the article <a href="https://theathletic.com/121980/2017/10/09/an-advanced-stat-primer-understanding-basic-hockey-metrics/">“An advanced stat primer: Understanding basic hockey metrics”</a>, Charlie O’Connor states, “Generally speaking, Corsi is more predictive of future goal differential than Fenwick… however, Fenwick forms the basis for the most widely-used Expected Goals models.” Let’s use the same predictors in a correlation plot with Expected Goals percentage. Does Fenwick have the strongest correlation with xGoal percentage?</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="index.html#cb98-1" aria-hidden="true" tabindex="-1"></a>xGoal_stats <span class="ot">&lt;-</span> nhl_data_all <span class="sc">%&gt;%</span> <span class="fu">select</span>(shotsOnGoalFor, corsiPercentage, fenwickPercentage, xGoalsPercentage)</span>
<span id="cb98-2"><a href="index.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(xGoal_stats, <span class="at">title=</span><span class="st">&quot;Correlation plot of expected goals and relevant predictors, NHL 2021-22&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/hockey%20ggplot%206-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="volleyball" class="section level2 hasAnchor" number="0.8">
<h2><span class="header-section-number">0.8</span> Volleyball<a href="index.html#volleyball" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Volleyball rules Youtube video: <a href="https://www.youtube.com/watch?v=9g7nYQv-kPM" class="uri">https://www.youtube.com/watch?v=9g7nYQv-kPM</a></p>
<div id="basic-volleyball-statistics" class="section level3 hasAnchor" number="0.8.1">
<h3><span class="header-section-number">0.8.1</span> Basic Volleyball Statistics<a href="index.html#basic-volleyball-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>A <strong>Service Ace (SA)</strong> occurs when a player’s serve touches the ground on the other team’s side without being touched by a player on that side.</li>
<li>A <strong>Kill (K)</strong> occurs when a player gets the ball over the net without it being returned by the opponent.</li>
<li>An <strong>Assist (AST)</strong> is a pass made directly before a player makes a kill.</li>
<li><strong>Hitting Percentage (PCT)</strong> is the number of attempted kills (minus errors) divided by the total number of kill attempts. This helps determine how well a player or team is succeeding at their kill attempts.</li>
</ul>
<p><em>Reference:</em><br />
www.rookieroad.com</p>
<p>For Volleyball EDA, we will be using CSU Women’s Volleyball data from the last five seasons.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="index.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load CSU Women&#39;s Volleyball Data</span></span>
<span id="cb99-2"><a href="index.html#cb99-2" aria-hidden="true" tabindex="-1"></a>csu_vb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/csu_volleyball.csv&quot;</span>)</span>
<span id="cb99-3"><a href="index.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(csu_vb)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;W_L&quot;</span></span>
<span id="cb99-4"><a href="index.html#cb99-4" aria-hidden="true" tabindex="-1"></a>csu_vb <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Date
</th>
<th style="text-align:center;">
Opponent
</th>
<th style="text-align:center;">
W_L
</th>
<th style="text-align:center;">
SP
</th>
<th style="text-align:center;">
K
</th>
<th style="text-align:center;">
E
</th>
<th style="text-align:center;">
TA
</th>
<th style="text-align:center;">
PCT
</th>
<th style="text-align:center;">
AST
</th>
<th style="text-align:left;">
SA
</th>
<th style="text-align:center;">
SE
</th>
<th style="text-align:center;">
RE
</th>
<th style="text-align:center;">
DIG
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
8/25/17
</td>
<td style="text-align:center;">
Duke
</td>
<td style="text-align:center;">
L
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
28
</td>
<td style="text-align:center;">
179
</td>
<td style="text-align:center;">
0.212
</td>
<td style="text-align:center;">
64
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
84
</td>
</tr>
<tr>
<td style="text-align:left;">
8/26/17
</td>
<td style="text-align:center;">
Central Florida
</td>
<td style="text-align:center;">
W
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
56
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
126
</td>
<td style="text-align:center;">
0.302
</td>
<td style="text-align:center;">
52
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
49
</td>
</tr>
<tr>
<td style="text-align:left;">
8/29/17
</td>
<td style="text-align:center;">
Northern Colorado
</td>
<td style="text-align:center;">
W
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
39
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
77
</td>
<td style="text-align:center;">
0.403
</td>
<td style="text-align:center;">
38
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
9/1/17
</td>
<td style="text-align:center;">
vs TCU
</td>
<td style="text-align:center;">
W
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
62
</td>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
149
</td>
<td style="text-align:center;">
0.282
</td>
<td style="text-align:center;">
59
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
65
</td>
</tr>
<tr>
<td style="text-align:left;">
9/1/17
</td>
<td style="text-align:center;">
vs UNC Asheville
</td>
<td style="text-align:center;">
W
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
41
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
80
</td>
<td style="text-align:center;">
0.425
</td>
<td style="text-align:center;">
39
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
28
</td>
</tr>
<tr>
<td style="text-align:left;">
9/2/17
</td>
<td style="text-align:center;">
at Florida State
</td>
<td style="text-align:center;">
W
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
48
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
95
</td>
<td style="text-align:center;">
0.379
</td>
<td style="text-align:center;">
45
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
42
</td>
</tr>
<tr>
<td style="text-align:left;">
9/8/17
</td>
<td style="text-align:center;">
Ball State
</td>
<td style="text-align:center;">
W
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
59
</td>
<td style="text-align:center;">
24
</td>
<td style="text-align:center;">
145
</td>
<td style="text-align:center;">
0.241
</td>
<td style="text-align:center;">
56
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
44
</td>
</tr>
<tr>
<td style="text-align:left;">
9/8/17
</td>
<td style="text-align:center;">
Michigan
</td>
<td style="text-align:center;">
W
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
48
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
101
</td>
<td style="text-align:center;">
0.396
</td>
<td style="text-align:center;">
46
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
37
</td>
</tr>
<tr>
<td style="text-align:left;">
9/10/17
</td>
<td style="text-align:center;">
Idaho State
</td>
<td style="text-align:center;">
W
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
46
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
92
</td>
<td style="text-align:center;">
0.380
</td>
<td style="text-align:center;">
46
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
48
</td>
</tr>
<tr>
<td style="text-align:left;">
9/15/17
</td>
<td style="text-align:center;">
UAlbany
</td>
<td style="text-align:center;">
W
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
41
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
73
</td>
<td style="text-align:center;">
0.466
</td>
<td style="text-align:center;">
36
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
30
</td>
</tr>
</tbody>
</table>
<p>Let’s look at a scatter plot of hitting percentage and the number of digs. While no conclusions can be drawn from such a plot, it can give us some insight into relationships worthy of further analysis. Before creating the plot using the code below, think about what you might expect the outcome to be.</p>
</div>
<div id="scatter-plot" class="section level3 hasAnchor" number="0.8.2">
<h3><span class="header-section-number">0.8.2</span> Scatter Plot<a href="index.html#scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="index.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Digs, Hitting Percentage, Win/Lose</span></span>
<span id="cb100-2"><a href="index.html#cb100-2" aria-hidden="true" tabindex="-1"></a>dig_pct_viz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> csu_vb, <span class="fu">aes</span>(<span class="at">x =</span> DIG, <span class="at">y =</span> PCT, <span class="at">color =</span> W_L)) <span class="sc">+</span></span>
<span id="cb100-3"><a href="index.html#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb100-4"><a href="index.html#cb100-4" aria-hidden="true" tabindex="-1"></a>dig_pct_viz</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>Let’s change the axis titles, legend title, and add a main title.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="index.html#cb101-1" aria-hidden="true" tabindex="-1"></a>dig_pct_viz <span class="sc">+</span></span>
<span id="cb101-2"><a href="index.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Wins and Losses by Number of Digs and Hitting Percentage&quot;</span>,</span>
<span id="cb101-3"><a href="index.html#cb101-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Number of Digs (DIG)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Hitting Percentage (PCT)&quot;</span>,</span>
<span id="cb101-4"><a href="index.html#cb101-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Win or Loss&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>What can we learn from this visual? Well, we can see that there is a weak linear relationship between the number of digs and hitting percentage. To an extent, hitting percentage decreases as the number of digs increases. Why is this the case? Maybe if a team has a really high hitting percentage, this means that the opposing team does not have as many opportunities to attack the other team offensively, reducing the number of opportunities for digs. It also seems that while wins and losses are somewhat evenly spread across the number of digs, there is a more clear cutoff for hitting percentage. It seems that the majority of wins are associated with a hitting percentage of at least 0.2, while the majority of losses are associated with a hitting percentage of less than 0.3.</p>
</div>
<div id="box-plot" class="section level3 hasAnchor" number="0.8.3">
<h3><span class="header-section-number">0.8.3</span> Box Plot<a href="index.html#box-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s take a closer look at the distribution of hitting percentage and digs for wins and losses. To do this, we will create box plots for each statistic.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="index.html#cb102-1" aria-hidden="true" tabindex="-1"></a>pct_viz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> csu_vb, <span class="fu">aes</span>(<span class="at">x =</span> PCT, <span class="at">y =</span> W_L)) <span class="sc">+</span></span>
<span id="cb102-2"><a href="index.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb102-3"><a href="index.html#cb102-3" aria-hidden="true" tabindex="-1"></a>pct_viz</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="index.html#cb103-1" aria-hidden="true" tabindex="-1"></a>dig_viz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> csu_vb, <span class="fu">aes</span>(<span class="at">x =</span> DIG, <span class="at">y =</span> W_L)) <span class="sc">+</span></span>
<span id="cb103-2"><a href="index.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb103-3"><a href="index.html#cb103-3" aria-hidden="true" tabindex="-1"></a>dig_viz</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-33-2.png" width="672" /></p>
<p>Let’s modify these plots to make them more complete and visually appealing.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="index.html#cb104-1" aria-hidden="true" tabindex="-1"></a>pct_viz <span class="sc">+</span></span>
<span id="cb104-2"><a href="index.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Hitting Percentage for Wins and Losses&quot;</span>,</span>
<span id="cb104-3"><a href="index.html#cb104-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Hitting Percentage (PCT)&quot;</span>,</span>
<span id="cb104-4"><a href="index.html#cb104-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Win or Loss&quot;</span>) <span class="sc">+</span></span>
<span id="cb104-5"><a href="index.html#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;slateblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="index.html#cb105-1" aria-hidden="true" tabindex="-1"></a>dig_viz <span class="sc">+</span></span>
<span id="cb105-2"><a href="index.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of Digs for Wins and Losses&quot;</span>,</span>
<span id="cb105-3"><a href="index.html#cb105-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Number of Digs (DIG)&quot;</span>,</span>
<span id="cb105-4"><a href="index.html#cb105-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Win or Loss&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-5"><a href="index.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;slateblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-34-2.png" width="672" /></p>
<p>Box plots allow us to isolate each statistic (number of kills and hitting percentage) so we can more clearly determine the center and spread of each between wins and losses.</p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="soccer" class="section level2 hasAnchor" number="0.9">
<h2><span class="header-section-number">0.9</span> Soccer<a href="index.html#soccer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Rules of Soccer YouTube video: <a href="https://www.youtube.com/watch?v=dFLaabgXhpc" class="uri">https://www.youtube.com/watch?v=dFLaabgXhpc</a></p>
<div id="basic-soccer-statistics" class="section level3 hasAnchor" number="0.9.1">
<h3><span class="header-section-number">0.9.1</span> Basic Soccer Statistics<a href="index.html#basic-soccer-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Shots (SH)</strong> represent all shots taken by a team throughout the game. This is simply an attempt by a player to shoot the ball toward the net, even if they miss or the shot is saved (Rookie Road).</p></li>
<li><p><strong>Shots on Goal (SOG)</strong> represent all shots that would have gone into the goal if not saved by a defender or goalkeeper (Rookie Road).</p></li>
<li><p><strong>Assist (A)</strong> occur when a player passes the ball to someone, and the next shot results in a goal.</p></li>
<li><p><strong>Possession</strong> refers to the percentage of time a team had control of the ball during a game.</p></li>
</ul>
</div>
<div id="advanced-soccer-statistics" class="section level3 hasAnchor" number="0.9.2">
<h3><span class="header-section-number">0.9.2</span> Advanced Soccer Statistics<a href="index.html#advanced-soccer-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Expected Goals (xG)</strong> “indicates how many goals a team could have expected to score based on the quantity and quality of chances that they created in a match” (Tippett 2019, 4).</li>
</ul>
<p>These definitions come from www.rookieroad.com and “The Expected Goals Philosophy” by James Tippett.</p>
<p>To learn more about expected goals, check out <a href="https://www.youtube.com/watch?v=w7zPZsLGK18&amp;list=PL9Az6mi38hv__afKnHR1AKjpcDIw_0qqT" class="uri">this YouTube video</a>.</p>
</div>
<div id="bar-plot" class="section level3 hasAnchor" number="0.9.3">
<h3><span class="header-section-number">0.9.3</span> Bar Plot<a href="index.html#bar-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have an understanding of some basic shooting statistics, let us go through some EDA examples. For this first example, we will need to install the “worldfootballR” package.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="index.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(worldfootballR)</span></code></pre></div>
<p>Next we will look at some data specific to LaLiga, which is a soccer league in the men’s top professional soccer division.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="index.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get &quot;Squad Standard Stats&quot; Data</span></span>
<span id="cb107-2"><a href="index.html#cb107-2" aria-hidden="true" tabindex="-1"></a>big5_2021_stats <span class="ot">&lt;-</span> <span class="fu">fb_big5_advanced_season_stats</span>(<span class="at">season_end_year =</span> <span class="dv">2021</span>, <span class="at">stat_type =</span> <span class="st">&quot;standard&quot;</span>, <span class="at">team_or_player =</span> <span class="st">&quot;team&quot;</span>)</span>
<span id="cb107-3"><a href="index.html#cb107-3" aria-hidden="true" tabindex="-1"></a>liga_2021_stats <span class="ot">&lt;-</span> big5_2021_stats[<span class="fu">which</span>((big5_2021_stats<span class="sc">$</span>Comp <span class="sc">==</span> <span class="st">&quot;La Liga&quot;</span>)),]</span>
<span id="cb107-4"><a href="index.html#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="index.html#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the first ten entries and a selection of columns</span></span>
<span id="cb107-6"><a href="index.html#cb107-6" aria-hidden="true" tabindex="-1"></a>liga_2021_stats <span class="sc">%&gt;%</span> <span class="fu">select</span>(Squad,Team_or_Opponent,Poss,Gls,Ast,xG_Expected,xA_Expected) <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">kt</span>()</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="index.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visual for each team&#39;s goals per game</span></span>
<span id="cb108-2"><a href="index.html#cb108-2" aria-hidden="true" tabindex="-1"></a>team_goals_viz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> liga_2021_stats[<span class="fu">which</span>(liga_2021_stats<span class="sc">$</span>Team_or_Opponent <span class="sc">==</span> <span class="st">&quot;team&quot;</span>),], </span>
<span id="cb108-3"><a href="index.html#cb108-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">x =</span> Squad, <span class="at">y =</span> Gls_Per)) <span class="sc">+</span></span>
<span id="cb108-4"><a href="index.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)</span>
<span id="cb108-5"><a href="index.html#cb108-5" aria-hidden="true" tabindex="-1"></a>team_goals_viz</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>This plot is a good starting point, but still looks pretty messy. Let’s add a title, change the axis titles, and rotate the axis labels so they are not overlapping over one another.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="index.html#cb109-1" aria-hidden="true" tabindex="-1"></a>team_goals_viz <span class="ot">&lt;-</span> team_goals_viz <span class="sc">+</span></span>
<span id="cb109-2"><a href="index.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Team&quot;</span>) <span class="sc">+</span></span>
<span id="cb109-3"><a href="index.html#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Goals Per Game&quot;</span>) <span class="sc">+</span></span>
<span id="cb109-4"><a href="index.html#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb109-5"><a href="index.html#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Goals Per Game by Team&quot;</span>)</span>
<span id="cb109-6"><a href="index.html#cb109-6" aria-hidden="true" tabindex="-1"></a>team_goals_viz</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>This is already looking a lot better. Now, we will add the goals scored per game <em>against</em> each team. Why is this of interest? Well, at first glance, Barcelona seems like a pretty impressive team, as they score more goals per game than any other team in the league. However, what if they also have more goals scored against them than any other team in the league? This could be important context, so we will include it in the graph below.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="index.html#cb110-1" aria-hidden="true" tabindex="-1"></a>all_goals_viz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> liga_2021_stats, <span class="fu">aes</span>(<span class="at">x =</span> Squad, <span class="at">y =</span> Gls_Per)) <span class="sc">+</span></span>
<span id="cb110-2"><a href="index.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Team_or_Opponent), <span class="at">position =</span> <span class="st">&quot;stack&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-3"><a href="index.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Team&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-4"><a href="index.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Goals Per 90 Minutes&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-5"><a href="index.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb110-6"><a href="index.html#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Goals Per Game by Team&quot;</span>)</span>
<span id="cb110-7"><a href="index.html#cb110-7" aria-hidden="true" tabindex="-1"></a>all_goals_viz</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>This is looking pretty good, but let’s clean it up just a bit by changing the legend title and labels.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="index.html#cb111-1" aria-hidden="true" tabindex="-1"></a>all_goals_viz <span class="sc">+</span></span>
<span id="cb111-2"><a href="index.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Team or Opponent&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Opponent&quot;</span>,<span class="st">&quot;Team&quot;</span>))</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>What does this graph show us? Well, we are able to see the average number of goals scored for and against each team per game. It looks like Barcelona is scoring a lot more goals than they are letting be scored against them, while other teams like Valladolid tend to have a higher proportion of goals scored for the opposing team.</p>
</div>
<div id="scatter-plot-1" class="section level3 hasAnchor" number="0.9.4">
<h3><span class="header-section-number">0.9.4</span> Scatter Plot<a href="index.html#scatter-plot-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to simply knowing the average actual number of goals scored for and against each team per game, we may be interested in how this compares to the expected number of goals scored per game, as well.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="index.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb112-2"><a href="index.html#cb112-2" aria-hidden="true" tabindex="-1"></a>act_exp_viz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> liga_2021_stats, <span class="fu">aes</span>(<span class="at">x =</span> xG_Per, <span class="at">y =</span> Gls_Per, <span class="at">label =</span> Squad)) <span class="sc">+</span></span>
<span id="cb112-3"><a href="index.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-4"><a href="index.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">2.25</span>)) <span class="sc">+</span></span>
<span id="cb112-5"><a href="index.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">2.25</span>)) <span class="sc">+</span></span>
<span id="cb112-6"><a href="index.html#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Expected vs. Actual Goals Per Game&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-7"><a href="index.html#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Expected Goals Per Game&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-8"><a href="index.html#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Actual Goals Per Game&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-9"><a href="index.html#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb112-10"><a href="index.html#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb112-11"><a href="index.html#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(act_exp_viz, <span class="at">type =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>As you can see, we fit a line to the data. At first glance, it seems to have a positive slope slightly greater than 1. What does this mean in the scenario of actual and expected goals per game?</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="probability.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aaron-nielsen/SportsAnalyticsBook/edit/master/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["textbook.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
