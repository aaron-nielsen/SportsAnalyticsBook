% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  11pt,
]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Sports Analytics},
  pdfauthor={Aaron Nielsen, Department of Statistics, Colorado State University},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{amsthm}
\usepackage{fvextra} \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,breaksymbol=,commandchars=\\\{\}}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}

\title{Sports Analytics}
\author{Aaron Nielsen, Department of Statistics, Colorado State University}
\date{2022-06-22}

\usepackage{amsthm}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\newtheorem{conjecture}{Conjecture}[chapter]
\theoremstyle{definition}
\newtheorem{definition}{Definition}[chapter]
\theoremstyle{definition}
\newtheorem{example}{Example}[chapter]
\theoremstyle{definition}
\newtheorem{exercise}{Exercise}[chapter]
\theoremstyle{definition}
\newtheorem{hypothesis}{Hypothesis}[chapter]
\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\newtheorem*{solution}{Solution}
\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{about}{%
\chapter*{About}\label{about}}
\addcontentsline{toc}{chapter}{About}

This book serves as the course textbook for the following courses at Colorado State University:

\begin{itemize}
\item
  STAT 351 (Sports Statistics and Analytics 1)
\item
  STAT 451 (Sports Statistics and Analytics 2
\end{itemize}

\hfill\break

CSU students contributed to the creation of this book. Many thanks to the following student collaborators:

\begin{itemize}
\item
  Levi Kipp
\item
  Ellie Martinez
\item
  Isaac Moorman
\end{itemize}

\hypertarget{current-tasks}{%
\chapter*{Current Tasks}\label{current-tasks}}
\addcontentsline{toc}{chapter}{Current Tasks}

Updated: ``2022-06-22''

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Team Tasks and Tips}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Find datasets from various sports to use as examples for EDA and later chapters
\item
  Show how to get basic sumamry statistics from these datasets using dplyr, tidy
\item
  Describe and calculate useful team and individual (descriptive statistics). Example: Baseball: calculate AVG, OBP, OPS, WOBA
\item
  (High quality) Visualizations using ggplot
\item
  Look for relevant ``sports'' R packages
\item
  Include examples from CSU and Colorado sports teams when possible
\item
  Sports to be included: Baseball/Softball, Football, Basketball, Soccer, Hockey, Volleyball
\item
  Sports to be potentially included: Lacrosse, Cricket, Handball,
\end{enumerate}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Aaron:}

Sports:

Chapters: Currently working to add content to chapters 1-4

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Ellie:}

Sports: Soccer, Volleyball

Chapters: EDA, Probability

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Levi:}

Sports: Basketball, Hockey

Chapters: EDA, Probability

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Isaac:}

Sports: Baseball, Football, Tennis

Chapters: EDA, Scraping

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{exploratory-data-analysis}{%
\chapter{Exploratory Data Analysis}\label{exploratory-data-analysis}}

\hypertarget{getting-started-with-r}{%
\section{Getting Started With R}\label{getting-started-with-r}}

\hypertarget{installing-r}{%
\subsection{Installing R}\label{installing-r}}

For this class, you will be using R Studio to complete statistical analyses on your computer.

To begin using R Studio, you will need to install ``R'' first and then install ``R Studio'' on your computer.

\textbf{\emph{Step 1: Download R}}\\
(a) Visit \url{https://www.r-project.org/}\\
(b) Click \textbf{CRAN} under \textbf{Download}
(c) Select any of the mirrors\\
(d) Click the appropriate link for your type of system (Mac, Windows, Linux)\\
(e) Download R on this next page.\\
(For Windows, this will say \textbf{install R for the first time}. For Mac, this will be under \textbf{Latest release} and will be something like \textbf{R-4.1.0.pkg} -- the numbers may differ depending on the most recent version)\\
(f) Install R on your computer\\

\textbf{\emph{Step 2: Download R Studio}}\\
(a) Visit \url{https://www.rstudio.com/products/rstudio/download/\#download}\\
(b) Click to download\\
(c) Install R Studio on your computer\\

\textbf{\emph{Step 3: Verify R Studio is working}}\\
(a) Open R Studio\\
(b) Let's enter a small dataset and calculate the average to make sure everything is working correctly.\\
(c) In the console, type in the following dataset of Sammy Sosa's season home run totals from 1998--2002:\\

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sosa.HR }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{66}\NormalTok{, }\DecValTok{63}\NormalTok{, }\DecValTok{50}\NormalTok{, }\DecValTok{64}\NormalTok{, }\DecValTok{49}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\setcounter{enumi}{3}
\tightlist
\item
  In the console, calculate the average season home run total for Sammy Sosa between 1998--2002:\\
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(sosa.HR)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 58.4
\end{verbatim}

\noindent (e) Did you find Slammin' Sammy's average home run total from 1998--2002 was 58.4? If so, you should be set up correctly!

\hypertarget{some-r-basics}{%
\subsection{Some R Basics}\label{some-r-basics}}

For the following examples, let's consider Peyton Manning's career with the Denver Broncos. In his four seasons with the Broncos, Manning's passing yard totals were: 4659, 5477, 4727, 2249. Let's enter this data into R. To enter a vector of data, use the \textbf{c()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{peyton }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4659}\NormalTok{, }\DecValTok{5477}\NormalTok{, }\DecValTok{4727}\NormalTok{, }\DecValTok{2249}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

To look at the data you just put in the variable \emph{peyton}, type \emph{peyton} into the console and press enter.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{peyton}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4659 5477 4727 2249
\end{verbatim}

Some basic function for calculating summary statistics include \textbf{summary}, \textbf{mean()}, \textbf{median()}, \textbf{var()}, and \textbf{sd()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(peyton)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    2249    4056    4693    4278    4914    5477
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(peyton)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4278
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sd}\NormalTok{(peyton)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1402.522
\end{verbatim}

R allows you to install additional packages (collections of functions) that aren't offered in the base version of R. To install a package, use \textbf{install.packages()} and to load a package, use \textbf{library()}.

One package that we will use frequently is \textbf{tidyverse}. This package includes several other packages and functions such as \textbf{ggplot} (plotting function), \textbf{dplyr} (data manipulation package), and \textbf{stringr} (string manipulation package).

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

You will also need to know how to load datasets from files. For this class, we will typically provide data files is .csv format.

Here is how to load a file:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# load readr package and load example dataset}
\FunctionTok{library}\NormalTok{(readr)}
\NormalTok{NFL\_2021\_Team\_Passing }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data/NFL\_2021\_Team\_Passing.csv"}\NormalTok{)}

\CommentTok{\# we can look at the header (first few entries) using \textquotesingle{}head()\textquotesingle{}}
\FunctionTok{head}\NormalTok{(NFL\_2021\_Team\_Passing)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 25
##      Rk Tm             G   Cmp   Att `Cmp%`   Yds    TD `TD%`   Int `Int%`   Lng
##   <dbl> <chr>      <dbl> <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl> <dbl>  <dbl> <dbl>
## 1     1 Tampa Bay~    17   492   731   67.3  5229    43   5.9    12    1.6    62
## 2     2 Los Angel~    17   443   674   65.7  4800    38   5.6    15    2.2    72
## 3     3 Dallas Co~    17   444   647   68.6  4800    40   6.2    11    1.7    73
## 4     4 Kansas Ci~    17   448   675   66.4  4791    37   5.5    13    1.9    75
## 5     5 Los Angel~    17   406   607   66.9  4642    41   6.8    18    3      79
## 6     6 Las Vegas~    17   429   628   68.3  4567    23   3.7    14    2.2    61
## # ... with 13 more variables: `Y/A` <dbl>, `AY/A` <dbl>, `Y/C` <dbl>,
## #   `Y/G` <dbl>, Rate <dbl>, Sk <dbl>, SKYds <dbl>, `Sk%` <dbl>, `NY/A` <dbl>,
## #   `ANY/A` <dbl>, `4QC` <dbl>, GWD <dbl>, EXP <dbl>
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{descriptive-statistics}{%
\section{Descriptive Statistics}\label{descriptive-statistics}}

\hypertarget{definitions}{%
\subsection{Definitions}\label{definitions}}

\begin{definition}
A \textbf{\emph{population}} is a well-defined complete collection of objects.
\end{definition}

\begin{definition}
A \textbf{\emph{sample}} is a subset of the population.
\end{definition}

\begin{example}
Suppose we are interested in studying Peyton's Manning's season passing yards totals. How could you define the population and what is one possible sample?
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\begin{definition}
\textbf{\emph{Quantitative data}} is numeric data or numbers. It can be broken into two further categories: discrete and continuous data.
\end{definition}

\begin{definition}
\textbf{\emph{Discrete data}} is quantitative data with a finite or countably infinite number of values.
\end{definition}

\begin{definition}
\textbf{\emph{Continuous data}} is quantitative data with an uncountably infinite number of values or data taken from an interval.
\end{definition}

\begin{example}
What are possible discrete and continuous data associated with Peyton Manning?
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\begin{definition}
\textbf{\emph{Qualitative data}} refers to names, categories, or descriptions. It can also be broken down into
two further categories, nominal data and ordinal data.
\end{definition}

\begin{definition}
\textbf{\emph{Nominal data}} is qualitative data with no natural ordering.
\end{definition}

\begin{definition}
\textbf{\emph{Ordinal data}} is qualitative data with a natural ordering.
\end{definition}

\begin{example}
What are possible nominal and ordinal data associated with Peyton Manning?
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{descriptive-statistics-1}{%
\subsection{Descriptive Statistics}\label{descriptive-statistics-1}}

While we will learn about some descriptive statistics that are unique to specific sports, there are some descriptive statistics that are frequently used in many applications.

\hypertarget{descriptive-statistics-for-quantitative-data}{%
\subsubsection{Descriptive Statistics for Quantitative Data}\label{descriptive-statistics-for-quantitative-data}}

There are different descriptive statistics depending on the type of data you are analyzing. We will begin by looking at descriptive statistics for quantitative data.

To begin, let \(x_1, x_2, \ldots, x_n\) represent a numerical dataset with a sample of size \(n\), where \(x_i\) is the \(i^\text{th}\) value in the dataset.

\begin{definition}
The \textbf{\emph{sum}} of the data values is given by: \(\sum_{i=1}^n x_i = x_1 + x_2 + \ldots + x_n\)
\end{definition}

\begin{definition}
The \textbf{\emph{sample mean}} (or sample average), \(\bar{x}\), of the numerical dataset is given by \(\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i\)
\end{definition}

\begin{definition}
The \textbf{\emph{population mean}} (or population average), \(\mu\), is the mean value for the entire population.
\end{definition}

The mean can be thought of as a measure of center or more generally, a measure of location.

\begin{example}
Recall that Peyton Manning's season passing yards total while with the Broncos were: 4659, 5477, 4727, 2249. Calculate the sample mean of these values.
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate the sample of Peyton Manning\textquotesingle{}s passing yards season totals with}
\CommentTok{\# Colts}
\NormalTok{peyton.broncos }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4659}\NormalTok{, }\DecValTok{5477}\NormalTok{, }\DecValTok{4727}\NormalTok{, }\DecValTok{2249}\NormalTok{)}
\FunctionTok{mean}\NormalTok{(peyton.broncos)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4278
\end{verbatim}

In sports statistics, we often have to choose between using a descriptive statistic that summarizes a quantity versus a descriptive statistic that summarizes a rate. For instance, in basketball, we can compare two players based on how many points they score in a game (total quantity) or we can compare two players based on how many points per minute played (rate statistic). Many applications in sports analytics focus more on rate statistics rather than quantity statistics. Why?

We can measure the spread or variability of a dataset using \emph{variance} and \emph{standard devatiation}.

\begin{definition}
The \textbf{\emph{sample variance}}, \(s^2\), of the numerical dataset is a measure of spread and is given by \(s^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2\)
\end{definition}

\begin{definition}
The \textbf{\emph{sample standard deviation}}, \(s\), of the numerical dataset is a measure of spread and is given by \(s = \sqrt{s^2} = \sqrt{\frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2}\)
\end{definition}

\begin{definition}
The \textbf{\emph{population variance}}, \(\sigma^2\), is the variance for an entire population.
\end{definition}

\begin{definition}
The \textbf{\emph{population standard deviation}}, \(\sigma\), is the standard deviation for an entire population.
\end{definition}

We often prefer to work with standard deviations as a measure of spread as opposed to variance because standard deviations are given in our original units.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate the variance and standard deviation of Peyton Manning\textquotesingle{}s passing}
\CommentTok{\# yards season totals with Broncos}
\FunctionTok{var}\NormalTok{(peyton.broncos)  }\CommentTok{\# units: yards\^{}2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1967068
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sd}\NormalTok{(peyton.broncos)  }\CommentTok{\# units: yards}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1402.522
\end{verbatim}

\begin{definition}
The \textbf{sample median}, \(\tilde{x}\), of a numerical dataset is the middle value when the data are ordered from smallest to largest. In other words, let \(x_1, x_2, \ldots, x_n\) be the (unordered) dataset and let \(x_{(1)},x_{(2)}, \ldots, x_{(n)}\) be the same dataset but ordered from smallest to largest. If \(n\) is odd, then \(\tilde{x} = x_{(n+1)/2}\) and if \(n\) is even, then \(\tilde{x} = \frac{1}{2} \cdot \left[x_{\left(\frac{n}{2}\right)} + x_{\left(\frac{n+1}{2}\right)}\right]\).
\end{definition}

\begin{example}
Calculate the sample median of Peyton Manning's season passing yards total while with the Colts (3739, 4135, 4413, 4131, 4200, 4267, 4557, 3747, 4397, 4040, 4002, 4500, 4700).
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

Like sample mean, sample median is a measure of center. It gives you an idea of where the ``middle'' of your dataset is.

We can calculate sample mean and sample median in R as follows:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate the median of Peyton Manning\textquotesingle{}s passing yards season totals with}
\CommentTok{\# Broncos and Colts}
\NormalTok{peyton.colts }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3739}\NormalTok{, }\DecValTok{4135}\NormalTok{, }\DecValTok{4413}\NormalTok{, }\DecValTok{4131}\NormalTok{, }\DecValTok{4200}\NormalTok{, }\DecValTok{4267}\NormalTok{, }\DecValTok{4557}\NormalTok{, }\DecValTok{3747}\NormalTok{, }\DecValTok{4397}\NormalTok{, }\DecValTok{4040}\NormalTok{, }\DecValTok{4002}\NormalTok{,}
    \DecValTok{4500}\NormalTok{, }\DecValTok{4700}\NormalTok{)}
\FunctionTok{median}\NormalTok{(peyton.broncos)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4693
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{(peyton.colts)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4200
\end{verbatim}

\begin{definition}
A \textbf{\emph{percentile}} is a measure of relative standing. The \(p^\text{th}\) percentile is the number where at least
p\% of the data values are less than or equal to this number.
\end{definition}

\begin{definition}
A \textbf{\emph{quantile}} is a measure of relative standing and are the cut points for breaking a distribution of values into equal sized bins.
\end{definition}

\begin{definition}
A \textbf{\emph{quartile}} is a measure of relative standing and are the cut points for breaking a distribution of values into four equal parts.
\end{definition}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate the 10th and 90th percentile of Peyton Manning\textquotesingle{}s passing yards}
\CommentTok{\# season totals with Colts}
\FunctionTok{quantile}\NormalTok{(peyton.colts, }\FloatTok{0.1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  10% 
## 3798
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{quantile}\NormalTok{(peyton.colts, }\FloatTok{0.9}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    90% 
## 4545.6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{quantile}\NormalTok{(peyton.colts, }\FunctionTok{c}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\FloatTok{0.9}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    10%    90% 
## 3798.0 4545.6
\end{verbatim}

\textbf{Special percentiles:}\\
1. 25th percentile = 1st quartile = \(Q_1\)\\
2. 50th percentile = 2nd quartile = \(Q_2\) = \(\tilde{x}\)\\
3. 75th percentile = 3rd quartile = \(Q_3\)\\

\begin{definition}
\textbf{\emph{Range}} is a measure of spread, measures the full width of a dataset, and is given by: \(Range = Max - Min\).
\end{definition}

\begin{definition}
\textbf{\emph{Interquartile range}} is a measure of spread, measures the width of the middle 50\% of a dataset, and is given by: \(IQR = Q_3 - Q_1\).
\end{definition}

\begin{definition}
A \textbf{\emph{five number summary}} describes the center, spread, and edges of a dataset and is given by: \((Min,Q_1,Q_2,Q_3,max)\).
\end{definition}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(peyton.colts)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    3739    4040    4200    4218    4413    4700
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{quantile}\NormalTok{(peyton.colts, }\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.75}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   0%  25%  50%  75% 100% 
## 3739 4040 4200 4413 4700
\end{verbatim}

\hypertarget{descriptive-statistics-for-qualitative-data}{%
\subsubsection{Descriptive Statistics for Qualitative Data}\label{descriptive-statistics-for-qualitative-data}}

In sports statistics, we also encounter qualitative (categorical) data which is names or labels which has its own descriptive statistics.

To begin, let \(x_1, x_2, \ldots, x_n\) represent a categorical dataset with a sample of size \(n\), where \(x_i\) is the \(i^\text{th}\) value in the dataset.

\begin{definition}
The \textbf{\emph{proportion}} of sampled data that fall into a category is given by: \(p = \frac{\#\text{ in category}}{\#\text{ total}}\)
\end{definition}

'\,'Proportion'' and ``Probability'' are often used interchangeably. Both have a minimum value of 0 and a maximum value of 1.

\begin{definition}
The \textbf{\emph{percentage}} of sampled data that fall into a category is given by: \(P\% = 100 \cdot p = 100 \cdot \frac{\#\text{ in category}}{\#\text{ total}}\)
\end{definition}

Percentages in this context can have a minimum value of 0\% and a maximum value of 100\%.

\begin{example}
In 2014, Peyton Manning started as quarterback for the Denver Broncos. The result of the Broncos' 16-game season was:\\
Win, Win, Loss, Win, Win, Win, Win, Loss, Win, Loss, Win, Win, Win, Win, Loss, Win

Calculate the proportion and percentage of Broncos' winning games in 2014.
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{broncos2014 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Win"}\NormalTok{, }\StringTok{"Win"}\NormalTok{, }\StringTok{"Loss"}\NormalTok{, }\StringTok{"Win"}\NormalTok{, }\StringTok{"Win"}\NormalTok{, }\StringTok{"Win"}\NormalTok{, }\StringTok{"Win"}\NormalTok{, }\StringTok{"Loss"}\NormalTok{, }\StringTok{"Win"}\NormalTok{,}
    \StringTok{"Loss"}\NormalTok{, }\StringTok{"Win"}\NormalTok{, }\StringTok{"Win"}\NormalTok{, }\StringTok{"Win"}\NormalTok{, }\StringTok{"Win"}\NormalTok{, }\StringTok{"Loss"}\NormalTok{, }\StringTok{"Win"}\NormalTok{)}
\NormalTok{broncos.prop }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(broncos2014 }\SpecialCharTok{==} \StringTok{"Win"}\NormalTok{)}\SpecialCharTok{/}\FunctionTok{length}\NormalTok{(broncos2014)}
\NormalTok{broncos.prop}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.75
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{broncos.perc }\OtherTok{\textless{}{-}} \DecValTok{100} \SpecialCharTok{*}\NormalTok{ broncos.prop}
\NormalTok{broncos.perc}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 75
\end{verbatim}

We can also build a frequency table that summarizes the categories and their occurrences using \textbf{table()} in R. Note that \textbf{table()} works for quantitative and qualitative data.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(broncos2014)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## broncos2014
## Loss  Win 
##    4   12
\end{verbatim}

\hypertarget{visualizations}{%
\section{Visualizations}\label{visualizations}}

Conveying information visually is also an important part in providing a description of a dataset.

R provides some basic plotting functions such as \textbf{plot}, \textbf{hist}, and \textbf{barplot}. These plotting functions are simple and not always very clean looking.

In this class, we will use analogous plotting functions in \textbf{ggplot2} that are much improved plotting functions.

If you have already installed the \textbf{tidyverse} package, it should have also installed the \textbf{ggplot2} package.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# You have likely already installed the tidyverse package but if not, use the}
\CommentTok{\# following command without the \textquotesingle{}\#\textquotesingle{} install.packages(\textquotesingle{}tidyverse\textquotesingle{})}

\CommentTok{\# Load the tidyverse package (which includes ggplot2)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.6     v dplyr   1.0.9
## v tibble  3.1.7     v stringr 1.4.0
## v tidyr   1.2.0     v forcats 0.5.1
## v purrr   0.3.4
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

Let's load the file ``NFL\_2021\_Team\_Passing.csv'' which contains \href{https://www.pro-football-reference.com/years/2021/index.htm\#passing}{NFL Team Passing Statistics, 2021}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(readr)}
\NormalTok{NFL\_2021\_Team\_Passing }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data/NFL\_2021\_Team\_Passing.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Histograms are one of the most common and basic ways to visualize a dataset's distribution of values. To make a histogram, you will use \textbf{ggplot} and \textbf{geom\_histogram}.

\begin{example}
Create a histogram of the NFL Team Passing Yards in 2021.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NFL\_2021\_Team\_Passing }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Yds)) }\SpecialCharTok{+} \FunctionTok{geom\_histogram}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/hist-1.pdf}

Notice how \textbf{\%\textgreater\%} is used to \textbf{pipe} the dataset into ggplot. This is using the pipe function from the \textbf{dplyr} package.

By default, \textbf{geom\_histogram} uses 30 bins but this is customizable. Let's make the bins have a width of 200.

All good visualizations have good labels. Let's improve the axis labels and give the figure a title.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NFL\_2021\_Team\_Passing }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Yds)) }\SpecialCharTok{+} \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{200}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Team Passing Yards"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Team Passing Touchdowns"}\NormalTok{, }\AttributeTok{title =} \StringTok{"NFL Team Passing Yards, 2021"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/hist2-1.pdf}

We also have numerous options to change the appearance of plots when using \textbf{ggplot}. Let's change the bins color to \emph{blue} and change the bin borders to \emph{white}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NFL\_2021\_Team\_Passing }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Yds)) }\SpecialCharTok{+} \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{binwidth =} \DecValTok{200}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Team Passing Yards"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Team Passing Touchdowns"}\NormalTok{, }\AttributeTok{title =} \StringTok{"NFL Team Passing Yards, 2021"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/hist3-1.pdf}
\end{example}

We can also create bar plots using ggplot using the \textbf{geom\_bar} function.

\begin{example}
Create a bar plot with teams on the horizontal axis and passing touchdowns on the vertical axis.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NFL\_2021\_Team\_Passing }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Tm, }\AttributeTok{y =}\NormalTok{ Yds)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/bar-1.pdf}

The team labels are a complete mess. Let's fix this and make some adjustments to the axis labels and figure title.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NFL\_2021\_Team\_Passing }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Tm, }\AttributeTok{y =}\NormalTok{ Yds)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Team Passing Yards"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Team Passing Touchdowns"}\NormalTok{, }\AttributeTok{title =} \StringTok{"NFL Team Passing Yards, 2021"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{90}\NormalTok{,}
    \AttributeTok{vjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/bar2-1.pdf}

We can flip this graph if we like as well. Note that when we flip the graph, our labels get in reverse ordering, so this can be fixed using \textbf{fct\_rev()} which is part of the \textbf{forcats} package.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NFL\_2021\_Team\_Passing }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_rev}\NormalTok{(Tm), }\AttributeTok{y =}\NormalTok{ Yds)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Team Passing Yards"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Team Passing Touchdowns"}\NormalTok{, }\AttributeTok{title =} \StringTok{"NFL Team Passing Yards, 2021"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{coord\_flip}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/bar3-1.pdf}
\end{example}

Another common and useful visualization is a scatterplot which shows the relationship between two numeric variable. In ggplot, you use \textbf{geom\_point()}.

\begin{example}
Create a scatterplot of Team Passing Yards and Team Passing Touchdowns from the NFL 2021 dataset.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NFL\_2021\_Team\_Passing }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Yds, }\AttributeTok{y =}\NormalTok{ TD, }\AttributeTok{label =}\NormalTok{ Tm)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Team Passing Yards"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Team Passing Touchdowns"}\NormalTok{, }\AttributeTok{title =} \StringTok{"NFL Team Passing Yards, 2021"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/scatter1-1.pdf}

We may want to include team labels on this plot, however, it can get messy very quickly with a lot of points.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NFL\_2021\_Team\_Passing }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Yds, }\AttributeTok{y =}\NormalTok{ TD, }\AttributeTok{label =}\NormalTok{ Tm)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Team Passing Yards"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Team Passing Touchdowns"}\NormalTok{, }\AttributeTok{title =} \StringTok{"NFL Team Passing Yards, 2021"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_text}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/scatter2-1.pdf}

Many sports leagues have around 30 teams, so a clean scatterplot with labels can be tricky to make. Here are some options below.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# install ggrepel package}
\FunctionTok{library}\NormalTok{(ggrepel)}
\NormalTok{NFL\_2021\_Team\_Passing }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Yds, }\AttributeTok{y =}\NormalTok{ TD, }\AttributeTok{label =}\NormalTok{ Tm)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Team Passing Yards"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Team Passing Touchdowns"}\NormalTok{, }\AttributeTok{title =} \StringTok{"NFL Team Passing Yards, 2021"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_text\_repel}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: ggrepel: 9 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps
\end{verbatim}

\includegraphics{series_files/figure-latex/scatter3-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NFL\_2021\_Team\_Passing}\SpecialCharTok{$}\NormalTok{Abbr }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"TB"}\NormalTok{, }\StringTok{"LAC"}\NormalTok{, }\StringTok{"DAL"}\NormalTok{, }\StringTok{"KC"}\NormalTok{, }\StringTok{"LAR"}\NormalTok{, }\StringTok{"LV"}\NormalTok{, }\StringTok{"CIN"}\NormalTok{, }\StringTok{"GB"}\NormalTok{,}
    \StringTok{"BUF"}\NormalTok{, }\StringTok{"AZ"}\NormalTok{, }\StringTok{"MN"}\NormalTok{, }\StringTok{"SF"}\NormalTok{, }\StringTok{"BAL"}\NormalTok{, }\StringTok{"NE"}\NormalTok{, }\StringTok{"PIT"}\NormalTok{, }\StringTok{"ATL"}\NormalTok{, }\StringTok{"MIA"}\NormalTok{, }\StringTok{"DET"}\NormalTok{, }\StringTok{"DEN"}\NormalTok{, }\StringTok{"NYJ"}\NormalTok{,}
    \StringTok{"WAS"}\NormalTok{, }\StringTok{"JAC"}\NormalTok{, }\StringTok{"SEA"}\NormalTok{, }\StringTok{"TEN"}\NormalTok{, }\StringTok{"PHI"}\NormalTok{, }\StringTok{"IND"}\NormalTok{, }\StringTok{"CLE"}\NormalTok{, }\StringTok{"HOU"}\NormalTok{, }\StringTok{"CAR"}\NormalTok{, }\StringTok{"CHI"}\NormalTok{, }\StringTok{"NYG"}\NormalTok{,}
    \StringTok{"NO"}\NormalTok{)}
\NormalTok{NFL\_2021\_Team\_Passing }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Yds, }\AttributeTok{y =}\NormalTok{ TD, }\AttributeTok{label =}\NormalTok{ Abbr)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Team Passing Yards"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Team Passing Touchdowns"}\NormalTok{, }\AttributeTok{title =} \StringTok{"NFL Team Passing Yards, 2021"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_text\_repel}\NormalTok{(}\AttributeTok{box.padding =} \FloatTok{0.3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/scatter4-1.pdf}
\end{example}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{baseball}{%
\section{Baseball}\label{baseball}}

\hypertarget{football}{%
\section{Football}\label{football}}

\hypertarget{basketball}{%
\section{Basketball}\label{basketball}}

\hypertarget{four-factors}{%
\subsection{Four Factors}\label{four-factors}}

Tibbles are a type of data frame supported by the \texttt{tidyverse} package. The following tibble contains data from a Mountain West tournament game played between the CSU and Wyoming women's basketball teams during the 2021-2022 season, which CSU won 51-38. \href{https://csurams.com/sports/womens-basketball/stats/2021-22/wyoming/boxscore/16095}{(Here's the link to the box score on the CSU athletics website.)}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(}\StringTok{"tibble"}\NormalTok{)}

\NormalTok{basketball\_data }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{team =} \FunctionTok{c}\NormalTok{(}\StringTok{"CSU"}\NormalTok{, }\StringTok{"WYO"}\NormalTok{), }\AttributeTok{FG =} \FunctionTok{c}\NormalTok{(}\DecValTok{14}\NormalTok{, }\DecValTok{15}\NormalTok{), }\AttributeTok{FGA =} \FunctionTok{c}\NormalTok{(}\DecValTok{48}\NormalTok{, }\DecValTok{60}\NormalTok{),}
    \AttributeTok{THREEP =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{4}\NormalTok{), }\AttributeTok{FT =} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{4}\NormalTok{), }\AttributeTok{FTA =} \FunctionTok{c}\NormalTok{(}\DecValTok{14}\NormalTok{, }\DecValTok{4}\NormalTok{), }\AttributeTok{ORB =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{14}\NormalTok{), }\AttributeTok{DRB =} \FunctionTok{c}\NormalTok{(}\DecValTok{31}\NormalTok{,}
        \DecValTok{30}\NormalTok{), }\AttributeTok{TOV =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{12}\NormalTok{))}
\NormalTok{basketball\_data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 2 x 9
##   team     FG   FGA THREEP    FT   FTA   ORB   DRB   TOV
##   <chr> <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
## 1 CSU      14    48      5    10    14     2    31     5
## 2 WYO      15    60      4     4     4    14    30    12
\end{verbatim}

This tibble contains all the data needed to calculate the \emph{Four Factors}. The Four Factors of a basketball game are statistics formulated by Dean Oliver, former Director of Quantitative Analysis for the Denver Nuggets (among other roles). These statistics are also promoted by sports data platforms like Hudl.com.

The first is \textbf{Effective Field Goal Percentage}, commonly abbreviated eFG\%. The formula is as follows:

\(eFG\% = \frac{FG\ +\ 0.5(3P)}{FGA}\)

Secondly, \textbf{Turnover Percentage} (TOV\%) is calculated as:

\(TOV\% = \frac{TOV}{FGA\ +\ 0.44(FTA)\ +\ TOV}\)

Next, \textbf{Rebounding Percentage} (ORB\%) is computed as:

\(ORB\% = \frac{ORB}{ORB\ +\ Opponent\ DRB}\)

Finally, the \textbf{Free Throw Factor} is found using:

\(FT\ factor = \frac{FT}{FGA}\)

Note: You do not have to know these formulas for the test. They are just used for this example.

Let's calculate the values of eFG\%, TOV\%, and Free Throw Factor for both CSU and Wyoming and add them as new columns in the tibble using the \texttt{add\_column} function.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{attach}\NormalTok{(basketball\_data)}
\NormalTok{eFG }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{((FG }\SpecialCharTok{+} \FloatTok{0.5} \SpecialCharTok{*}\NormalTok{ THREEP)}\SpecialCharTok{/}\NormalTok{FGA, }\DecValTok{3}\NormalTok{)}
\NormalTok{TOVPCT }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(TOV}\SpecialCharTok{/}\NormalTok{(FGA }\SpecialCharTok{+} \FloatTok{0.44} \SpecialCharTok{*}\NormalTok{ FTA }\SpecialCharTok{+}\NormalTok{ TOV), }\DecValTok{3}\NormalTok{)}
\NormalTok{FTFACTOR }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(FT}\SpecialCharTok{/}\NormalTok{FGA, }\DecValTok{3}\NormalTok{)}

\NormalTok{basketball\_data }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{add\_column}\NormalTok{(eFG, TOVPCT, FTFACTOR)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 2 x 12
##   team     FG   FGA THREEP    FT   FTA   ORB   DRB   TOV   eFG TOVPCT FTFACTOR
##   <chr> <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>  <dbl>    <dbl>
## 1 CSU      14    48      5    10    14     2    31     5 0.344  0.085    0.208
## 2 WYO      15    60      4     4     4    14    30    12 0.283  0.163    0.067
\end{verbatim}

\hypertarget{soccer}{%
\section{Soccer}\label{soccer}}

To begin, let's go over a couple of basic summary statistics specific to soccer that will be necessary to understand for the following examples.

\begin{itemize}
\item
  \textbf{Shots (SH)} represent all shots taken by a team throughout the game. This is simply an attempt by a player to shoot the ball toward the net, even if they miss or the shot is saved (Rookie Road).
\item
  \textbf{Shots on Goal (SOG)} represent all shots that would have gone into the goal if not saved by a defender or goalkeeper (Rookie Road).
\item
  \textbf{Expected Goals (xG)} ``indicates how many goals a team could have expected to score based on the quantity and quality of chances that they created in a match'' (Tippett 2019, 4).
\end{itemize}

These definitions come from www.rookieroad.com and ``The Expected Goals Philosophy'' by James Tippett.

\hypertarget{example-1}{%
\subsection*{Example 1}\label{example-1}}
\addcontentsline{toc}{subsection}{Example 1}

Now that we have an understanding of some basic shooting statistics, let us go through some EDA examples. For this first example, we will need to install the ``worldfootballR'' package.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(worldfootballR)}
\FunctionTok{library}\NormalTok{(ggExtra)}
\FunctionTok{library}\NormalTok{(ggridges)}
\end{Highlighting}
\end{Shaded}

Next we will look at some data specific to LaLiga, which is a soccer league in the men's top professional soccer division.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Get \textquotesingle{}Squad Standard Stats\textquotesingle{} Data}
\NormalTok{big5\_2021\_stats }\OtherTok{\textless{}{-}} \FunctionTok{fb\_big5\_advanced\_season\_stats}\NormalTok{(}\AttributeTok{season\_end\_year =} \DecValTok{2021}\NormalTok{, }\AttributeTok{stat\_type =} \StringTok{"standard"}\NormalTok{,}
    \AttributeTok{team\_or\_player =} \StringTok{"team"}\NormalTok{)}
\NormalTok{liga\_2021\_stats }\OtherTok{\textless{}{-}}\NormalTok{ big5\_2021\_stats[}\FunctionTok{which}\NormalTok{((big5\_2021\_stats}\SpecialCharTok{$}\NormalTok{Comp }\SpecialCharTok{==} \StringTok{"La Liga"}\NormalTok{)), ]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create visual for each team\textquotesingle{}s goals per game}
\NormalTok{team\_goals\_viz }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ liga\_2021\_stats[}\FunctionTok{which}\NormalTok{(liga\_2021\_stats}\SpecialCharTok{$}\NormalTok{Team\_or\_Opponent }\SpecialCharTok{==}
    \StringTok{"team"}\NormalTok{), ], }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Squad, }\AttributeTok{y =}\NormalTok{ Gls\_Per)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{)}
\NormalTok{team\_goals\_viz}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/unnamed-chunk-11-1.pdf}

This plot is a good starting point, but still looks pretty messy. Let's add a title, change the axis titles, and rotate the axis labels so they are not overlapping over one another.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{team\_goals\_viz }\OtherTok{\textless{}{-}}\NormalTok{ team\_goals\_viz }\SpecialCharTok{+} \FunctionTok{xlab}\NormalTok{(}\StringTok{"Team"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{"Goals Per Game"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{,}
    \AttributeTok{hjust =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Goals Per Game by Team"}\NormalTok{)}
\NormalTok{team\_goals\_viz}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/unnamed-chunk-12-1.pdf}

This is already looking a lot better. Now, we will add the goals scored per game \emph{against} each team. Why is this of interest? Well, at first glance, Barcelona seems like a pretty impressive team, as they score more goals per game than any other team in the league. However, what if they also have more goals scored against them than any other team in the league? This could be important context, so we will include it in the graph below.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_goals\_viz }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ liga\_2021\_stats, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Squad, }\AttributeTok{y =}\NormalTok{ Gls\_Per)) }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{,}
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{fill =}\NormalTok{ Team\_or\_Opponent), }\AttributeTok{position =} \StringTok{"stack"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{xlab}\NormalTok{(}\StringTok{"Team"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{"Goals Per 90 Minutes"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Goals Per Game by Team"}\NormalTok{)}
\NormalTok{all\_goals\_viz}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/unnamed-chunk-13-1.pdf}

This is looking pretty good, but let's clean it up just a bit by changing the legend title and labels.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_goals\_viz }\OtherTok{\textless{}{-}}\NormalTok{ all\_goals\_viz }\SpecialCharTok{+} \FunctionTok{scale\_fill\_discrete}\NormalTok{(}\AttributeTok{name =} \StringTok{"Team or Opponent"}\NormalTok{, }\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Opponent"}\NormalTok{,}
    \StringTok{"Team"}\NormalTok{))}
\NormalTok{all\_goals\_viz}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/unnamed-chunk-14-1.pdf}

What does this graph show us? Well, we are able to see the average number of goals scored for and against each team per game. It looks like Barcelona is scoring a lot more goals than they are letting be scored against them, while other teams like Valladolid tend to have a higher proportion of goals scored for the opposing team.

\hypertarget{example-2}{%
\subsection*{Example 2}\label{example-2}}
\addcontentsline{toc}{subsection}{Example 2}

In addition to simply knowing the average actual number of goals scored for and against each team per game, we may be interested in how this compares to the expected number of goals scored per game, as well.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{act\_exp\_viz }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ liga\_2021\_stats, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ xG\_Per, }\AttributeTok{y =}\NormalTok{ Gls\_Per, }\AttributeTok{label =}\NormalTok{ Squad)) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.75}\NormalTok{, }\FloatTok{2.25}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.75}\NormalTok{,}
    \FloatTok{2.25}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Expected vs. Actual Goals Per Game"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{xlab}\NormalTok{(}\StringTok{"Expected Goals Per Game"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{ylab}\NormalTok{(}\StringTok{"Actual Goals Per Game"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{aspect.ratio =} \DecValTok{2}\SpecialCharTok{/}\DecValTok{2}\NormalTok{)}
\FunctionTok{ggMarginal}\NormalTok{(act\_exp\_viz, }\AttributeTok{type =} \StringTok{"density"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 3 rows containing non-finite values (stat_smooth).
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using formula 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 3 rows containing non-finite values (stat_smooth).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 3 rows containing missing values (geom_point).
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using formula 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 3 rows containing non-finite values (stat_smooth).
## Removed 3 rows containing missing values (geom_point).
\end{verbatim}

\includegraphics{series_files/figure-latex/unnamed-chunk-15-1.pdf}

As you can see, we fit a line to the data. At first glance, it seems to have a positive slope slightly greater than 1. What does this mean in the scenario of actual and expected goals per game?

\hypertarget{volleyball}{%
\section{Volleyball}\label{volleyball}}

\hypertarget{hockey}{%
\section{Hockey}\label{hockey}}

For this example, we'll use a set of NHL data from moneypuck.com. First, let's load the data into \texttt{R} and open the data frame.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nhl\_2022\_data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"https://moneypuck.com/moneypuck/playerData/seasonSummary/2021/regular/teams.csv"}\NormalTok{)}

\FunctionTok{head}\NormalTok{(nhl\_2022\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 107
##   team...1 season name  team...4 position   situation games_played
##   <chr>     <dbl> <chr> <chr>    <chr>      <chr>            <dbl>
## 1 WPG        2021 WPG   WPG      Team Level other               82
## 2 WPG        2021 WPG   WPG      Team Level all                 82
## 3 WPG        2021 WPG   WPG      Team Level 5on5                82
## 4 WPG        2021 WPG   WPG      Team Level 4on5                82
## 5 WPG        2021 WPG   WPG      Team Level 5on4                82
## 6 CBJ        2021 CBJ   CBJ      Team Level other               82
## # ... with 100 more variables: xGoalsPercentage <dbl>, corsiPercentage <dbl>,
## #   fenwickPercentage <dbl>, iceTime <dbl>, xOnGoalFor <dbl>, xGoalsFor <dbl>,
## #   xReboundsFor <dbl>, xFreezeFor <dbl>, xPlayStoppedFor <dbl>,
## #   xPlayContinuedInZoneFor <dbl>, xPlayContinuedOutsideZoneFor <dbl>,
## #   flurryAdjustedxGoalsFor <dbl>, scoreVenueAdjustedxGoalsFor <dbl>,
## #   flurryScoreVenueAdjustedxGoalsFor <dbl>, shotsOnGoalFor <dbl>,
## #   missedShotsFor <dbl>, blockedShotAttemptsFor <dbl>, ...
\end{verbatim}

We can create nice looking tables using the ``kableExtra'\,' package. Let's look at the first eight rows and a samll selection of columns of the data frame and format the table output using a kable table.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(}\StringTok{"kableExtra"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'kableExtra'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     group_rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nhl\_2022\_data[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{8}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{6}\SpecialCharTok{:}\DecValTok{9}\NormalTok{)] }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{kbl}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{kable\_styling}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{l|l|r|r|r}
\hline
name & situation & games\_played & xGoalsPercentage & corsiPercentage\\
\hline
WPG & other & 82 & 0.49 & 0.50\\
\hline
WPG & all & 82 & 0.49 & 0.50\\
\hline
WPG & 5on5 & 82 & 0.49 & 0.49\\
\hline
WPG & 4on5 & 82 & 0.16 & 0.14\\
\hline
WPG & 5on4 & 82 & 0.86 & 0.86\\
\hline
CBJ & other & 82 & 0.52 & 0.49\\
\hline
CBJ & all & 82 & 0.45 & 0.48\\
\hline
CBJ & 5on5 & 82 & 0.45 & 0.48\\
\hline
\end{tabular}
\end{table}

This dataset includes a \emph{lot} of covariates. It also splits these data by different game situations: even-strength (5 on 5), power play (5 on 4), etc. Let's subset the data to include all game situations.

Use the \texttt{nrow} command to check the number of columns in the new data frame. Check: Is it the same as the number of teams in the league for the 2021-2022 season?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nhl\_data\_all }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(nhl\_2022\_data, situation }\SpecialCharTok{==} \StringTok{"all"}\NormalTok{)}

\FunctionTok{nrow}\NormalTok{(nhl\_data\_all)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 32
\end{verbatim}

The dataset includes an Expected Goals statistic for each team in the \texttt{xGoalsFor} column. Let's plot this quantity against the team's actual number of goals scored; this is given by the \texttt{goalsFor} column.

(Remember to always have a good title and axis labels!)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ nhl\_data\_all, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ xGoalsFor, }\AttributeTok{y =}\NormalTok{ goalsFor)) }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Expected Goals Scored"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Actual Goals Scored"}\NormalTok{, }\AttributeTok{title =} \StringTok{"NHL Teams: Expected vs. Actual Goals, 2021{-}22"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/hockey_ggplot3-1.pdf}

As expected, there is a general positive correlation between expected and actual goals (\(r \approx 0.8\)). However, there is some variability - for example, the Kings only scored 7 more actual goals than the Ducks, despite having 56.6 more expected goals.

Let's add a line to the graph using the \texttt{geom\_abline} function corresponding to the line \(y=x\), the line on which data points would fall if expected goals were equal to actual goals. We can also customize the line's color and type.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ nhl\_data\_all, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ xGoalsFor, }\AttributeTok{y =}\NormalTok{ goalsFor)) }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Expected Goals Scored"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Actual Goals Scored"}\NormalTok{, }\AttributeTok{title =} \StringTok{"NHL Teams: Expected vs. Actual Goals, 2021{-}22"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{intercept =} \DecValTok{0}\NormalTok{, }\AttributeTok{slope =} \DecValTok{1}\NormalTok{, }\AttributeTok{color =} \StringTok{"red"}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/hockey_ggplot4-1.pdf}

\emph{Note: A slope of 0 and an intercept of 1 are actually the default parameters for the function.}

Q: What does it mean for a team's data point to fall below this line? Above it?

A: If the data point is below the line, it means the expected goals were greater than the actual goals; if the data point is above the line, it means the actual goals were greater than the expected goals.

Q: Do you think that a team's expected goals would be more likely to be closer to its actual goals for a ten-game stretch, an entire season, or five consecutive seasons? Why?

A: We would expect that as sample size increases, the result would become closer to expectation. So, actual goals would be most likely closer to expected goals over a span of five seasons.

\hypertarget{probability}{%
\chapter{Probability}\label{probability}}

\hypertarget{chapter-preview}{%
\section*{Chapter Preview}\label{chapter-preview}}
\addcontentsline{toc}{section}{Chapter Preview}

Simply put, probability is the study of randomness. In this chapter, we will define probability, learn rules of probability, and apply these rules to sports data.

\hypertarget{definitions-1}{%
\section{Definitions}\label{definitions-1}}

\begin{definition}
An \textbf{\emph{experiment}} is any activity or process whose outcome is subject to uncertainty.
\end{definition}

\begin{definition}
The \textbf{\emph{sample space}} of an experiment, denoted by \(\Omega\) or \(\mathcal{S}\), is the set of all possible outcomes of that experiment.
\end{definition}

\begin{definition}
An \textbf{\emph{event}} is any collection (subset) of outcomes contained in the sample space, \(\Omega\).
\end{definition}

\begin{example}
\[ \]
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\begin{example}
\[ \]
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\hypertarget{set-theory}{%
\section{Set Theory}\label{set-theory}}

For the following examples, suppose that we are interested in the batting outcomes of a plate appearance in softball.

Let \(A\) be the event that the batter gets walked, let \(B\) be the event that the batter gets a hit, let \(C\) be the event that the batter strikes out, and let \(D\) be the event that the batter makes it to first base at the end of their at bat.

We will define a handful of set operations to help us when we begin calculating the probability of different events occurring.

\begin{definition}
The \textbf{\emph{compliment}} of an event \(A\), denoted by \(A^c\) or \(A'\), is the set of all outcomes in \(\Omega\) that are not contained in \(A\).
\end{definition}

\begin{example}
Draw a Venn diagram illustrating \(A^c\) and describe the event.
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\begin{definition}
The \textbf{\emph{union}} of two events \(A\) and \(B\), denoted by \(A \cup B\) and read ``\(A\) or \(B\)'', is the event consisting of all outcomes that are either in \(A\) or \(B\) or in both.
\end{definition}

\begin{example}
Draw a Venn diagram illustrating \(A \cup D\) and describe the event.
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\begin{definition}
The \textbf{\emph{intersection}} of two events \(A\) and \(B\), denoted by \(A \cap B\) and read ``\(A\) and \(B\)'', is the event consisting of all outcomes that are in both \(A\) and \(B\).
\end{definition}

\begin{example}
Draw a Venn diagram illustrating \(A \cap D\) and describe the event.
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\begin{definition}
The \textbf{\emph{difference}} of two events \(A\) and \(B\), denoted by \(A \mathbin{/} B\) and read ``difference of \(A\) and \(B\)'', is
the event consisting of all outcomes that are in \(A\) but not in \(B\).
\end{definition}

\begin{example}
Draw a Venn diagram illustrating \(D \mathbin{/} A\) and describe the event.
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\begin{definition}
Two events \(A\) and \(B\) are said to be \textbf{\emph{disjoint}} (or \textbf{\emph{mutually exclusive}}) if \(A \cap B = \emptyset\)
\end{definition}

\begin{example}
Are the events \(A\) and \(B\) disjoint? How about \(A\) and \(D\)?
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

\hypertarget{probability-axioms-and-properties}{%
\section{Probability Axioms and Properties}\label{probability-axioms-and-properties}}

There are some basic assumptions of ``axioms'' which are the foundation of the theory of probability. Andrey Kolmogorov first described these axioms in 1933.

\hypertarget{axioms-of-probability}{%
\subsection{Axioms of Probability}\label{axioms-of-probability}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(P(A) \geq 0\), for any event \(A\)\\
\item
  \(P(\Omega) = 1\)\\
\item
  If \(A_1, A_2, A_3, \ldots\) is a collection of disjoint events, then:\\
  \(P(\cup_{i=1}^{\infty} A_i) = P(A_1 \cup A_2 \cup \ldots ) = \sum_{i=1}^{\infty} P(A_i)\)
\end{enumerate}

Note that all probabilities are between 0 and 1, that is, for any event \(A\), \(0 \leq P(A) \leq 1\).

We can convert to percentages by multiplying probabilities by 100, however, this is a set that is only done after all calculations have been completed.

\hypertarget{properties-of-probability}{%
\subsection{Properties of Probability}\label{properties-of-probability}}

\begin{itemize}
\item
  \(P(\emptyset) = 0\)\\
\item
  \(P(A^c) = 1 - P(A)\)
\item
  \(P(A \cup B) = P(A) + P(B) - P(A \cap B)\)
\item
  \(P(A \cup B \cup C) = \\ P(A) + P(B) + P(C) - P(A \cap B) - P(A \cap C) - P(B \cap C) + P(A \cap B \cap C)\)
\item
  \(P([A \cup B]^c) = P(A^c \cap B^c)\)
\item
  \(P([A \cap B]^c) = P(A^c \cup B^c)\)
\end{itemize}

\hypertarget{laws-of-probability}{%
\section{Laws of Probability}\label{laws-of-probability}}

\begin{definition}
Let \(A\) and \(B\) be two events such that \(P(B)>0\). Then the \textbf{\emph{conditional probability}} of \(A\) given \(B\), written \(P(A|B)\), is given by:
\(P(A|B) = \frac{P(A \cap B)}{P(B)}\)
\end{definition}

\begin{example}
In 2001, Barry Bonds broke the single season home run record with 73 home runs. In this season, he had 664 plate appearances, 156 hits, 177 walks and 9 hit by pitches. Given that Bonds reached base (via hit, walk, or HBP), what was the probability that he got a hit?
\end{example}

\hfill\break
\hfill\break
\hfill\break

\begin{theorem}[Multiplication Rule]
For any two events \(A\) and \(B\), \(P(A \cap B) = P(B|A) \cdot P(A)\).
\end{theorem}

\begin{definition}
Events \(A_1, A_2, \ldots, A_n\) are said to form a \textbf{\emph{partition}} of a sample space \(\Omega\) if both:\\
(i) \(A_i \cap A_j = \emptyset\) (\(i \neq j\))\\
(ii) \(\cup_{i=1}^n A_i = \Omega\)\\
\end{definition}

\begin{theorem}[Law of Total Probability]
Suppose events \(A_1, A_2, \ldots, A_n\) form a partition of \(\Omega\), then:
\(P(B) = P(B|A_1)P(A_1) + P(B|A_2)P(A_2) + \ldots P(B|A_n)P(A_n)\)
\end{theorem}

\begin{theorem}[Bayes Theorem: simple version]
Suppose events \(B\) and \(C\) form a partition of \(\Omega\), then:
\(P(B|A) = \frac{P(B \cap A)}{P(A)} = \frac{P(A|B)P(B)}{P(A|B)P(B)+P(A|C)P(C)}\)
\end{theorem}

\begin{theorem}[Bayes Theorem]
Suppose events \(B_1, B_2, \ldots, B_n\) form a partition of \(\Omega\), then:
\(P(B_k|A) = \frac{P(B_k \cap A)}{P(A)} = \frac{P(A|B_k)P(B_k)}{P(A|B_1)P(B_1)+P(A|B_2)P(B_2) + \ldots + P(A|B_n)P(B_n)}\)
\end{theorem}

\hypertarget{combinatorics}{%
\section{Combinatorics}\label{combinatorics}}

Combinatorics is the mathematical study of counting, particularly with respect to permutations and combinations.

\begin{definition}
The \textbf{\emph{factorial function (\(n!\))}} is defined for all positive integers by: \(n! = n \cdot (n-1) \cdot \ldots 2 \cdot 1\)
\end{definition}

Note that \(0! \equiv 1\) and \(1! \equiv 1\).

\begin{definition}
An ordered subset is called a \textbf{\emph{permutation}}. The number of permutations of size \(k\) that can be formed from the \(n\) elements in a set is given by: \(P_{n,k} = \frac{n!}{(n-k)!}\)
\end{definition}

\begin{definition}
An unordered subset is called a \textbf{\emph{combination}}. The number of combinations of size \(k\) that can be formed from the \(n\) elements in a set is given by: \(C_{n,k} = {n \choose k} = \frac{n!}{k! \cdot (n-k)!}\)
\end{definition}

\begin{theorem}[Product Rule for Ordered Pairs]
If the first element of an ordered pair can be selected in \(n_1\) ways and for each of the these \(n_1\) ways the second element of the pair can be selected in \(n_2\) ways, then the number of pairs is \(n_1 \cdot n_2\).
\end{theorem}

\begin{theorem}[Generalized Product Rule]
Suppose a set consists of \(k\) elements (k-tuples) and that there are \(n_1\) possible choices for the first element, \(n_2\) possible choices for the second element, \ldots{} , and \(n_k\) possible choices for the \(k^\text{th}\) element, then there are \(n_1 \cdot n_2 \cdot \ldots \cdot n_k\) possible k-tuples.
\end{theorem}

\hypertarget{odds-and-gambling}{%
\section{Odds and Gambling}\label{odds-and-gambling}}

\hypertarget{random-variables}{%
\section{Random Variables}\label{random-variables}}

\begin{definition}
Let \(\Omega\) be the sample space of an experiment. A \textbf{\emph{random variable}} is a rule that associates a number with each outcome in \(\Omega\). In other words, a random variable is a function whose domain is \(\Omega\) and whose range is the set of real numbers.
\end{definition}

Random variables are be broken down into subcategories:\\
1. \textbf{\emph{Discrete random variables}} - random variables which have a sample space that is finite or countably infinite.\\
2. \textbf{\emph{Continuous random variables}} - random variables which have a sample space that is uncountably infinite (such as an interval of real numbers)

\textbf{\emph{Discrete}} and \textbf{\emph{Continuous}} random variables use similar yet slightly different mathematical tools. Discrete random variables involve working with ``sums'' and continuous random variables involve working with ``integrals''.

\begin{example}
\[ \]
\end{example}

\hfill\break
\hfill\break
\hfill\break

\begin{example}
\[ \]
\end{example}

\hfill\break
\hfill\break
\hfill\break

\begin{definition}
A \textbf{\emph{probability distribution}} is a function that gives probabilities of different possible outcomes for a given experiment.
\end{definition}

The probability distribution for a discrete random variable, \(p(x)\), is called a \textbf{\emph{probability mass function (pmf)}}.

The probability distribution for a continuous random variable, \(f(x)\), is called a \textbf{\emph{probability density function (pdf)}}.

\begin{example}
Suppose the Colorado Rockies are playing a four game series against the Chicago Cubs and that the Rockies have a 65\% chance of winning an individual game. Further, assume that the games are independent. The following PMF describes the outcomes (number of Rockies wins) and their probabilities.

\begin{table}
\centering
\begin{tabular}{l|r|r|r|r|r}
\hline
Rockies wins, X & 0.000 & 1.000 & 2.000 & 3.000 & 4.000\\
\hline
Probability, p(X) & 0.015 & 0.111 & 0.311 & 0.384 & 0.179\\
\hline
\end{tabular}
\end{table}

What is the probability that the Rockies win zero games? What is the probability that the Rockies win at least two games? Why might the independence assumption be false?
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

We may be interested in describing the center or average value of our random variable. We can do this with the following definitions.

\begin{definition}

The \textbf{\emph{expected value}} (or \textbf{\emph{population mean}} or \textbf{\emph{average}}) of a random variable \(X\) is given by:\\

\begin{enumerate}
\def\labelenumi{(\roman{enumi})}
\item
  \(E[X] = \mu = \sum_{x \in \Omega} x \cdot p(x)\) (for discrete random variables)
\item
  \(E[X] = \mu = \int_{x \in \Omega} x \cdot f(x) dx\) (for continuous random variables)
\end{enumerate}

\end{definition}

For this class, evaluating integrals is not essential, so we will avoid using Calculus (integrals and derivatives) when possible.

Sometimes, it makes sense to calculate the expected value of a function of a random variable. This can be easily done with a slight modification to the previous definition. Let \(h(X)\) be some function of a random variable \(X\). The expected value of \(h(X)\), \(E[h(X)]\), is given by:

\begin{enumerate}
\def\labelenumi{(\roman{enumi})}
\item
  \(E[h(X)] = \sum_{x \in \Omega} h(x) \cdot p(x)\) (for discrete random variables)
\item
  \(E[h(X)] = \int_{x \in \Omega} h(x) \cdot f(x) dx\) (for continuous random variables)
\end{enumerate}

\begin{example}
For the Rockies/Cubs four game series example, calculate \(E[X]\) and \(E[X^2]\).
\end{example}

\hfill\break
\hfill\break
\hfill\break
\hfill\break
\hfill\break

The spread or variability associated with a random variable can be calculated using expected values as well.

\begin{definition}

The \textbf{\emph{population variance}} of a random variable \(X\) is given by:\\

\begin{enumerate}
\def\labelenumi{(\roman{enumi})}
\item
  \(Var(X) = \sum_{x \in \Omega} (x-\mu)^2 \cdot p(x)\) (for discrete random variables)
\item
  \(Var(X) = \int_{x \in \Omega} (x-\mu)^2 \cdot f(x) dx\) (for continuous random variables)
\end{enumerate}

\end{definition}

There is also a shortcut formula for calculating variance:\\

\begin{theorem}
\(Var(X) = E[X^2] - (E[X])^2\)
\end{theorem}

\begin{definition}
The \textbf{\emph{population standard deviation}} of a random variable \(X\) is given by:\\

\(SD(X) = \sigma = \sqrt{Var(X)} = \sqrt{E[X^2]-(E[X])^2}\)
\end{definition}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{some-examples}{%
\section{Some examples}\label{some-examples}}

Over the course of a season, a hockey player scored a goal 30\% of the time during a home game, and \(P(player\ scores\ |\ away\ game) = .18\). Assume all games are either home or away.

Q: What is the probability the player scored a goal in any game if there were an equal number of home and away games?

A: \(P(score) = P(score|home)P(home) + P(score|away)P(away) = .3(.5) + .18(.5) = .24\)

Q: What is the probability the player scored a goal in any game if there were twice as many home games as away games?

A: \(P(score) = P(score|home)P(home) + P(score|away)P(away) = .3(\frac{2}{3}) + .18(\frac{1}{3}) = .26\)

Q: What is the probability the player scored a goal in any game if the ratio of home games to away games is 2:3?

A: \(P(score) = P(score|home)P(home) + P(score|away)P(away) = .3(\frac{2}{5}) + .18(\frac{3}{5}) = .228\)

\hypertarget{sets-and-conditional-probability}{%
\subsection{Sets and Conditional Probability}\label{sets-and-conditional-probability}}

100 sports fans in Colorado were polled and it was found that 64 had attended either a Denver Nuggets or Colorado Avalanche game at Ball Arena (formerly Pepsi Center). 34 people had seen only a Nuggets game, while 17 had seen both a Nuggets and an Avalanche game.

Q: How many people saw an Avalanche game but not a Nuggets game?

A: 64 - 34 - 17 = 13

Q: What is the probability that a randomly selected person in the poll had been to a Nuggets game?

A: (34 + 17) / 100 = .51

Q: What is the probability that a randomly selected person that had been to a game at Ball Arena had been to a Nuggets game?

A: (34 + 17) / 64 = .797

Q: What is the probability that a randomly selected person had been to a Nuggets game given they had been to an Avalanche game?

A: 17 / (17 + 13) = .567

\hypertarget{binomial-probability}{%
\subsection{Binomial Probability}\label{binomial-probability}}

Two baseball teams are playing a 4-game series. The home team has a .65 probability of winning each game, and the away team a .35 probability. Assume each game is independent.

\emph{I used baseball in this example because it's the sport that most often has 4-game series, but it could easily be replaced by another sport.}

Find the following probabilities.

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\tightlist
\item
  The road team wins exactly 1 game.
\end{enumerate}

\(\binom{4}{1}\ .65^3\ .35^1 = \binom{4}{3}\ .65^3\ .35^1 \approx .384\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbinom}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.35}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.384475
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbinom}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.65}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.384475
\end{verbatim}

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  The home team wins exactly 2 games.
\end{enumerate}

\(\binom{4}{2}\ .65^2\ .35^2 \approx .311\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbinom}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.65}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.3105375
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbinom}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.35}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.3105375
\end{verbatim}

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  The road team wins at least 2 games.
\end{enumerate}

\(\binom{4}{2}\ .65^2\ .35^2 + \binom{4}{3}\ .65^1\ .35^3 + .35^4 = 1 - [.65^4 + \binom{4}{1}\ .65^3\ .35^1] \approx .437\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pbinom}\NormalTok{(}\FloatTok{1.9}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.35}\NormalTok{, }\AttributeTok{lower.tail =}\NormalTok{ F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.4370187
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pbinom}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.65}\NormalTok{, }\AttributeTok{lower.tail =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.4370187
\end{verbatim}

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\setcounter{enumi}{3}
\tightlist
\item
  The series ends in a sweep.
\end{enumerate}

\(.65^4 + .35^4 \approx .194\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbinom}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.65}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{dbinom}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.35}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.1935125
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FloatTok{0.65}\SpecialCharTok{\^{}}\DecValTok{4} \SpecialCharTok{+} \FloatTok{0.35}\SpecialCharTok{\^{}}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.1935125
\end{verbatim}

\hypertarget{binomial-coefficient-symmetry}{%
\subsection{Binomial Coefficient Symmetry}\label{binomial-coefficient-symmetry}}

Playoff series for a certain sports league are played as a best-of-seven series, with one team hosting four games and the opposing team hosing three. An executive for the league wishes to know the number of ways the home and away games can be assigned. (One such combination is A-A-B-B-A-B-A, the format used by the NBA and NHL for their best-of-seven series.) What is the total number of combinations?

Answer: Since there are a fixed number of games (seven) and a fixed number of games that must be given to the lower-seeded team (four), there are \(\binom{7}{4} = \frac{7!}{4!\ \cdot\ (7-4)!} = 35\) ways to create a home-away pattern for the seven-game series.

However, instead of thinking about the number of ways to assign the games to the team that gets four home games, what if we thought about the number of ways to assign games to the team that gets three home games?

That would be \(\binom{7}{3}\). We can use the \texttt{choose} command in R to find this quantity.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{choose}\NormalTok{(}\DecValTok{7}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 35
\end{verbatim}

It turns out that this binomial coefficient is also equal to 35.

Theorem: \(\binom{n}{k} = \binom{n}{n-k}\)

\(\binom{n}{k} = \frac{n!}{k!\ \cdot\ (n-k)!}\)

\(\binom{n}{n-k} = \frac{n!}{(n-k)!\ \cdot\ (n-(n-k))!} = \frac{n!}{(n-k)!\ \cdot\ k!} = \binom{n}{k}\)

\hypertarget{binomials-and-multinomials}{%
\subsection{Binomials and Multinomials}\label{binomials-and-multinomials}}

Suppose we are curious about probabilities regarding the results of a soccer team's next five games.

Wait!!! A soccer game has three possible outcomes (win, lose, draw)! We can't use the binomial distribution, since it limits us to two possible outcomes!

It depends. If we are interested in the probability that a soccer team wins 2 of their next 5 games, we can use the binomial distribution. We can create the following partition of the sample space of outcomes: \((Win)\) and \((Win^C)\), where the second set includes both losing and drawing.

Then, the formula would be represented as:

\(\binom{5}{2}\ P(Win)^2\  P(Win^C)^{(5-2)}\)

If we are interested in the probability of the team winning two of the next five games, drawing two, and losing one, we cannot use the binomial theorem. That involves three outcomes, and would be represented as a multinomial.

\hypertarget{geometric-first-success-rvs}{%
\subsection{Geometric (First Success) RVs}\label{geometric-first-success-rvs}}

Caution: Some references parameterize the Geometric distribution based on the number of failures before the first success, rather than the trial on which the first success occurs. This changes the PMF, mean, and variance, so be careful.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{2022}\NormalTok{)}
\NormalTok{geometric }\OtherTok{\textless{}{-}} \FunctionTok{rgeom}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{1}\SpecialCharTok{/}\DecValTok{3}\NormalTok{)}
\FunctionTok{head}\NormalTok{(geometric, }\DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  2  5  1  3 12  7  1  4  2  2  1  1  1  2  0  0  0  4  3  0
\end{verbatim}

Some of the values were 0, which could not happen if R was considering the number of the trial on which the first success occurred. You can add 1 to the values given by \texttt{R} to arrive at the First Success distribution.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{first\_success }\OtherTok{\textless{}{-}}\NormalTok{ geometric }\SpecialCharTok{+} \DecValTok{1}
\FunctionTok{head}\NormalTok{(first\_success, }\DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  3  6  2  4 13  8  2  5  3  3  2  2  2  3  1  1  1  5  4  1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(first\_success)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.03
\end{verbatim}

The mean of this sample of variables is 3.03, which is close to the expected mean of \(\frac{1}{p} = 3\).

\hypertarget{geometric-distribution---hockey}{%
\subsection{Geometric Distribution - Hockey}\label{geometric-distribution---hockey}}

Suppose the number of shots needed by a hockey team in order to score their first goal, X, is modeled by a Geometric(\(\frac{1}{10}\)) random variable.

Q: What is the probability that it takes more than 3 shots to score the first goal?

A: \(P(X > 3) = P(X = 4) + P(X = 5) + P(X = 6) + ...\)

This is an infinite series, so let's use the Law of Total Probability.

\(P(X > 3) = 1 - P(X \leq 3) = 1 - [P(X = 1) + P(X = 2) + P(X = 3)] = 1 - [(\frac{1}{10}) + (\frac{9}{10})^1(\frac{1}{10}) + (\frac{9}{10})^2(\frac{1}{10})] = .729\)

\hypertarget{expectation---baseball}{%
\subsection{Expectation - Baseball}\label{expectation---baseball}}

The expectation of a discrete random variable is a weighted average. The ``weights'' are the probabilities of the possible values of the variable.

Consider the following table, which shows the number of career hits by type for the all-time Major League Baseball leader in total bases, Hank Aaron.

\begin{table}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
Hit\_type & Number\_bases & Hit\_Frequency & Hit\_Proportion\\
\hline
Single & 1 & 2294 & 0.6083267\\
\hline
Double & 2 & 624 & 0.1654734\\
\hline
Triple & 3 & 98 & 0.0259878\\
\hline
Home Run & 4 & 755 & 0.2002122\\
\hline
\end{tabular}
\end{table}

The expected number of bases for a Hank Aaron hit is the sum of the number of bases attained for each hit multiplied by the relative frequency of the occurrence of that type of hit.

\(1 \cdot \frac{2294}{3771} + 2 \cdot \frac{624}{3771} + 3 \cdot \frac{98}{3771} + 4 \cdot \frac{755}{3771} = 1.18181\)

This is the same process that is occurring whenever we calculate the expectation of any discrete random variable. Recall the formula for expectation is \(E[X] = \sum_{x \in \Omega}\ x \cdot p(x)\). Each value in the sample space is ``adjusted'' by the probability of that value, then the sum of all values in \(\Omega\) is taken to arrive at the weighted average, or expected value, of the random variable.

\hypertarget{basketball-scenario}{%
\subsection{Basketball Scenario}\label{basketball-scenario}}

You are the coach of a basketball team that is down two points with one second remaining in the fourth quarter. During a timeout, you are considering the best play to call for your team. The first option is a three-point shot attempt, which you estimate has a 30\% chance of succeeding. The second option is a two-point shot attempt, which has a 50\% chance of making the field goal, a 30\% chance of missing it and ending the game, and a 20\% chance the shooter will miss but be fouled, in which case the shooter's free throw success will follow a \(Bin(2, .8)\) random variable. Finally, you estimate that your team's probability of winning the game in overtime is .45.

Assume the above situations are exhaustive (i.e., the other team will not get another possession, no fouls will be called before the ball is put in play, lightning will not hit the arena and postpone the game, etc.). Which of the two plays should you call to maximize the win probability for your team?

A: The probability of winning the game with the three-point shot attempt is .3. If the two-point shot attempt is called for, there is a .5 probability of making the field goal and a (.2)(.8)(.8) = .128 probability that the foul is called and both free throws are made. Thus, the total probability of scoring two points and sending the game to overtime is .628. Then, the probability of winning the game in OT after tying it in regulation is (.628)(.45) = .2828. This is less than .3, so shooting the three-pointer is the option that maximizes the win probability, given these situational probabilities.

Q: What is the minimum estimated overtime win probability to make calling for the two-point play the better option?

A: \(P(score\ 2\ points\ in\ regulation) \cdot P(win\ in\ OT) > P(win\ in\ regulation)\)\\
\(.628 \cdot P(win\ in\ OT) > .3\)\\
\(P(win\ in\ OT) > .478\)

\hypertarget{multiple-probability-distributions---basketball}{%
\section{Multiple Probability Distributions - Basketball}\label{multiple-probability-distributions---basketball}}

Suppose the number of points scored by a basketball player follows a Poisson(12) random variable, the number of rebounds by a Poisson(7) distribution, and assists by a Discrete Uniform(2, 11), independently of each other.

Q: What is the probability that this player records a points, rebounds, assists triple-double in a game?

A: \(P(Triple\ Double) = P(Points \geq 10\ \cap\ Rebounds \geq 10\ \cap\ Assists \geq 10)\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ppois}\NormalTok{(}\DecValTok{9}\NormalTok{, }\AttributeTok{lambda =} \DecValTok{12}\NormalTok{, }\AttributeTok{lower.tail =}\NormalTok{ F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.7576078
\end{verbatim}

\(P(Points \geq 10) = P(Poisson(12) \geq 10) \approx .758\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ppois}\NormalTok{(}\DecValTok{9}\NormalTok{, }\AttributeTok{lambda =} \DecValTok{7}\NormalTok{, }\AttributeTok{lower.tail =}\NormalTok{ F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.1695041
\end{verbatim}

\(P(Rebounds \geq 10) = P(Poisson(7) \geq 10) \approx .170\)

\(P(Assists \geq 10) = P(Discrete\ Uniform(2, 11) \geq 10) = .2\)

Since the events are independent, we can multiply their probabilities. The probability of the player scoring the triple-double is \((.758)(.170)(.2) = .0257\).

Q: Your friend offers you 4 to 1 that the player will not record a triple-double in their next 10 games. With the knowledge that the athlete's performance in a game is unaffected by performances in previous games, would you take the bet?

A: \(P(no\ triple\ double) = 1 - .0257 = .9743\), so \(P(no\ triple\ double\ in\ next\ 10\ games) = (.9743)^{10} = .771\)

The odds of no triple-double are \(\frac{.771}{1-.771} = 3.37\), so the bet of no triple-double at 4 to 1 odds is favorable.

\hypertarget{poisson-distribution---soccer}{%
\section{Poisson Distribution - Soccer}\label{poisson-distribution---soccer}}

During the 2021 Major League Soccer season, the Colorado Rapids scored 51 goals in 34 games on their way to a first-place finish in the Western Conference regular season standings.

The team scored \(\frac{51}{34} = 1.5\) goals per game. Let's model the distribution of Rapids goals using a Poisson(1.5) random variable that we'll call Y.

Q: Which is more likely: Y taking on the value 0 or Y taking on the value 2?

We can plot the PMF of Y to check visually.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\FunctionTok{transform}\NormalTok{(}\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{8}\NormalTok{)), }\AttributeTok{y =} \FunctionTok{dpois}\NormalTok{(x, }\AttributeTok{lambda =} \FloatTok{1.5}\NormalTok{)), }\FunctionTok{aes}\NormalTok{(x, y)) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Value"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Frequency"}\NormalTok{, }\AttributeTok{title =} \StringTok{"Probability mass function of Poisson(1.5) random variable"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/soccer poisson-1.pdf}

A: From the plot, \(P(Y = 2) > P(Y = 0)\).

Q: What is the exact probability that this Poisson(1.5) random variable takes on the value 2?

A: We can find this quantity using the \texttt{dpois} command.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dpois}\NormalTok{(}\AttributeTok{x =} \DecValTok{2}\NormalTok{, }\AttributeTok{lambda =} \FloatTok{1.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2510214
\end{verbatim}

The same quantity can be obtained by plugging the numbers into the Poisson PMF.

\(\frac{1.5^2 e^{-1.5}}{2!} = 0.251\)

Q: Let's switch it around. What is the probability that a Poisson(2) random variable takes on the value 1.5?

A: 0. Poisson random variables cannot take on values other than nonnegative integers. Remember, Poisson random variables are often used for count data.

Let's check whether using a Poisson distribution was appropriate by comparing it to the actual 2021 Colorado Rapids match results.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(}\StringTok{"kableExtra"}\NormalTok{)}

\NormalTok{goals }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\StringTok{"5 or more"}\NormalTok{)}
\NormalTok{actual\_frequency }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{14}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{actual\_proportion }\OtherTok{\textless{}{-}}\NormalTok{ actual\_frequency}\SpecialCharTok{/}\FunctionTok{sum}\NormalTok{(actual\_frequency)}
\NormalTok{expected\_proportion }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{dpois}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\AttributeTok{lambda =} \FloatTok{1.5}\NormalTok{), }\FunctionTok{ppois}\NormalTok{(}\DecValTok{4}\NormalTok{, }\AttributeTok{lambda =} \FloatTok{1.5}\NormalTok{, }\AttributeTok{lower.tail =} \ConstantTok{FALSE}\NormalTok{))}
\NormalTok{expected\_frequency }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(expected\_proportion }\SpecialCharTok{*} \DecValTok{34}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\NormalTok{rapids.data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(goals, actual\_frequency, actual\_proportion, expected\_frequency,}
\NormalTok{    expected\_proportion)}

\NormalTok{rapids.data }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{kbl}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{kable\_styling}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{table}
\centering
\begin{tabular}[t]{l|r|r|r|r}
\hline
goals & actual\_frequency & actual\_proportion & expected\_frequency & expected\_proportion\\
\hline
0 & 6 & 0.1764706 & 7.6 & 0.2231302\\
\hline
1 & 14 & 0.4117647 & 11.4 & 0.3346952\\
\hline
2 & 7 & 0.2058824 & 8.5 & 0.2510214\\
\hline
3 & 6 & 0.1764706 & 4.3 & 0.1255107\\
\hline
4 & 0 & 0.0000000 & 1.6 & 0.0470665\\
\hline
5 or more & 1 & 0.0294118 & 0.6 & 0.0185759\\
\hline
\end{tabular}
\end{table}

\emph{answers may vary for following questions}

Q: What differences do you notice between the actual results and the expected values based on the Poisson random variable?

A: There were fewer games in which the Rapids scored 4 or more goals than the model would indicate, yet the Rapids were shut out less often than the model would indicate.

Q: Even if the true population distribution of 2021 Rapids goals was truly a Poisson(1.5) random variable, why might the actual distribution of their goals differ from the probability mass function?

A: 34 is a relatively small sample size; random variables may not coincide with their expected values for finite sample sizes.

Q: What are the advantages of using the Poisson distribution to model Major League soccer goals? What are the disadvantages?

A: Poisson random variables can take on the natural numbers (including zero), which aligns with the number of goals that can be scored in a match. One disadvantage is that it is possible for a Poisson to take on values that are not realistic for the situation, such as double-digit integers or higher. Only one game in MLS history has had a team score more than seven goals in a game. However, when \(\lambda\) is small (such as 1.5), these extreme values are relatively unlikely.

\hypertarget{law-of-total-probability---hockey}{%
\section{Law of Total Probability - Hockey}\label{law-of-total-probability---hockey}}

Over the course of a season, a hockey player scored a goal 30\% of the time during a home game, and \(P(player\ scores\ |\ away\ game) = .18\). Assume all games are either home or away.

Q: What is the probability the player scored a goal in any game if there were an equal number of home and away games?

A: \(P(score) = P(score|home)P(home) + P(score|away)P(away) = .3(.5) + .18(.5) = .24\)

Q: What is the probability the player scored a goal in any game if there were twice as many home games as away games?

A: \(P(score) = P(score|home)P(home) + P(score|away)P(away) = .3(\frac{2}{3}) + .18(\frac{1}{3}) = .26\)

Q: What is the probability the player scored a goal in any game if the ratio of home games to away games is 2:3?

A: \(P(score) = P(score|home)P(home) + P(score|away)P(away) = .3(\frac{2}{5}) + .18(\frac{3}{5}) = .228\)

\hypertarget{law-of-total-probability---baseball}{%
\section{Law of Total Probability - Baseball}\label{law-of-total-probability---baseball}}

You work in the front office of a professional baseball club and have just learned that a certain prospect hits .200 against left-handed pitchers and .400 against right-handed pitchers (their overall batting average is unknown). The general manager of the team overhears you talking about the .400 statistic of the player and becomes very exited that they have the chance to draft a .400 hitter. What would you say to caution the GM that the player might not be a remarkable hitter?

A: We don't know the proportion of the player's at-bats that came against left-handed pitchers versus right-handed pitchers. If we want to know the player's batting average unconditional on the type of pitcher they are facing, we have to adjust \(P(hit\ |\ left-handed\ pitcher)\) by \(P(left-handed\ pitcher)\) and \(P(hit\ |\ right-handed\ pitcher)\) by \(P(right-handed\ pitcher)\) before adding them to determine \(P(hit)\). For example, if 90\% of the player's at-bats were against left-handed pitchers, then their overall batting average is a pedestrian .220.

\emph{Other possible issues: low sample size of player's at-bats, the fact that pro pitchers will be harder to hit against than non-pros}

\hypertarget{sets-and-conditional-probability-1}{%
\section{Sets and Conditional Probability}\label{sets-and-conditional-probability-1}}

100 sports fans in Colorado were polled and it was found that 64 had attended either a Denver Nuggets or Colorado Avalanche game at Ball Arena (formerly Pepsi Center). 34 people had seen only a Nuggets game, while 17 had seen both a Nuggets and an Avalanche game.

Q: How many people saw an Avalanche game but not a Nuggets game?

A: 64 - 34 - 17 = 13

Q: What is the probability that a randomly selected person in the poll had been to a Nuggets game?

A: (34 + 17) / 100 = .51

Q: What is the probability that a randomly selected person that had been to a game at Ball Arena had been to a Nuggets game?

A: (34 + 17) / 64 = .797

Q: What is the probability that a randomly selected person had been to a Nuggets game given they had been to an Avalanche game?

A: 17 / (17 + 13) = .567

\hypertarget{binomial-probability-1}{%
\section{Binomial Probability}\label{binomial-probability-1}}

Two baseball teams are playing a 4-game series. The home team has a .65 probability of winning each game, and the away team a .35 probability. Assume each game is independent.

\emph{I used baseball in this example because it's the sport that most often has 4-game series, but it could easily be replaced by another sport.}

Find the following probabilities.

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\tightlist
\item
  The road team wins exactly 1 game.
\end{enumerate}

\(\binom{4}{1}\ .65^3\ .35^1 = \binom{4}{3}\ .65^3\ .35^1 \approx .384\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbinom}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.35}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.384475
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbinom}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.65}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.384475
\end{verbatim}

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  The home team wins exactly 2 games.
\end{enumerate}

\(\binom{4}{2}\ .65^2\ .35^2 \approx .311\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbinom}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.65}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.3105375
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbinom}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.35}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.3105375
\end{verbatim}

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  The road team wins at least 2 games.
\end{enumerate}

\(\binom{4}{2}\ .65^2\ .35^2 + \binom{4}{3}\ .65^1\ .35^3 + .35^4 = 1 - [.65^4 + \binom{4}{1}\ .65^3\ .35^1] \approx .437\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pbinom}\NormalTok{(}\FloatTok{1.9}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.35}\NormalTok{, }\AttributeTok{lower.tail =}\NormalTok{ F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.4370187
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pbinom}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.65}\NormalTok{, }\AttributeTok{lower.tail =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.4370187
\end{verbatim}

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\setcounter{enumi}{3}
\tightlist
\item
  The series ends in a sweep.
\end{enumerate}

\(.65^4 + .35^4 \approx .194\)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbinom}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.65}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{dbinom}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{0.35}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.1935125
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FloatTok{0.65}\SpecialCharTok{\^{}}\DecValTok{4} \SpecialCharTok{+} \FloatTok{0.35}\SpecialCharTok{\^{}}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.1935125
\end{verbatim}

\hypertarget{binomial-coefficient-symmetry-1}{%
\section{Binomial Coefficient Symmetry}\label{binomial-coefficient-symmetry-1}}

Playoff series for a certain sports league are played as a best-of-seven series, with one team hosting four games and the opposing team hosing three. An executive for the league wishes to know the number of ways the home and away games can be assigned. (One such combination is A-A-B-B-A-B-A, the format used by the NBA and NHL for their best-of-seven series.) What is the total number of combinations?

Answer: Since there are a fixed number of games (seven) and a fixed number of games that must be given to the lower-seeded team (four), there are \(\binom{7}{4} = \frac{7!}{4!\ \cdot\ (7-4)!} = 35\) ways to create a home-away pattern for the seven-game series.

However, instead of thinking about the number of ways to assign the games to the team that gets four home games, what if we thought about the number of ways to assign games to the team that gets three home games?

That would be \(\binom{7}{3}\). We can use the \texttt{choose} command in \texttt{R} to find this quantity.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{choose}\NormalTok{(}\DecValTok{7}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 35
\end{verbatim}

It turns out that this binomial coefficient is also equal to 35.

Theorem: \(\binom{n}{k} = \binom{n}{n-k}\)

\(\binom{n}{k} = \frac{n!}{k!\ \cdot\ (n-k)!}\)

\(\binom{n}{n-k} = \frac{n!}{(n-k)!\ \cdot\ (n-(n-k))!} = \frac{n!}{(n-k)!\ \cdot\ k!} = \binom{n}{k}\)

\hypertarget{binomials-and-multinomials-1}{%
\section{Binomials and Multinomials}\label{binomials-and-multinomials-1}}

Suppose we are curious about probabilities regarding the results of a soccer team's next five games.

Wait!!! A soccer game has three possible outcomes (win, lose, draw)! We can't use the binomial distribution, since it limits us to two possible outcomes!

It depends. If we are interested in the probability that a soccer team wins 2 of their next 5 games, we can use the binomial distribution. We can create the following partition of the sample space of outcomes: \((Win)\) and \((Win^C)\), where the second set includes both losing and drawing.

Then, the formula would be represented as:

\(\binom{5}{2}\ P(Win)^2\  P(Win^C)^{(5-2)}\)

If we are interested in the probability of the team winning two of the next five games, drawing two, and losing one, we cannot use the binomial theorem. That involves three outcomes, and would be represented as a multinomial.

\hypertarget{geometric-first-success-rvs-1}{%
\section{Geometric (First Success) RVs}\label{geometric-first-success-rvs-1}}

Caution: Some references parameterize the Geometric distribution based on the number of failures before the first success, rather than the trial on which the first success occurs. This changes the PMF, mean, and variance, so be careful.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{2022}\NormalTok{)}
\NormalTok{geometric }\OtherTok{\textless{}{-}} \FunctionTok{rgeom}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{1}\SpecialCharTok{/}\DecValTok{3}\NormalTok{)}
\FunctionTok{head}\NormalTok{(geometric, }\DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  2  5  1  3 12  7  1  4  2  2  1  1  1  2  0  0  0  4  3  0
\end{verbatim}

Some of the values were 0, which could not happen if \texttt{R} was considering the number of the trial on which the first success occurred. You can add 1 to the values given by \texttt{R} to arrive at the First Success distribution.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{first\_success }\OtherTok{\textless{}{-}}\NormalTok{ geometric }\SpecialCharTok{+} \DecValTok{1}
\FunctionTok{head}\NormalTok{(first\_success, }\DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  3  6  2  4 13  8  2  5  3  3  2  2  2  3  1  1  1  5  4  1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(first\_success)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.03
\end{verbatim}

The mean of this sample of variables is 3.03, which is close to the expected mean of \(\frac{1}{p} = 3\).

\hypertarget{geometric-distribution---hockey-1}{%
\section{Geometric Distribution - Hockey}\label{geometric-distribution---hockey-1}}

Suppose the number of shots needed by a hockey team in order to score their first goal, \(X\), is modeled by a Geometric(\(\frac{1}{10}\)) random variable.

Q: What is the probability that it takes more than 3 shots to score the first goal?

A: \(P(X > 3) = P(X = 4) + P(X = 5) + P(X = 6) +\ ...\)

This is an infinite series, so let's use the Complement Rule.

\(P(X > 3) = 1 - P(X \leq 3) = 1 - \sum_{i=1}^{3}P(X = i) = 1 - [\frac{1}{10} + (\frac{9}{10})^1(\frac{1}{10}) + (\frac{9}{10})^2(\frac{1}{10})] = .729\)

Q: Why might the assumptions for the Geometric distribution make it an imperfect model for this situation?

A: Geometric random variables assume a constant probability for each trial (in this case, shots on goal). In hockey, the probability of a shot hitting the back of the net changes based on its location, velocity, positioning of defensive players, whether the team is on the power play, etc.

\hypertarget{monte-carlo-simulation}{%
\chapter{Monte Carlo Simulation}\label{monte-carlo-simulation}}

\hypertarget{a-few-reminderstips-for-simulation-and-a-basic-example}{%
\section{A few reminders/tips for simulation, and a basic example}\label{a-few-reminderstips-for-simulation-and-a-basic-example}}

The number of regulation goals scored in a game by Hockey Team A, \(X\), is a Poisson(4) random variable, and the same for Hockey Team B, \(Y\), is a Poisson(3.2) random variable.

A statistician is interested in the probability that Team A defeats Team B in regulation. This is \(P(X > Y)\), which is difficult to calculate manually. However, using simulation, we can straightforwardly obtain an accurate estimation of this quantity.

There are many built-in functions in \texttt{R} that allow users to generate realizations from common probability distributions (\texttt{rnorm}, \texttt{rbinom}, \texttt{rexp}, etc.) Let's use the \texttt{rpois} function to simulate the appropriate variables, remembering to set a seed so that our results are easily replicable.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{2022}\NormalTok{)}

\NormalTok{nReps }\OtherTok{\textless{}{-}} \DecValTok{10000}

\NormalTok{team\_A\_goals }\OtherTok{\textless{}{-}} \FunctionTok{rpois}\NormalTok{(}\AttributeTok{n =}\NormalTok{ nReps, }\AttributeTok{lambda =} \DecValTok{4}\NormalTok{)}
\NormalTok{team\_B\_goals }\OtherTok{\textless{}{-}} \FunctionTok{rpois}\NormalTok{(}\AttributeTok{n =}\NormalTok{ nReps, }\AttributeTok{lambda =} \FloatTok{3.2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Now, to find \(P(X > Y)\), we can use the following line of code:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(team\_A\_goals }\SpecialCharTok{\textgreater{}}\NormalTok{ team\_B\_goals)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.5415
\end{verbatim}

Why does this work? First, operations to vectors are executed elementwise, meaning that \texttt{R} compares \texttt{team\_A\_goals{[}1{]}} to \texttt{team\_B\_goals{[}1{]}}, then \texttt{team\_A\_goals{[}2{]}} to \texttt{team\_B\_goals{[}2{]}}, and so on. Second, logical operators are stored as zeroes (when the condition is false) and ones (when the condition is true). The mean of a vector of zeroes and ones is the proportion of ones, which is the frequency of the logical statement being true. In our simulation, it was 0.5415. The true value is 0.5427, meaning that the simulation was quite accurate.

These tips will help you be more efficient when performing simulation tasks in \texttt{R}.

\hypertarget{streak-simulation---basketball}{%
\section{Streak Simulation - Basketball}\label{streak-simulation---basketball}}

Suppose an NBA team is in the middle of a rebuild and has a 25\% probability of winning each of its games in the following 82-game season.

Q: What is the probability that the team will go on at least one winning streak of four or more games over the course of the 82-game season?

A: We can simulate a season for the team, find the longest winning streak in that season, and store it in a vector. After repeating that process 10,000 times, we can then find the proportion of the values in that vector that are greater than or equal to 4.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{2022}\NormalTok{)}

\NormalTok{nReps }\OtherTok{\textless{}{-}} \DecValTok{10000}
\NormalTok{longest\_streak }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, nReps)}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{nReps) \{}
\NormalTok{    game\_results }\OtherTok{\textless{}{-}} \FunctionTok{rbinom}\NormalTok{(}\AttributeTok{size =} \DecValTok{1}\NormalTok{, }\AttributeTok{n =} \DecValTok{82}\NormalTok{, }\AttributeTok{prob =} \FloatTok{0.25}\NormalTok{)  }\CommentTok{\# 1=win, 0=loss}
\NormalTok{    streaks }\OtherTok{\textless{}{-}} \FunctionTok{rle}\NormalTok{(game\_results)}
\NormalTok{    longest\_streak[i] }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(streaks}\SpecialCharTok{$}\NormalTok{lengths[streaks}\SpecialCharTok{$}\NormalTok{values }\SpecialCharTok{==} \DecValTok{1}\NormalTok{])}
\NormalTok{\}}

\FunctionTok{table}\NormalTok{(longest\_streak)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## longest_streak
##    1    2    3    4    5    6    7    8    9 
##  116 3626 4233 1480  410  105   21    7    2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(longest\_streak }\SpecialCharTok{\textgreater{}=} \DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2025
\end{verbatim}

The team had a 4+ game winning streak in about 20\% of the simulations.

\hypertarget{statistical-inference}{%
\chapter{Statistical Inference}\label{statistical-inference}}

\hypertarget{one-sample-and-two-sample-t-tests-and-confidence-intervals}{%
\section{One Sample and Two Sample t-tests and confidence intervals}\label{one-sample-and-two-sample-t-tests-and-confidence-intervals}}

\hypertarget{correlation}{%
\chapter{Correlation}\label{correlation}}

\hypertarget{linear-regression}{%
\chapter{Linear Regression}\label{linear-regression}}

\hypertarget{data-scraping}{%
\chapter{Data Scraping}\label{data-scraping}}

\hypertarget{principal-component-analysis}{%
\chapter{Principal Component Analysis}\label{principal-component-analysis}}

\hypertarget{clustering}{%
\chapter{Clustering}\label{clustering}}

\hypertarget{classification}{%
\chapter{Classification}\label{classification}}

\hypertarget{decision-trees}{%
\chapter{Decision Trees}\label{decision-trees}}

\hypertarget{random-forests}{%
\section{Random Forests}\label{random-forests}}

\hypertarget{gradient-boosting}{%
\section{Gradient Boosting}\label{gradient-boosting}}

\hypertarget{non-parametric-statistics}{%
\chapter{Non-parametric Statistics}\label{non-parametric-statistics}}

\hypertarget{baseball-1}{%
\chapter{Baseball}\label{baseball-1}}

\hypertarget{football-1}{%
\chapter{Football}\label{football-1}}

\hypertarget{basketball-1}{%
\chapter{Basketball}\label{basketball-1}}

\hypertarget{soccer-1}{%
\chapter{Soccer}\label{soccer-1}}

\hypertarget{hockey-1}{%
\chapter{Hockey}\label{hockey-1}}

\hypertarget{volleyball-1}{%
\chapter{Volleyball}\label{volleyball-1}}

\hypertarget{resources}{%
\section{Resources}\label{resources}}

\href{https://www.ncaa.com/stats/volleyball-women/d1}{Women's Volleyball D1 Statistics}

\hypertarget{other-sports}{%
\chapter{Other Sports}\label{other-sports}}

\hypertarget{aarons-stuff}{%
\chapter{Aaron's stuff}\label{aarons-stuff}}

\hypertarget{notes-for-chapter-2-probability}{%
\section{Notes for Chapter 2 (Probability)}\label{notes-for-chapter-2-probability}}

\textbf{Axioms of Probability:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \(P(A) \geq 0\)
\item
  \(P(\Omega)=1\)
\item
  If \(A_1, A_2, \ldots, A_n\) are disjoint events, then \(P(\cup_{i=1}^n A_i) = \sum_{i=1}^n P(A_i)\)
\end{enumerate}

\begin{theorem}[Bayes theorem]
Let \(A\) and \(B\) be events in \(\Omega\) such that \(P(B)>0\). Then we have the following:
\[
P(A|B) = \frac{P(B|A)P(A)}{P(B)}
\]
\end{theorem}

\hypertarget{suggested-readings}{%
\section{Suggested Readings}\label{suggested-readings}}

\hypertarget{moneyball}{%
\subsection{Moneyball}\label{moneyball}}

Moneyball, Chapter 2, How to Find a Ballplayer \citep{lewis2004moneyball}

Near the end of the chapter (page 40), Michael Lewis give a list of players the Oakland Athletics hoped to draft. How did these players turn out? Find the WAR for each of the players in their pre-free agency years and compare it against the Rockies draft picks in the same rounds from the same draft.

\hypertarget{future-value}{%
\subsection{Future Value}\label{future-value}}

Future Value, Chapter 7, How to Scout \citep{longenhagen2020future}

If a player receives a running grade of 40, approximately what proportion of MLB players have a lower have a lower running grade?

For a given tool, about 95\% of all player grades fall between what two bounds? (Consider the middle 95\% of the distribution of grades.)

\hypertarget{notes-for-chapter-4-simulation}{%
\section{Notes for Chapter 4 (Simulation)}\label{notes-for-chapter-4-simulation}}

\hypertarget{baseball-simulation-example}{%
\subsection{Baseball Simulation Example}\label{baseball-simulation-example}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

This is a baseball example for chapter 4.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{2022}\NormalTok{)}
\NormalTok{n.sims }\OtherTok{\textless{}{-}} \DecValTok{1000}
\NormalTok{hits }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, n.sims)}
\NormalTok{avg }\OtherTok{\textless{}{-}} \FloatTok{0.3}
\NormalTok{atbats.mean }\OtherTok{\textless{}{-}} \DecValTok{450}
\NormalTok{atbats.sd }\OtherTok{\textless{}{-}} \DecValTok{100}
\NormalTok{sim.atbats }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(n.sims, atbats.mean, atbats.sd))}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{n.sims) \{}
\NormalTok{    sim.hits }\OtherTok{\textless{}{-}} \FunctionTok{rbinom}\NormalTok{(}\DecValTok{1}\NormalTok{, sim.atbats[i], avg)}
\NormalTok{    hits[i] }\OtherTok{=}\NormalTok{ sim.hits}
\NormalTok{\}}
\NormalTok{hits.df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Hits =}\NormalTok{ hits)}
\NormalTok{hits.df }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Hits)) }\SpecialCharTok{+} \FunctionTok{geom\_histogram}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{series_files/figure-latex/baseball-sim-1.pdf}

  \bibliography{book.bib,packages.bib}

\end{document}
