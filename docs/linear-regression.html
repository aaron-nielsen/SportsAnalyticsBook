<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Linear Regression | Sports Analytics</title>
  <meta name="description" content="Chapter 8 Linear Regression | Sports Analytics Notes" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Linear Regression | Sports Analytics" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://aaron-nielsen.github.io/SportsAnalyticsBook/images/csu.png" />
  <meta property="og:description" content="Chapter 8 Linear Regression | Sports Analytics Notes" />
  <meta name="github-repo" content="aaron-nielsen.github.io/SportsAnalyticsBook/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Linear Regression | Sports Analytics" />
  
  <meta name="twitter:description" content="Chapter 8 Linear Regression | Sports Analytics Notes" />
  <meta name="twitter:image" content="https://aaron-nielsen.github.io/SportsAnalyticsBook/images/csu.png" />

<meta name="author" content="Aaron Nielsen, Department of Statistics, Colorado State University" />


<meta name="date" content="2023-02-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="data-acquisition.html"/>
<link rel="next" href="principal-component-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Sports Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i>Preliminaries</a>
<ul>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#getting-started-with-r"><i class="fa fa-check"></i>Getting Started With R</a>
<ul>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#installing-r"><i class="fa fa-check"></i>Installing R</a></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#some-r-basics"><i class="fa fa-check"></i>Some R Basics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#which-sports"><i class="fa fa-check"></i>Which Sports?</a></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#challenges"><i class="fa fa-check"></i>Challenges</a></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#ethical-concerns"><i class="fa fa-check"></i>Ethical Concerns</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>1</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.1</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#definitions"><i class="fa fa-check"></i><b>1.1.1</b> Definitions</a></li>
<li class="chapter" data-level="1.1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#descriptive-statistics-1"><i class="fa fa-check"></i><b>1.1.2</b> Descriptive Statistics</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualizations"><i class="fa fa-check"></i><b>1.2</b> Visualizations</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#histograms"><i class="fa fa-check"></i><b>1.2.1</b> Histograms</a></li>
<li class="chapter" data-level="1.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#bar-plots"><i class="fa fa-check"></i><b>1.2.2</b> Bar Plots</a></li>
<li class="chapter" data-level="1.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#scatter-plots"><i class="fa fa-check"></i><b>1.2.3</b> Scatter Plots</a></li>
<li class="chapter" data-level="1.2.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#kable-tables"><i class="fa fa-check"></i><b>1.2.4</b> Kable Tables</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#baseball"><i class="fa fa-check"></i><b>1.3</b> Baseball</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#hitting-statistics"><i class="fa fa-check"></i><b>1.3.1</b> Hitting Statistics</a></li>
<li class="chapter" data-level="1.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#pitching-statistics"><i class="fa fa-check"></i><b>1.3.2</b> Pitching Statistics</a></li>
<li class="chapter" data-level="1.3.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#wins-above-replacement"><i class="fa fa-check"></i><b>1.3.3</b> Wins Above Replacement</a></li>
<li class="chapter" data-level="1.3.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#calculating-hitting-statistics"><i class="fa fa-check"></i><b>1.3.4</b> Calculating Hitting Statistics</a></li>
<li class="chapter" data-level="1.3.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#evaluating-pitching-statistics"><i class="fa fa-check"></i><b>1.3.5</b> Evaluating Pitching Statistics</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#football"><i class="fa fa-check"></i><b>1.4</b> Football</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#basic-football-statistics"><i class="fa fa-check"></i><b>1.4.1</b> Basic Football Statistics</a></li>
<li class="chapter" data-level="1.4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#advanced-football-statistics"><i class="fa fa-check"></i><b>1.4.2</b> Advanced Football Statistics</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#basketball"><i class="fa fa-check"></i><b>1.5</b> Basketball</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#basic-basketball-statistics"><i class="fa fa-check"></i><b>1.5.1</b> Basic Basketball Statistics</a></li>
<li class="chapter" data-level="1.5.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#advanced-basketball-statistics"><i class="fa fa-check"></i><b>1.5.2</b> Advanced Basketball Statistics</a></li>
<li class="chapter" data-level="1.5.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#four-factors"><i class="fa fa-check"></i><b>1.5.3</b> Four Factors</a></li>
<li class="chapter" data-level="1.5.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#shot-charts"><i class="fa fa-check"></i><b>1.5.4</b> Shot Charts</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#hockey"><i class="fa fa-check"></i><b>1.6</b> Hockey</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#basic-hockey-statistics"><i class="fa fa-check"></i><b>1.6.1</b> Basic Hockey Statistics</a></li>
<li class="chapter" data-level="1.6.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#advanced-hockey-statistics"><i class="fa fa-check"></i><b>1.6.2</b> Advanced Hockey Statistics</a></li>
<li class="chapter" data-level="1.6.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#actual-vs.-expected-goals"><i class="fa fa-check"></i><b>1.6.3</b> Actual vs. Expected Goals</a></li>
<li class="chapter" data-level="1.6.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#goalie-statistics"><i class="fa fa-check"></i><b>1.6.4</b> Goalie Statistics</a></li>
<li class="chapter" data-level="1.6.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#correlation-plots"><i class="fa fa-check"></i><b>1.6.5</b> Correlation Plots</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#volleyball"><i class="fa fa-check"></i><b>1.7</b> Volleyball</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#basic-volleyball-statistics"><i class="fa fa-check"></i><b>1.7.1</b> Basic Volleyball Statistics</a></li>
<li class="chapter" data-level="1.7.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#scatter-plot"><i class="fa fa-check"></i><b>1.7.2</b> Scatter Plot</a></li>
<li class="chapter" data-level="1.7.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#box-plot"><i class="fa fa-check"></i><b>1.7.3</b> Box Plot</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#soccer"><i class="fa fa-check"></i><b>1.8</b> Soccer</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#basic-soccer-statistics"><i class="fa fa-check"></i><b>1.8.1</b> Basic Soccer Statistics</a></li>
<li class="chapter" data-level="1.8.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#advanced-soccer-statistics"><i class="fa fa-check"></i><b>1.8.2</b> Advanced Soccer Statistics</a></li>
<li class="chapter" data-level="1.8.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#bar-plot"><i class="fa fa-check"></i><b>1.8.3</b> Bar Plot</a></li>
<li class="chapter" data-level="1.8.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#scatter-plot-1"><i class="fa fa-check"></i><b>1.8.4</b> Scatter Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>2</b> Probability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probability.html"><a href="probability.html#definitions-1"><i class="fa fa-check"></i><b>2.1</b> Definitions</a></li>
<li class="chapter" data-level="2.2" data-path="probability.html"><a href="probability.html#set-theory"><i class="fa fa-check"></i><b>2.2</b> Set Theory</a></li>
<li class="chapter" data-level="2.3" data-path="probability.html"><a href="probability.html#axioms-properties-and-laws"><i class="fa fa-check"></i><b>2.3</b> Axioms, Properties, and Laws</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="probability.html"><a href="probability.html#axioms-of-probability"><i class="fa fa-check"></i><b>2.3.1</b> Axioms of Probability</a></li>
<li class="chapter" data-level="2.3.2" data-path="probability.html"><a href="probability.html#properties-of-probability"><i class="fa fa-check"></i><b>2.3.2</b> Properties of Probability</a></li>
<li class="chapter" data-level="2.3.3" data-path="probability.html"><a href="probability.html#laws-of-probability"><i class="fa fa-check"></i><b>2.3.3</b> Laws of Probability</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="probability.html"><a href="probability.html#combinatorics"><i class="fa fa-check"></i><b>2.4</b> Combinatorics</a></li>
<li class="chapter" data-level="2.5" data-path="probability.html"><a href="probability.html#random-variables"><i class="fa fa-check"></i><b>2.5</b> Random Variables</a></li>
<li class="chapter" data-level="2.6" data-path="probability.html"><a href="probability.html#common-random-variables"><i class="fa fa-check"></i><b>2.6</b> Common Random Variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="probability.html"><a href="probability.html#binomial-rvs"><i class="fa fa-check"></i><b>2.6.1</b> Binomial RVs</a></li>
<li class="chapter" data-level="2.6.2" data-path="probability.html"><a href="probability.html#geometric-rvs"><i class="fa fa-check"></i><b>2.6.2</b> Geometric RVs</a></li>
<li class="chapter" data-level="2.6.3" data-path="probability.html"><a href="probability.html#poisson-rvs"><i class="fa fa-check"></i><b>2.6.3</b> Poisson RVs</a></li>
<li class="chapter" data-level="2.6.4" data-path="probability.html"><a href="probability.html#negative-binomial-rvs"><i class="fa fa-check"></i><b>2.6.4</b> Negative Binomial RVs</a></li>
<li class="chapter" data-level="2.6.5" data-path="probability.html"><a href="probability.html#normal-rvs"><i class="fa fa-check"></i><b>2.6.5</b> Normal RVs</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="probability.html"><a href="probability.html#win-probability-models"><i class="fa fa-check"></i><b>2.7</b> Win Probability Models</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="probability.html"><a href="probability.html#estimating-pregame-win-probability"><i class="fa fa-check"></i><b>2.7.1</b> Estimating Pregame Win Probability</a></li>
<li class="chapter" data-level="2.7.2" data-path="probability.html"><a href="probability.html#estimating-in-game-win-probability"><i class="fa fa-check"></i><b>2.7.2</b> Estimating In-Game Win Probability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="odds-and-bets.html"><a href="odds-and-bets.html"><i class="fa fa-check"></i><b>3</b> Odds and Bets</a>
<ul>
<li class="chapter" data-level="3.1" data-path="odds-and-bets.html"><a href="odds-and-bets.html#odds"><i class="fa fa-check"></i><b>3.1</b> Odds</a></li>
<li class="chapter" data-level="3.2" data-path="odds-and-bets.html"><a href="odds-and-bets.html#gambling-odds"><i class="fa fa-check"></i><b>3.2</b> Gambling Odds</a></li>
<li class="chapter" data-level="3.3" data-path="odds-and-bets.html"><a href="odds-and-bets.html#types-of-bets"><i class="fa fa-check"></i><b>3.3</b> Types of Bets</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html"><i class="fa fa-check"></i><b>4</b> Monte Carlo Simulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#basics"><i class="fa fa-check"></i><b>4.1</b> Basics</a></li>
<li class="chapter" data-level="4.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#estimating-probabilities"><i class="fa fa-check"></i><b>4.2</b> Estimating Probabilities</a></li>
<li class="chapter" data-level="4.3" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#simulating-streaks"><i class="fa fa-check"></i><b>4.3</b> Simulating Streaks</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#winning-streak-simulation"><i class="fa fa-check"></i><b>4.3.1</b> Winning Streak Simulation</a></li>
<li class="chapter" data-level="4.3.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#hitting-streak-simulation"><i class="fa fa-check"></i><b>4.3.2</b> Hitting Streak Simulation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#gambling-simulations"><i class="fa fa-check"></i><b>4.4</b> Gambling Simulations</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#martingale-system"><i class="fa fa-check"></i><b>4.4.1</b> Martingale System</a></li>
<li class="chapter" data-level="4.4.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#gamblers-ruin"><i class="fa fa-check"></i><b>4.4.2</b> Gambler’s Ruin</a></li>
<li class="chapter" data-level="4.4.3" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#simulating-a-winning-system"><i class="fa fa-check"></i><b>4.4.3</b> Simulating a Winning System</a></li>
<li class="chapter" data-level="4.4.4" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#using-the-kelly-growth-criterion"><i class="fa fa-check"></i><b>4.4.4</b> Using the Kelly Growth Criterion</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#simulating-censored-data"><i class="fa fa-check"></i><b>4.5</b> Simulating Censored Data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#tony-gwynn-1994-batting-average-simulation"><i class="fa fa-check"></i><b>4.5.1</b> Tony Gwynn 1994 Batting Average Simulation</a></li>
<li class="chapter" data-level="4.5.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#matt-williams-1994-home-run-simulation"><i class="fa fa-check"></i><b>4.5.2</b> Matt Williams 1994 Home Run Simulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="inferential-statistics.html"><a href="inferential-statistics.html"><i class="fa fa-check"></i><b>5</b> Inferential Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#defining-a-population"><i class="fa fa-check"></i><b>5.1</b> Defining a Population</a></li>
<li class="chapter" data-level="5.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#statistical-inference"><i class="fa fa-check"></i><b>5.2</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#confidence-intervals"><i class="fa fa-check"></i><b>5.2.1</b> Confidence Intervals</a></li>
<li class="chapter" data-level="5.2.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#hypothesis-tests"><i class="fa fa-check"></i><b>5.2.2</b> Hypothesis Tests</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="inferential-statistics.html"><a href="inferential-statistics.html#inference-for-population-mean"><i class="fa fa-check"></i><b>5.3</b> Inference for Population Mean</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#confidence-interval-for-population-mean"><i class="fa fa-check"></i><b>5.3.1</b> Confidence Interval for Population Mean</a></li>
<li class="chapter" data-level="5.3.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#hypothesis-test-for-population-mean"><i class="fa fa-check"></i><b>5.3.2</b> Hypothesis Test for Population Mean</a></li>
<li class="chapter" data-level="5.3.3" data-path="inferential-statistics.html"><a href="inferential-statistics.html#test-for-difference-in-means"><i class="fa fa-check"></i><b>5.3.3</b> Test for Difference in Means</a></li>
<li class="chapter" data-level="5.3.4" data-path="inferential-statistics.html"><a href="inferential-statistics.html#confidence-interval-for-difference-in-means"><i class="fa fa-check"></i><b>5.3.4</b> Confidence Interval for Difference in Means</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="inferential-statistics.html"><a href="inferential-statistics.html#inference-for-population-proportion"><i class="fa fa-check"></i><b>5.4</b> Inference for Population Proportion</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#confidence-interval-for-population-proportion"><i class="fa fa-check"></i><b>5.4.1</b> Confidence Interval for Population Proportion</a></li>
<li class="chapter" data-level="5.4.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#test-for-population-proportion"><i class="fa fa-check"></i><b>5.4.2</b> Test for Population Proportion</a></li>
<li class="chapter" data-level="5.4.3" data-path="inferential-statistics.html"><a href="inferential-statistics.html#confidence-interval-for-difference-in-proportions"><i class="fa fa-check"></i><b>5.4.3</b> Confidence Interval for Difference in Proportions</a></li>
<li class="chapter" data-level="5.4.4" data-path="inferential-statistics.html"><a href="inferential-statistics.html#test-for-difference-in-proportions"><i class="fa fa-check"></i><b>5.4.4</b> Test for Difference in Proportions</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="inferential-statistics.html"><a href="inferential-statistics.html#bootstrap"><i class="fa fa-check"></i><b>5.5</b> Bootstrap</a></li>
<li class="chapter" data-level="5.6" data-path="inferential-statistics.html"><a href="inferential-statistics.html#margin-of-error-calcuations"><i class="fa fa-check"></i><b>5.6</b> Margin of Error Calcuations</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#moe-for-probabilities"><i class="fa fa-check"></i><b>5.6.1</b> MOE for Probabilities</a></li>
<li class="chapter" data-level="5.6.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#moe-for-averages"><i class="fa fa-check"></i><b>5.6.2</b> MOE for Averages</a></li>
<li class="chapter" data-level="5.6.3" data-path="inferential-statistics.html"><a href="inferential-statistics.html#moe-estimation-using-simulation"><i class="fa fa-check"></i><b>5.6.3</b> MOE estimation using simulation</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="inferential-statistics.html"><a href="inferential-statistics.html#one-sample-and-two-sample-t-tests-and-confidence-intervals"><i class="fa fa-check"></i><b>5.7</b> One Sample and Two Sample t-tests and confidence intervals</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#hockey-faceoffs"><i class="fa fa-check"></i><b>5.7.1</b> Hockey Faceoffs</a></li>
<li class="chapter" data-level="5.7.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#hockey-penalty-scoring"><i class="fa fa-check"></i><b>5.7.2</b> Hockey Penalty Scoring</a></li>
<li class="chapter" data-level="5.7.3" data-path="inferential-statistics.html"><a href="inferential-statistics.html#nfl-overtime-winners"><i class="fa fa-check"></i><b>5.7.3</b> NFL Overtime Winners</a></li>
<li class="chapter" data-level="5.7.4" data-path="inferential-statistics.html"><a href="inferential-statistics.html#icing-the-kicker"><i class="fa fa-check"></i><b>5.7.4</b> Icing the Kicker</a></li>
<li class="chapter" data-level="5.7.5" data-path="inferential-statistics.html"><a href="inferential-statistics.html#example-football-one-vs.-two-point-conversion"><i class="fa fa-check"></i><b>5.7.5</b> Example: Football One vs. Two Point Conversion</a></li>
<li class="chapter" data-level="5.7.6" data-path="inferential-statistics.html"><a href="inferential-statistics.html#two-sample-tests"><i class="fa fa-check"></i><b>5.7.6</b> Two Sample Tests</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="inferential-statistics.html"><a href="inferential-statistics.html#permutation-tests"><i class="fa fa-check"></i><b>5.8</b> Permutation Tests</a></li>
<li class="chapter" data-level="5.9" data-path="inferential-statistics.html"><a href="inferential-statistics.html#bootstrap-1"><i class="fa fa-check"></i><b>5.9</b> Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="measures-of-association.html"><a href="measures-of-association.html"><i class="fa fa-check"></i><b>6</b> Measures of Association</a>
<ul>
<li class="chapter" data-level="6.1" data-path="measures-of-association.html"><a href="measures-of-association.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>6.1</b> Pearson Correlation Coefficient</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="measures-of-association.html"><a href="measures-of-association.html#partial-correlation-and-confounding-variables"><i class="fa fa-check"></i><b>6.1.1</b> Partial Correlation and Confounding Variables</a></li>
<li class="chapter" data-level="6.1.2" data-path="measures-of-association.html"><a href="measures-of-association.html#properties-of-the-linear-correlation-coefficient"><i class="fa fa-check"></i><b>6.1.2</b> Properties of the Linear Correlation Coefficient</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="measures-of-association.html"><a href="measures-of-association.html#association-of-categorical-variables"><i class="fa fa-check"></i><b>6.2</b> Association of Categorical Variables</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="measures-of-association.html"><a href="measures-of-association.html#odds-ratios"><i class="fa fa-check"></i><b>6.2.1</b> Odds Ratios</a></li>
<li class="chapter" data-level="6.2.2" data-path="measures-of-association.html"><a href="measures-of-association.html#yules-q"><i class="fa fa-check"></i><b>6.2.2</b> Yule’s Q</a></li>
<li class="chapter" data-level="6.2.3" data-path="measures-of-association.html"><a href="measures-of-association.html#chi-squared-test-of-independence"><i class="fa fa-check"></i><b>6.2.3</b> Chi-Squared Test of Independence</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="measures-of-association.html"><a href="measures-of-association.html#rank-correlation"><i class="fa fa-check"></i><b>6.3</b> Rank Correlation</a></li>
<li class="chapter" data-level="6.4" data-path="measures-of-association.html"><a href="measures-of-association.html#serial-correlation"><i class="fa fa-check"></i><b>6.4</b> Serial Correlation</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="measures-of-association.html"><a href="measures-of-association.html#autocorrelation"><i class="fa fa-check"></i><b>6.4.1</b> Autocorrelation</a></li>
<li class="chapter" data-level="6.4.2" data-path="measures-of-association.html"><a href="measures-of-association.html#run-lengths"><i class="fa fa-check"></i><b>6.4.2</b> Run Lengths</a></li>
<li class="chapter" data-level="6.4.3" data-path="measures-of-association.html"><a href="measures-of-association.html#wald-wolfowitz-runs-test"><i class="fa fa-check"></i><b>6.4.3</b> Wald-Wolfowitz Runs Test</a></li>
<li class="chapter" data-level="6.4.4" data-path="measures-of-association.html"><a href="measures-of-association.html#hot-hand"><i class="fa fa-check"></i><b>6.4.4</b> Hot Hand</a></li>
<li class="chapter" data-level="6.4.5" data-path="measures-of-association.html"><a href="measures-of-association.html#streakiness-in-sports"><i class="fa fa-check"></i><b>6.4.5</b> Streakiness in Sports</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="measures-of-association.html"><a href="measures-of-association.html#pythagorean-record"><i class="fa fa-check"></i><b>6.5</b> Pythagorean Record</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-acquisition.html"><a href="data-acquisition.html"><i class="fa fa-check"></i><b>7</b> Data Acquisition</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-acquisition.html"><a href="data-acquisition.html#tabular-data-from-sports-reference"><i class="fa fa-check"></i><b>7.1</b> Tabular Data From Sports Reference</a></li>
<li class="chapter" data-level="7.2" data-path="data-acquisition.html"><a href="data-acquisition.html#downloading-datasets-from-internet"><i class="fa fa-check"></i><b>7.2</b> Downloading Datasets From Internet</a></li>
<li class="chapter" data-level="7.3" data-path="data-acquisition.html"><a href="data-acquisition.html#importing-data-using-r-libraries"><i class="fa fa-check"></i><b>7.3</b> Importing Data Using R Libraries</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="data-acquisition.html"><a href="data-acquisition.html#baseballr-package"><i class="fa fa-check"></i><b>7.3.1</b> BaseballR package</a></li>
<li class="chapter" data-level="7.3.2" data-path="data-acquisition.html"><a href="data-acquisition.html#nflfastr-package"><i class="fa fa-check"></i><b>7.3.2</b> nflfastR package</a></li>
<li class="chapter" data-level="7.3.3" data-path="data-acquisition.html"><a href="data-acquisition.html#hoopr-package"><i class="fa fa-check"></i><b>7.3.3</b> hoopR package</a></li>
<li class="chapter" data-level="7.3.4" data-path="data-acquisition.html"><a href="data-acquisition.html#hockeyr-package"><i class="fa fa-check"></i><b>7.3.4</b> hockeyR package</a></li>
<li class="chapter" data-level="7.3.5" data-path="data-acquisition.html"><a href="data-acquisition.html#worldfootballr"><i class="fa fa-check"></i><b>7.3.5</b> worldfootballR</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="data-acquisition.html"><a href="data-acquisition.html#data-scraping"><i class="fa fa-check"></i><b>7.4</b> Data Scraping</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="data-acquisition.html"><a href="data-acquisition.html#general-tips"><i class="fa fa-check"></i><b>7.4.1</b> General Tips</a></li>
<li class="chapter" data-level="7.4.2" data-path="data-acquisition.html"><a href="data-acquisition.html#introduction-to-html"><i class="fa fa-check"></i><b>7.4.2</b> Introduction to HTML</a></li>
<li class="chapter" data-level="7.4.3" data-path="data-acquisition.html"><a href="data-acquisition.html#rvest-package"><i class="fa fa-check"></i><b>7.4.3</b> rvest Package</a></li>
<li class="chapter" data-level="7.4.4" data-path="data-acquisition.html"><a href="data-acquisition.html#css-gadget-selector"><i class="fa fa-check"></i><b>7.4.4</b> CSS Gadget Selector</a></li>
<li class="chapter" data-level="7.4.5" data-path="data-acquisition.html"><a href="data-acquisition.html#scraping-examples"><i class="fa fa-check"></i><b>7.4.5</b> Scraping Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>8</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>8.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="8.2" data-path="linear-regression.html"><a href="linear-regression.html#residual-analysis"><i class="fa fa-check"></i><b>8.2</b> Residual Analysis</a></li>
<li class="chapter" data-level="8.3" data-path="linear-regression.html"><a href="linear-regression.html#polynomial-regression"><i class="fa fa-check"></i><b>8.3</b> Polynomial Regression</a></li>
<li class="chapter" data-level="8.4" data-path="linear-regression.html"><a href="linear-regression.html#variable-transformations"><i class="fa fa-check"></i><b>8.4</b> Variable Transformations</a></li>
<li class="chapter" data-level="8.5" data-path="linear-regression.html"><a href="linear-regression.html#multiple-regression-and-model-selection"><i class="fa fa-check"></i><b>8.5</b> Multiple Regression and Model Selection</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="linear-regression.html"><a href="linear-regression.html#model-selection-using-bic"><i class="fa fa-check"></i><b>8.5.1</b> Model Selection using BIC</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="linear-regression.html"><a href="linear-regression.html#confounding-variables"><i class="fa fa-check"></i><b>8.6</b> Confounding Variables</a></li>
<li class="chapter" data-level="8.7" data-path="linear-regression.html"><a href="linear-regression.html#interaction"><i class="fa fa-check"></i><b>8.7</b> Interaction</a></li>
<li class="chapter" data-level="8.8" data-path="linear-regression.html"><a href="linear-regression.html#confounding-variables-1"><i class="fa fa-check"></i><b>8.8</b> Confounding Variables</a></li>
<li class="chapter" data-level="8.9" data-path="linear-regression.html"><a href="linear-regression.html#logistic-regression"><i class="fa fa-check"></i><b>8.9</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="linear-regression.html"><a href="linear-regression.html#sack-and-interception-probability-models"><i class="fa fa-check"></i><b>8.9.1</b> Sack and Interception Probability Models</a></li>
<li class="chapter" data-level="8.9.2" data-path="linear-regression.html"><a href="linear-regression.html#soccer-goal-logistic-model"><i class="fa fa-check"></i><b>8.9.2</b> Soccer Goal Logistic Model</a></li>
<li class="chapter" data-level="8.9.3" data-path="linear-regression.html"><a href="linear-regression.html#field-goal-success"><i class="fa fa-check"></i><b>8.9.3</b> Field Goal Success</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>9</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="10" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>10</b> Clustering</a></li>
<li class="chapter" data-level="11" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>11</b> Classification</a></li>
<li class="chapter" data-level="12" data-path="nonparametric-methods.html"><a href="nonparametric-methods.html"><i class="fa fa-check"></i><b>12</b> Nonparametric Methods</a></li>
<li class="chapter" data-level="13" data-path="sports-drafts.html"><a href="sports-drafts.html"><i class="fa fa-check"></i><b>13</b> Sports Drafts</a></li>
<li class="chapter" data-level="14" data-path="baseball-1.html"><a href="baseball-1.html"><i class="fa fa-check"></i><b>14</b> Baseball</a></li>
<li class="chapter" data-level="15" data-path="football-1.html"><a href="football-1.html"><i class="fa fa-check"></i><b>15</b> Football</a></li>
<li class="chapter" data-level="16" data-path="basketball-1.html"><a href="basketball-1.html"><i class="fa fa-check"></i><b>16</b> Basketball</a></li>
<li class="chapter" data-level="17" data-path="hockey-1.html"><a href="hockey-1.html"><i class="fa fa-check"></i><b>17</b> Hockey</a></li>
<li class="chapter" data-level="18" data-path="soccer-1.html"><a href="soccer-1.html"><i class="fa fa-check"></i><b>18</b> Soccer</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Sports Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Linear Regression<a href="linear-regression.html#linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Linear regression is a statistical method for modeling a quantitative variable as a function of one or more quantitative variables. This method determines a “line of best fit” by minimizing the sum of squared errors.</p>
<div class="definition">
<p><span id="def:unlabeled-div-206" class="definition"><strong>Definition 8.1  </strong></span>A <strong><em>simple linear regression model</em></strong>, <span class="math inline">\(\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x\)</span>, between a dependent variable <span class="math inline">\(y\)</span> and an independent variable <span class="math inline">\(x\)</span> is found by minimizing <span class="math inline">\(SSE=\sum(y_i-\hat{\beta}_0-\hat{\beta}_1x)^2\)</span>, where:<br />
</p>
<p><span class="math inline">\(\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}\)</span> <span class="math inline">\(\hat{\beta}_1 = \frac{\sum(x_i-\bar{x})(y_i-\bar{y})}{\sum(x_i-\bar{x})^2}\)</span><br />
</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-207" class="definition"><strong>Definition 8.2  </strong></span>A <strong><em>multiple linear regression model</em></strong>, <span class="math inline">\(\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \ldots \hat{\beta}_p x_p\)</span>, between a dependent variable <span class="math inline">\(y\)</span> and an independent variables <span class="math inline">\(x_1, x_2, \ldots, x_p\)</span> is found by minimizing <span class="math inline">\(SSE=\sum(y_i-\hat{\beta}_0-\hat{\beta}_1x_1-\hat{\beta}_2x_2- \ldots - -\hat{\beta}_px_p)^2\)</span><br />
</p>
</div>
<p>We make a few assumptions when we fit these regression models:</p>
<ol style="list-style-type: decimal">
<li>The response variable can be modeled as a linear combination of the predictor variables (linearity in the parameters).<br />
</li>
<li>The errors are independent normal random variables.<br />
</li>
<li>We seek to minimize the sum of squared errors, SSE.</li>
</ol>
<div style="page-break-after: always;"></div>
<div id="simple-linear-regression" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Simple Linear Regression<a href="linear-regression.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="example">
<p><span id="exm:unlabeled-div-208" class="example"><strong>Example 8.1  </strong></span>Download individual MLB pitching statistics for the 2021 and 2022 seasons. Use these datasets to build simple linear regression models with 2022 season ERA as the dependent variable and 2021 season ERA and FIP as the independent variables.</p>
</div>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="linear-regression.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download individual pitching data for 2021 and 2022 seasons</span></span>
<span id="cb472-2"><a href="linear-regression.html#cb472-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb472-3"><a href="linear-regression.html#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baseballr)</span>
<span id="cb472-4"><a href="linear-regression.html#cb472-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-5"><a href="linear-regression.html#cb472-5" aria-hidden="true" tabindex="-1"></a>pit21 <span class="ot">&lt;-</span> <span class="fu">bref_daily_pitcher</span>(<span class="st">&quot;2021-01-01&quot;</span>, <span class="st">&quot;2021-12-31&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb472-6"><a href="linear-regression.html#cb472-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fip_plus</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb472-7"><a href="linear-regression.html#cb472-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Name, IP, ERA, FIP) <span class="sc">%&gt;%</span></span>
<span id="cb472-8"><a href="linear-regression.html#cb472-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(IP)) <span class="sc">%&gt;%</span></span>
<span id="cb472-9"><a href="linear-regression.html#cb472-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IP21=</span>IP,<span class="at">ERA21=</span>ERA,<span class="at">FIP21=</span>FIP)</span>
<span id="cb472-10"><a href="linear-regression.html#cb472-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-11"><a href="linear-regression.html#cb472-11" aria-hidden="true" tabindex="-1"></a>pit22 <span class="ot">&lt;-</span> <span class="fu">bref_daily_pitcher</span>(<span class="st">&quot;2022-01-01&quot;</span>, <span class="st">&quot;2022-12-31&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb472-12"><a href="linear-regression.html#cb472-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fip_plus</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb472-13"><a href="linear-regression.html#cb472-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Name, IP, ERA, FIP) <span class="sc">%&gt;%</span></span>
<span id="cb472-14"><a href="linear-regression.html#cb472-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(IP)) <span class="sc">%&gt;%</span></span>
<span id="cb472-15"><a href="linear-regression.html#cb472-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IP22=</span>IP,<span class="at">ERA22=</span>ERA,<span class="at">FIP22=</span>FIP)</span>
<span id="cb472-16"><a href="linear-regression.html#cb472-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-17"><a href="linear-regression.html#cb472-17" aria-hidden="true" tabindex="-1"></a><span class="co"># merge the datasets together, remove redundant columns</span></span>
<span id="cb472-18"><a href="linear-regression.html#cb472-18" aria-hidden="true" tabindex="-1"></a>all_pit <span class="ot">&lt;-</span> pit21 <span class="sc">%&gt;%</span> </span>
<span id="cb472-19"><a href="linear-regression.html#cb472-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pit22,<span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb472-20"><a href="linear-regression.html#cb472-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb472-21"><a href="linear-regression.html#cb472-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(IP21<span class="sc">&gt;</span><span class="dv">5</span> <span class="sc">&amp;</span> IP22 <span class="sc">&gt;</span> <span class="dv">5</span>)</span>
<span id="cb472-22"><a href="linear-regression.html#cb472-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-23"><a href="linear-regression.html#cb472-23" aria-hidden="true" tabindex="-1"></a>all_pit <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">booktabs=</span>T)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:right;">
IP21
</th>
<th style="text-align:right;">
ERA21
</th>
<th style="text-align:right;">
FIP21
</th>
<th style="text-align:right;">
IP22
</th>
<th style="text-align:right;">
ERA22
</th>
<th style="text-align:right;">
FIP22
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Zack Wheeler
</td>
<td style="text-align:right;">
213.1
</td>
<td style="text-align:right;">
2.78
</td>
<td style="text-align:right;">
2.57
</td>
<td style="text-align:right;">
153.0
</td>
<td style="text-align:right;">
2.82
</td>
<td style="text-align:right;">
2.87
</td>
</tr>
<tr>
<td style="text-align:left;">
Walker Buehler
</td>
<td style="text-align:right;">
207.2
</td>
<td style="text-align:right;">
2.47
</td>
<td style="text-align:right;">
3.13
</td>
<td style="text-align:right;">
65.0
</td>
<td style="text-align:right;">
4.02
</td>
<td style="text-align:right;">
3.80
</td>
</tr>
<tr>
<td style="text-align:left;">
Adam Wainwright
</td>
<td style="text-align:right;">
206.1
</td>
<td style="text-align:right;">
3.05
</td>
<td style="text-align:right;">
3.62
</td>
<td style="text-align:right;">
191.2
</td>
<td style="text-align:right;">
3.71
</td>
<td style="text-align:right;">
3.65
</td>
</tr>
<tr>
<td style="text-align:left;">
Sandy Alcantara
</td>
<td style="text-align:right;">
205.2
</td>
<td style="text-align:right;">
3.19
</td>
<td style="text-align:right;">
3.39
</td>
<td style="text-align:right;">
228.2
</td>
<td style="text-align:right;">
2.28
</td>
<td style="text-align:right;">
2.97
</td>
</tr>
<tr>
<td style="text-align:left;">
Robbie Ray
</td>
<td style="text-align:right;">
193.1
</td>
<td style="text-align:right;">
2.84
</td>
<td style="text-align:right;">
3.69
</td>
<td style="text-align:right;">
189.0
</td>
<td style="text-align:right;">
3.71
</td>
<td style="text-align:right;">
4.16
</td>
</tr>
<tr>
<td style="text-align:left;">
José Berríos
</td>
<td style="text-align:right;">
192.0
</td>
<td style="text-align:right;">
3.52
</td>
<td style="text-align:right;">
3.47
</td>
<td style="text-align:right;">
172.0
</td>
<td style="text-align:right;">
5.23
</td>
<td style="text-align:right;">
4.55
</td>
</tr>
<tr>
<td style="text-align:left;">
Kevin Gausman
</td>
<td style="text-align:right;">
192.0
</td>
<td style="text-align:right;">
2.81
</td>
<td style="text-align:right;">
2.99
</td>
<td style="text-align:right;">
174.2
</td>
<td style="text-align:right;">
3.35
</td>
<td style="text-align:right;">
2.38
</td>
</tr>
<tr>
<td style="text-align:left;">
Luis Castillo
</td>
<td style="text-align:right;">
187.2
</td>
<td style="text-align:right;">
3.98
</td>
<td style="text-align:right;">
3.69
</td>
<td style="text-align:right;">
150.1
</td>
<td style="text-align:right;">
2.99
</td>
<td style="text-align:right;">
3.07
</td>
</tr>
<tr>
<td style="text-align:left;">
Frankie Montas
</td>
<td style="text-align:right;">
187.0
</td>
<td style="text-align:right;">
3.37
</td>
<td style="text-align:right;">
3.36
</td>
<td style="text-align:right;">
144.1
</td>
<td style="text-align:right;">
4.05
</td>
<td style="text-align:right;">
3.72
</td>
</tr>
<tr>
<td style="text-align:left;">
Julio Urías
</td>
<td style="text-align:right;">
185.2
</td>
<td style="text-align:right;">
2.96
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
175.0
</td>
<td style="text-align:right;">
2.16
</td>
<td style="text-align:right;">
3.71
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="linear-regression.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at correlation between pitching stats in 2021 and 2022</span></span>
<span id="cb473-2"><a href="linear-regression.html#cb473-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb473-3"><a href="linear-regression.html#cb473-3" aria-hidden="true" tabindex="-1"></a>all_pit <span class="sc">%&gt;%</span> <span class="fu">select</span>(ERA21,ERA22,FIP21,FIP22) <span class="sc">%&gt;%</span> <span class="fu">ggpairs</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-217-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="linear-regression.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build scatterplots of ERA22 vs ERA21 and ERA22 vs FIP21</span></span>
<span id="cb474-2"><a href="linear-regression.html#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb474-3"><a href="linear-regression.html#cb474-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> all_pit <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>ERA21,<span class="at">y=</span>ERA22)) <span class="sc">+</span></span>
<span id="cb474-4"><a href="linear-regression.html#cb474-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb474-5"><a href="linear-regression.html#cb474-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb474-6"><a href="linear-regression.html#cb474-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb474-7"><a href="linear-regression.html#cb474-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb474-8"><a href="linear-regression.html#cb474-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-9"><a href="linear-regression.html#cb474-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> all_pit <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>FIP21,<span class="at">y=</span>ERA22)) <span class="sc">+</span></span>
<span id="cb474-10"><a href="linear-regression.html#cb474-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb474-11"><a href="linear-regression.html#cb474-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb474-12"><a href="linear-regression.html#cb474-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb474-13"><a href="linear-regression.html#cb474-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb474-14"><a href="linear-regression.html#cb474-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1,p2,<span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="linear-regression.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build SLR model 1: ERA22 ~ ERA21</span></span>
<span id="cb475-2"><a href="linear-regression.html#cb475-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ERA22<span class="sc">~</span>ERA21,<span class="at">data=</span>all_pit)</span>
<span id="cb475-3"><a href="linear-regression.html#cb475-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-4"><a href="linear-regression.html#cb475-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sloppy output</span></span>
<span id="cb475-5"><a href="linear-regression.html#cb475-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ERA22 ~ ERA21, data = all_pit)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.4503 -1.1708 -0.3321  0.8072 19.4281 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.72994    0.23077  16.163  &lt; 2e-16 ***
## ERA21        0.12896    0.04878   2.644  0.00845 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.106 on 517 degrees of freedom
## Multiple R-squared:  0.01334,    Adjusted R-squared:  0.01143 
## F-statistic: 6.989 on 1 and 517 DF,  p-value: 0.008449</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="linear-regression.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb477-2"><a href="linear-regression.html#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="co"># format the output nicely in a kable table</span></span>
<span id="cb477-3"><a href="linear-regression.html#cb477-3" aria-hidden="true" tabindex="-1"></a>model1 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb477-4"><a href="linear-regression.html#cb477-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb477-5"><a href="linear-regression.html#cb477-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value),</span>
<span id="cb477-6"><a href="linear-regression.html#cb477-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;ERA21&quot;</span>)</span>
<span id="cb477-7"><a href="linear-regression.html#cb477-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb477-8"><a href="linear-regression.html#cb477-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb477-9"><a href="linear-regression.html#cb477-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;SLR Model Estimating ERA22 Using ERA21&quot;</span>,</span>
<span id="cb477-10"><a href="linear-regression.html#cb477-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb477-11"><a href="linear-regression.html#cb477-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-220">Table 8.1: </span>SLR Model Estimating ERA22 Using ERA21
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
3.730
</td>
<td style="text-align:right;">
0.231
</td>
<td style="text-align:right;">
16.163
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
ERA21
</td>
<td style="text-align:right;">
0.129
</td>
<td style="text-align:right;">
0.049
</td>
<td style="text-align:right;">
2.644
</td>
<td style="text-align:left;">
0.008
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="linear-regression.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build SLR model 2: ERA22 ~ FIP21</span></span>
<span id="cb478-2"><a href="linear-regression.html#cb478-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ERA22<span class="sc">~</span>FIP21,<span class="at">data=</span>all_pit)</span>
<span id="cb478-3"><a href="linear-regression.html#cb478-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-4"><a href="linear-regression.html#cb478-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Nicely output regression information</span></span>
<span id="cb478-5"><a href="linear-regression.html#cb478-5" aria-hidden="true" tabindex="-1"></a>model2 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb478-6"><a href="linear-regression.html#cb478-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb478-7"><a href="linear-regression.html#cb478-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value),</span>
<span id="cb478-8"><a href="linear-regression.html#cb478-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;FIP21&quot;</span>)</span>
<span id="cb478-9"><a href="linear-regression.html#cb478-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb478-10"><a href="linear-regression.html#cb478-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb478-11"><a href="linear-regression.html#cb478-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;SLR Model Estimating ERA22 Using FIP21&quot;</span>,</span>
<span id="cb478-12"><a href="linear-regression.html#cb478-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb478-13"><a href="linear-regression.html#cb478-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-221">Table 8.2: </span>SLR Model Estimating ERA22 Using FIP21
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
3.273
</td>
<td style="text-align:right;">
0.295
</td>
<td style="text-align:right;">
11.097
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
FIP21
</td>
<td style="text-align:right;">
0.238
</td>
<td style="text-align:right;">
0.066
</td>
<td style="text-align:right;">
3.626
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="linear-regression.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build MR model: ERA22 ~ ERA21 + FIP21</span></span>
<span id="cb479-2"><a href="linear-regression.html#cb479-2" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ERA22<span class="sc">~</span>ERA21<span class="sc">+</span>FIP21,<span class="at">data=</span>all_pit)</span>
<span id="cb479-3"><a href="linear-regression.html#cb479-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-4"><a href="linear-regression.html#cb479-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Nicely output regression information</span></span>
<span id="cb479-5"><a href="linear-regression.html#cb479-5" aria-hidden="true" tabindex="-1"></a>model3 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb479-6"><a href="linear-regression.html#cb479-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb479-7"><a href="linear-regression.html#cb479-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value),</span>
<span id="cb479-8"><a href="linear-regression.html#cb479-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;ERA21&quot;</span>,<span class="st">&quot;FIP21&quot;</span>)</span>
<span id="cb479-9"><a href="linear-regression.html#cb479-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb479-10"><a href="linear-regression.html#cb479-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb479-11"><a href="linear-regression.html#cb479-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;SLR Model Estimating ERA22 Using FIP21&quot;</span>,</span>
<span id="cb479-12"><a href="linear-regression.html#cb479-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb479-13"><a href="linear-regression.html#cb479-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-222">Table 8.3: </span>SLR Model Estimating ERA22 Using FIP21
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
3.272
</td>
<td style="text-align:right;">
0.295
</td>
<td style="text-align:right;">
11.080
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
ERA21
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.071
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:left;">
0.977
</td>
</tr>
<tr>
<td style="text-align:left;">
FIP21
</td>
<td style="text-align:right;">
0.236
</td>
<td style="text-align:right;">
0.096
</td>
<td style="text-align:right;">
2.463
</td>
<td style="text-align:left;">
0.014
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="example">
<p><span id="exm:unlabeled-div-209" class="example"><strong>Example 8.2  </strong></span>Our goal is to investigate the relationship between MLB team OPS and runs per game.</p>
</div>
<ol style="list-style-type: lower-alpha">
<li>Download MLB team offensive statistics for the 2022 season using <code>rvest</code>.</li>
</ol>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="linear-regression.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scrape the data and output as a kable table</span></span>
<span id="cb480-2"><a href="linear-regression.html#cb480-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb480-3"><a href="linear-regression.html#cb480-3" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.baseball-reference.com/leagues/majors/2022.shtml&quot;</span></span>
<span id="cb480-4"><a href="linear-regression.html#cb480-4" aria-hidden="true" tabindex="-1"></a>site <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb480-5"><a href="linear-regression.html#cb480-5" aria-hidden="true" tabindex="-1"></a>mlb22 <span class="ot">&lt;-</span> site <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="st">&quot;#teams_standard_batting&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_table</span>()</span>
<span id="cb480-6"><a href="linear-regression.html#cb480-6" aria-hidden="true" tabindex="-1"></a>mlb22 <span class="ot">&lt;-</span> mlb22 <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">&quot;Tm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb480-7"><a href="linear-regression.html#cb480-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">R/G</span><span class="st">`</span><span class="ot">=</span>R.G) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="sc">-</span>(<span class="dv">31</span><span class="sc">:</span><span class="dv">33</span>))</span>
<span id="cb480-8"><a href="linear-regression.html#cb480-8" aria-hidden="true" tabindex="-1"></a>mlb22 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">booktabs=</span>T)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
X.Bat
</th>
<th style="text-align:left;">
BatAge
</th>
<th style="text-align:left;">
R/G
</th>
<th style="text-align:left;">
G
</th>
<th style="text-align:left;">
PA
</th>
<th style="text-align:left;">
AB
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
H
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Arizona Diamondbacks
</td>
<td style="text-align:left;">
57
</td>
<td style="text-align:left;">
26.5
</td>
<td style="text-align:left;">
4.33
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6027
</td>
<td style="text-align:left;">
5351
</td>
<td style="text-align:left;">
702
</td>
<td style="text-align:left;">
1232
</td>
</tr>
<tr>
<td style="text-align:left;">
Atlanta Braves
</td>
<td style="text-align:left;">
53
</td>
<td style="text-align:left;">
27.5
</td>
<td style="text-align:left;">
4.87
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6082
</td>
<td style="text-align:left;">
5509
</td>
<td style="text-align:left;">
789
</td>
<td style="text-align:left;">
1394
</td>
</tr>
<tr>
<td style="text-align:left;">
Baltimore Orioles
</td>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
27.0
</td>
<td style="text-align:left;">
4.16
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6049
</td>
<td style="text-align:left;">
5429
</td>
<td style="text-align:left;">
674
</td>
<td style="text-align:left;">
1281
</td>
</tr>
<tr>
<td style="text-align:left;">
Boston Red Sox
</td>
<td style="text-align:left;">
54
</td>
<td style="text-align:left;">
28.8
</td>
<td style="text-align:left;">
4.54
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6144
</td>
<td style="text-align:left;">
5539
</td>
<td style="text-align:left;">
735
</td>
<td style="text-align:left;">
1427
</td>
</tr>
<tr>
<td style="text-align:left;">
Chicago Cubs
</td>
<td style="text-align:left;">
64
</td>
<td style="text-align:left;">
27.9
</td>
<td style="text-align:left;">
4.06
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6072
</td>
<td style="text-align:left;">
5425
</td>
<td style="text-align:left;">
657
</td>
<td style="text-align:left;">
1293
</td>
</tr>
<tr>
<td style="text-align:left;">
Chicago White Sox
</td>
<td style="text-align:left;">
44
</td>
<td style="text-align:left;">
29.3
</td>
<td style="text-align:left;">
4.23
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6123
</td>
<td style="text-align:left;">
5611
</td>
<td style="text-align:left;">
686
</td>
<td style="text-align:left;">
1435
</td>
</tr>
<tr>
<td style="text-align:left;">
Cincinnati Reds
</td>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
29.4
</td>
<td style="text-align:left;">
4.00
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
5978
</td>
<td style="text-align:left;">
5380
</td>
<td style="text-align:left;">
648
</td>
<td style="text-align:left;">
1264
</td>
</tr>
<tr>
<td style="text-align:left;">
Cleveland Guardians
</td>
<td style="text-align:left;">
50
</td>
<td style="text-align:left;">
25.9
</td>
<td style="text-align:left;">
4.31
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6163
</td>
<td style="text-align:left;">
5558
</td>
<td style="text-align:left;">
698
</td>
<td style="text-align:left;">
1410
</td>
</tr>
<tr>
<td style="text-align:left;">
Colorado Rockies
</td>
<td style="text-align:left;">
43
</td>
<td style="text-align:left;">
29.1
</td>
<td style="text-align:left;">
4.31
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6105
</td>
<td style="text-align:left;">
5540
</td>
<td style="text-align:left;">
698
</td>
<td style="text-align:left;">
1408
</td>
</tr>
<tr>
<td style="text-align:left;">
Detroit Tigers
</td>
<td style="text-align:left;">
53
</td>
<td style="text-align:left;">
27.9
</td>
<td style="text-align:left;">
3.44
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
5870
</td>
<td style="text-align:left;">
5378
</td>
<td style="text-align:left;">
557
</td>
<td style="text-align:left;">
1240
</td>
</tr>
<tr>
<td style="text-align:left;">
Houston Astros
</td>
<td style="text-align:left;">
45
</td>
<td style="text-align:left;">
29.3
</td>
<td style="text-align:left;">
4.55
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6054
</td>
<td style="text-align:left;">
5409
</td>
<td style="text-align:left;">
737
</td>
<td style="text-align:left;">
1341
</td>
</tr>
<tr>
<td style="text-align:left;">
Kansas City Royals
</td>
<td style="text-align:left;">
55
</td>
<td style="text-align:left;">
27.1
</td>
<td style="text-align:left;">
3.95
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6010
</td>
<td style="text-align:left;">
5437
</td>
<td style="text-align:left;">
640
</td>
<td style="text-align:left;">
1327
</td>
</tr>
<tr>
<td style="text-align:left;">
Los Angeles Angels
</td>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
27.9
</td>
<td style="text-align:left;">
3.85
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
5977
</td>
<td style="text-align:left;">
5423
</td>
<td style="text-align:left;">
623
</td>
<td style="text-align:left;">
1265
</td>
</tr>
<tr>
<td style="text-align:left;">
Los Angeles Dodgers
</td>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
29.6
</td>
<td style="text-align:left;">
5.23
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6247
</td>
<td style="text-align:left;">
5526
</td>
<td style="text-align:left;">
847
</td>
<td style="text-align:left;">
1418
</td>
</tr>
<tr>
<td style="text-align:left;">
Miami Marlins
</td>
<td style="text-align:left;">
56
</td>
<td style="text-align:left;">
28.8
</td>
<td style="text-align:left;">
3.62
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
5949
</td>
<td style="text-align:left;">
5395
</td>
<td style="text-align:left;">
586
</td>
<td style="text-align:left;">
1241
</td>
</tr>
<tr>
<td style="text-align:left;">
Milwaukee Brewers
</td>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
29.1
</td>
<td style="text-align:left;">
4.48
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6122
</td>
<td style="text-align:left;">
5417
</td>
<td style="text-align:left;">
725
</td>
<td style="text-align:left;">
1271
</td>
</tr>
<tr>
<td style="text-align:left;">
Minnesota Twins
</td>
<td style="text-align:left;">
61
</td>
<td style="text-align:left;">
26.9
</td>
<td style="text-align:left;">
4.30
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6113
</td>
<td style="text-align:left;">
5476
</td>
<td style="text-align:left;">
696
</td>
<td style="text-align:left;">
1356
</td>
</tr>
<tr>
<td style="text-align:left;">
New York Mets
</td>
<td style="text-align:left;">
61
</td>
<td style="text-align:left;">
29.7
</td>
<td style="text-align:left;">
4.77
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6176
</td>
<td style="text-align:left;">
5489
</td>
<td style="text-align:left;">
772
</td>
<td style="text-align:left;">
1422
</td>
</tr>
<tr>
<td style="text-align:left;">
New York Yankees
</td>
<td style="text-align:left;">
54
</td>
<td style="text-align:left;">
30.2
</td>
<td style="text-align:left;">
4.98
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6172
</td>
<td style="text-align:left;">
5422
</td>
<td style="text-align:left;">
807
</td>
<td style="text-align:left;">
1308
</td>
</tr>
<tr>
<td style="text-align:left;">
Oakland Athletics
</td>
<td style="text-align:left;">
64
</td>
<td style="text-align:left;">
28.3
</td>
<td style="text-align:left;">
3.51
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
5863
</td>
<td style="text-align:left;">
5314
</td>
<td style="text-align:left;">
568
</td>
<td style="text-align:left;">
1147
</td>
</tr>
<tr>
<td style="text-align:left;">
Philadelphia Phillies
</td>
<td style="text-align:left;">
56
</td>
<td style="text-align:left;">
28.1
</td>
<td style="text-align:left;">
4.61
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6077
</td>
<td style="text-align:left;">
5496
</td>
<td style="text-align:left;">
747
</td>
<td style="text-align:left;">
1392
</td>
</tr>
<tr>
<td style="text-align:left;">
Pittsburgh Pirates
</td>
<td style="text-align:left;">
68
</td>
<td style="text-align:left;">
26.3
</td>
<td style="text-align:left;">
3.65
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
5912
</td>
<td style="text-align:left;">
5331
</td>
<td style="text-align:left;">
591
</td>
<td style="text-align:left;">
1186
</td>
</tr>
<tr>
<td style="text-align:left;">
San Diego Padres
</td>
<td style="text-align:left;">
55
</td>
<td style="text-align:left;">
28.2
</td>
<td style="text-align:left;">
4.35
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6175
</td>
<td style="text-align:left;">
5468
</td>
<td style="text-align:left;">
705
</td>
<td style="text-align:left;">
1317
</td>
</tr>
<tr>
<td style="text-align:left;">
Seattle Mariners
</td>
<td style="text-align:left;">
59
</td>
<td style="text-align:left;">
27.5
</td>
<td style="text-align:left;">
4.26
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6117
</td>
<td style="text-align:left;">
5375
</td>
<td style="text-align:left;">
690
</td>
<td style="text-align:left;">
1236
</td>
</tr>
<tr>
<td style="text-align:left;">
San Francisco Giants
</td>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
30.0
</td>
<td style="text-align:left;">
4.42
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6117
</td>
<td style="text-align:left;">
5392
</td>
<td style="text-align:left;">
716
</td>
<td style="text-align:left;">
1261
</td>
</tr>
<tr>
<td style="text-align:left;">
St. Louis Cardinals
</td>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
28.8
</td>
<td style="text-align:left;">
4.77
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6165
</td>
<td style="text-align:left;">
5496
</td>
<td style="text-align:left;">
772
</td>
<td style="text-align:left;">
1386
</td>
</tr>
<tr>
<td style="text-align:left;">
Tampa Bay Rays
</td>
<td style="text-align:left;">
61
</td>
<td style="text-align:left;">
27.0
</td>
<td style="text-align:left;">
4.11
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6008
</td>
<td style="text-align:left;">
5412
</td>
<td style="text-align:left;">
666
</td>
<td style="text-align:left;">
1294
</td>
</tr>
<tr>
<td style="text-align:left;">
Texas Rangers
</td>
<td style="text-align:left;">
55
</td>
<td style="text-align:left;">
28.0
</td>
<td style="text-align:left;">
4.36
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6029
</td>
<td style="text-align:left;">
5478
</td>
<td style="text-align:left;">
707
</td>
<td style="text-align:left;">
1308
</td>
</tr>
<tr>
<td style="text-align:left;">
Toronto Blue Jays
</td>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
27.1
</td>
<td style="text-align:left;">
4.78
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6158
</td>
<td style="text-align:left;">
5555
</td>
<td style="text-align:left;">
775
</td>
<td style="text-align:left;">
1464
</td>
</tr>
<tr>
<td style="text-align:left;">
Washington Nationals
</td>
<td style="text-align:left;">
55
</td>
<td style="text-align:left;">
28.7
</td>
<td style="text-align:left;">
3.72
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
5998
</td>
<td style="text-align:left;">
5434
</td>
<td style="text-align:left;">
603
</td>
<td style="text-align:left;">
1351
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Examine the correlation structure between R/G, BA, OBP, SLG, and OPS.</li>
</ol>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="linear-regression.html#cb481-1" aria-hidden="true" tabindex="-1"></a>mlb22_off <span class="ot">&lt;-</span> mlb22 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">R/G</span><span class="st">`</span>,BA,OBP,SLG,OPS) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(as.numeric)</span>
<span id="cb481-2"><a href="linear-regression.html#cb481-2" aria-hidden="true" tabindex="-1"></a>mlb22_off <span class="sc">%&gt;%</span> <span class="fu">ggpairs</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Build a SLR model between runs scored and OPS.</li>
</ol>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="linear-regression.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build SLR model: R/G ~ OPS</span></span>
<span id="cb482-2"><a href="linear-regression.html#cb482-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(R.G<span class="sc">~</span>OPS,<span class="at">data=</span>mlb22_off)</span>
<span id="cb482-3"><a href="linear-regression.html#cb482-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb482-4"><a href="linear-regression.html#cb482-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Nicely output regression information</span></span>
<span id="cb482-5"><a href="linear-regression.html#cb482-5" aria-hidden="true" tabindex="-1"></a>model1 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb482-6"><a href="linear-regression.html#cb482-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb482-7"><a href="linear-regression.html#cb482-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value),</span>
<span id="cb482-8"><a href="linear-regression.html#cb482-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;OPS&quot;</span>)</span>
<span id="cb482-9"><a href="linear-regression.html#cb482-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb482-10"><a href="linear-regression.html#cb482-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb482-11"><a href="linear-regression.html#cb482-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;SLR Model Estimating Runs Per Game Using Team OPS&quot;</span>,</span>
<span id="cb482-12"><a href="linear-regression.html#cb482-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb482-13"><a href="linear-regression.html#cb482-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-225">Table 8.4: </span>SLR Model Estimating Runs Per Game Using Team OPS
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
-3.842
</td>
<td style="text-align:right;">
0.485
</td>
<td style="text-align:right;">
-7.919
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
OPS
</td>
<td style="text-align:right;">
11.509
</td>
<td style="text-align:right;">
0.686
</td>
<td style="text-align:right;">
16.771
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Plot a scatterplot of R/G and OPS along with the SLR line of best fit and confidence intervals.</li>
</ol>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="linear-regression.html#cb483-1" aria-hidden="true" tabindex="-1"></a>mlb22_off <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>OPS,<span class="at">y=</span>R.G)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb483-2"><a href="linear-regression.html#cb483-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm , <span class="at">fill=</span><span class="st">&quot;gray&quot;</span>, <span class="at">color=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">se=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb483-3"><a href="linear-regression.html#cb483-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Runs Per Game vs. OPS&quot;</span>,</span>
<span id="cb483-4"><a href="linear-regression.html#cb483-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;2022 MLB Season | Teams&quot;</span>,</span>
<span id="cb483-5"><a href="linear-regression.html#cb483-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data: Baseball Reference&quot;</span>, </span>
<span id="cb483-6"><a href="linear-regression.html#cb483-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;On-Base Plus Slugging (OPS)&quot;</span>,</span>
<span id="cb483-7"><a href="linear-regression.html#cb483-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Runs Per Game (R/G)&quot;</span>) <span class="sc">+</span></span>
<span id="cb483-8"><a href="linear-regression.html#cb483-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-226-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Use residual analysis to assess the model assumptions in the SLR model.</li>
</ol>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="linear-regression.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with the residuals</span></span>
<span id="cb484-2"><a href="linear-regression.html#cb484-2" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">fitted</span>(model1), <span class="at">y =</span> <span class="fu">residuals</span>(model1))</span>
<span id="cb484-3"><a href="linear-regression.html#cb484-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb484-4"><a href="linear-regression.html#cb484-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a residual plot using ggplot2</span></span>
<span id="cb484-5"><a href="linear-regression.html#cb484-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residuals, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb484-6"><a href="linear-regression.html#cb484-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb484-7"><a href="linear-regression.html#cb484-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb484-8"><a href="linear-regression.html#cb484-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Fitted values&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residuals&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Residual plot&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-227-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="linear-regression.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a QQ-plot of the residuals using ggplot2</span></span>
<span id="cb485-2"><a href="linear-regression.html#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residuals, <span class="fu">aes</span>(<span class="at">sample =</span> y)) <span class="sc">+</span></span>
<span id="cb485-3"><a href="linear-regression.html#cb485-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb485-4"><a href="linear-regression.html#cb485-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb485-5"><a href="linear-regression.html#cb485-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Theoretical Quantiles&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Sample Quantiles&quot;</span>, <span class="at">title =</span> <span class="st">&quot;QQ-plot of Residuals&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<ol start="6" style="list-style-type: lower-alpha">
<li>Build a MR model between runs scored and SLG, BA, OBP, and OPS.</li>
</ol>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="linear-regression.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build MR model: R/G ~ OPS + BA + OBP + SLG</span></span>
<span id="cb486-2"><a href="linear-regression.html#cb486-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(R.G<span class="sc">~</span>OPS<span class="sc">+</span>BA<span class="sc">+</span>OBP<span class="sc">+</span>SLG,<span class="at">data=</span>mlb22_off)</span>
<span id="cb486-3"><a href="linear-regression.html#cb486-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-4"><a href="linear-regression.html#cb486-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Nicely output regression information</span></span>
<span id="cb486-5"><a href="linear-regression.html#cb486-5" aria-hidden="true" tabindex="-1"></a>model2 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb486-6"><a href="linear-regression.html#cb486-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb486-7"><a href="linear-regression.html#cb486-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value),</span>
<span id="cb486-8"><a href="linear-regression.html#cb486-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;OPS&quot;</span>,<span class="st">&quot;BA&quot;</span>,<span class="st">&quot;OBP&quot;</span>,<span class="st">&quot;SLG&quot;</span>)</span>
<span id="cb486-9"><a href="linear-regression.html#cb486-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb486-10"><a href="linear-regression.html#cb486-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb486-11"><a href="linear-regression.html#cb486-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;MR Model Estimating Runs Per Game Using Team OPS, BA, OBP, SLG&quot;</span>,</span>
<span id="cb486-12"><a href="linear-regression.html#cb486-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb486-13"><a href="linear-regression.html#cb486-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-229">Table 8.5: </span>MR Model Estimating Runs Per Game Using Team OPS, BA, OBP, SLG
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
-4.054
</td>
<td style="text-align:right;">
0.642
</td>
<td style="text-align:right;">
-6.312
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
OPS
</td>
<td style="text-align:right;">
-49.862
</td>
<td style="text-align:right;">
61.599
</td>
<td style="text-align:right;">
-0.809
</td>
<td style="text-align:left;">
0.426
</td>
</tr>
<tr>
<td style="text-align:left;">
BA
</td>
<td style="text-align:right;">
-4.482
</td>
<td style="text-align:right;">
4.081
</td>
<td style="text-align:right;">
-1.098
</td>
<td style="text-align:left;">
0.283
</td>
</tr>
<tr>
<td style="text-align:left;">
OBP
</td>
<td style="text-align:right;">
66.032
</td>
<td style="text-align:right;">
60.116
</td>
<td style="text-align:right;">
1.098
</td>
<td style="text-align:left;">
0.282
</td>
</tr>
<tr>
<td style="text-align:left;">
SLG
</td>
<td style="text-align:right;">
61.004
</td>
<td style="text-align:right;">
61.762
</td>
<td style="text-align:right;">
0.988
</td>
<td style="text-align:left;">
0.333
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="example">
<p><span id="exm:unlabeled-div-210" class="example"><strong>Example 8.3  </strong></span>Data for the MLB 2022 season including team WAR (wins above replacement) and team wins are contained in <code>mlb_2022_team_war.csv</code>.</p>
</div>
<ol style="list-style-type: lower-alpha">
<li>Output this data as a kable table.</li>
</ol>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="linear-regression.html#cb487-1" aria-hidden="true" tabindex="-1"></a>mlb22_war <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mlb_2022_team_war.csv&quot;</span>)</span>
<span id="cb487-2"><a href="linear-regression.html#cb487-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-3"><a href="linear-regression.html#cb487-3" aria-hidden="true" tabindex="-1"></a>mlb22_war <span class="ot">&lt;-</span> mlb22_war <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Wins=</span><span class="st">`</span><span class="at">Team Wins</span><span class="st">`</span>,<span class="at">WAR=</span><span class="st">`</span><span class="at">Team WAR</span><span class="st">`</span>)</span>
<span id="cb487-4"><a href="linear-regression.html#cb487-4" aria-hidden="true" tabindex="-1"></a>mlb22_war <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">booktabs=</span>T)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Team
</th>
<th style="text-align:right;">
WAR
</th>
<th style="text-align:right;">
Wins
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Los Angeles Dodgers
</td>
<td style="text-align:right;">
61.4
</td>
<td style="text-align:right;">
111
</td>
</tr>
<tr>
<td style="text-align:left;">
New York Yankees
</td>
<td style="text-align:right;">
54.7
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;">
Houston Astros
</td>
<td style="text-align:right;">
54.2
</td>
<td style="text-align:right;">
106
</td>
</tr>
<tr>
<td style="text-align:left;">
Atlanta Braves
</td>
<td style="text-align:right;">
50.3
</td>
<td style="text-align:right;">
101
</td>
</tr>
<tr>
<td style="text-align:left;">
New York Mets
</td>
<td style="text-align:right;">
48.5
</td>
<td style="text-align:right;">
101
</td>
</tr>
<tr>
<td style="text-align:left;">
St. Louis Cardinals
</td>
<td style="text-align:right;">
46.3
</td>
<td style="text-align:right;">
93
</td>
</tr>
<tr>
<td style="text-align:left;">
Toronto Blue Jays
</td>
<td style="text-align:right;">
45.2
</td>
<td style="text-align:right;">
92
</td>
</tr>
<tr>
<td style="text-align:left;">
Philadelphia Phillies
</td>
<td style="text-align:right;">
42.3
</td>
<td style="text-align:right;">
87
</td>
</tr>
<tr>
<td style="text-align:left;">
Cleveland Guardians
</td>
<td style="text-align:right;">
41.2
</td>
<td style="text-align:right;">
92
</td>
</tr>
<tr>
<td style="text-align:left;">
Tampa Bay Rays
</td>
<td style="text-align:right;">
39.6
</td>
<td style="text-align:right;">
86
</td>
</tr>
<tr>
<td style="text-align:left;">
Seattle Mariners
</td>
<td style="text-align:right;">
38.4
</td>
<td style="text-align:right;">
90
</td>
</tr>
<tr>
<td style="text-align:left;">
Baltimore Orioles
</td>
<td style="text-align:right;">
38.3
</td>
<td style="text-align:right;">
83
</td>
</tr>
<tr>
<td style="text-align:left;">
San Diego Padres
</td>
<td style="text-align:right;">
38.3
</td>
<td style="text-align:right;">
89
</td>
</tr>
<tr>
<td style="text-align:left;">
Minnesota Twins
</td>
<td style="text-align:right;">
36.0
</td>
<td style="text-align:right;">
78
</td>
</tr>
<tr>
<td style="text-align:left;">
Milwaukee Brewers
</td>
<td style="text-align:right;">
34.1
</td>
<td style="text-align:right;">
86
</td>
</tr>
<tr>
<td style="text-align:left;">
Chicago Cubs
</td>
<td style="text-align:right;">
31.0
</td>
<td style="text-align:right;">
74
</td>
</tr>
<tr>
<td style="text-align:left;">
Los Angeles Angels
</td>
<td style="text-align:right;">
30.4
</td>
<td style="text-align:right;">
73
</td>
</tr>
<tr>
<td style="text-align:left;">
San Francisco Giants
</td>
<td style="text-align:right;">
29.7
</td>
<td style="text-align:right;">
81
</td>
</tr>
<tr>
<td style="text-align:left;">
Miami Marlins
</td>
<td style="text-align:right;">
29.0
</td>
<td style="text-align:right;">
69
</td>
</tr>
<tr>
<td style="text-align:left;">
Chicago White Sox
</td>
<td style="text-align:right;">
27.9
</td>
<td style="text-align:right;">
81
</td>
</tr>
<tr>
<td style="text-align:left;">
Boston Red Sox
</td>
<td style="text-align:right;">
27.5
</td>
<td style="text-align:right;">
78
</td>
</tr>
<tr>
<td style="text-align:left;">
Texas Rangers
</td>
<td style="text-align:right;">
26.8
</td>
<td style="text-align:right;">
68
</td>
</tr>
<tr>
<td style="text-align:left;">
Arizona Diamondbacks
</td>
<td style="text-align:right;">
26.0
</td>
<td style="text-align:right;">
74
</td>
</tr>
<tr>
<td style="text-align:left;">
Kansas City Royals
</td>
<td style="text-align:right;">
21.6
</td>
<td style="text-align:right;">
65
</td>
</tr>
<tr>
<td style="text-align:left;">
Colorado Rockies
</td>
<td style="text-align:right;">
21.2
</td>
<td style="text-align:right;">
68
</td>
</tr>
<tr>
<td style="text-align:left;">
Cincinnati Reds
</td>
<td style="text-align:right;">
16.3
</td>
<td style="text-align:right;">
62
</td>
</tr>
<tr>
<td style="text-align:left;">
Detroit Tigers
</td>
<td style="text-align:right;">
13.1
</td>
<td style="text-align:right;">
66
</td>
</tr>
<tr>
<td style="text-align:left;">
Washington Nationals
</td>
<td style="text-align:right;">
12.1
</td>
<td style="text-align:right;">
55
</td>
</tr>
<tr>
<td style="text-align:left;">
Pittsburgh Pirates
</td>
<td style="text-align:right;">
10.2
</td>
<td style="text-align:right;">
62
</td>
</tr>
<tr>
<td style="text-align:left;">
Oakland Athletics
</td>
<td style="text-align:right;">
9.1
</td>
<td style="text-align:right;">
60
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Fit a simple linear regression model with team wins as the dependent variable and team WAR as the independent variable.</li>
</ol>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="linear-regression.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build SLR model: Team Wins ~ Team WAR</span></span>
<span id="cb488-2"><a href="linear-regression.html#cb488-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Wins<span class="sc">~</span>WAR,<span class="at">data=</span>mlb22_war)</span>
<span id="cb488-3"><a href="linear-regression.html#cb488-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb488-4"><a href="linear-regression.html#cb488-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Nicely output regression information</span></span>
<span id="cb488-5"><a href="linear-regression.html#cb488-5" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb488-6"><a href="linear-regression.html#cb488-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb488-7"><a href="linear-regression.html#cb488-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value),</span>
<span id="cb488-8"><a href="linear-regression.html#cb488-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Team WAR&quot;</span>)</span>
<span id="cb488-9"><a href="linear-regression.html#cb488-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb488-10"><a href="linear-regression.html#cb488-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb488-11"><a href="linear-regression.html#cb488-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;SLR Model Estimating Team Wins Using Team WAR&quot;</span>,</span>
<span id="cb488-12"><a href="linear-regression.html#cb488-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb488-13"><a href="linear-regression.html#cb488-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-231">Table 8.6: </span>SLR Model Estimating Team Wins Using Team WAR
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
46.896
</td>
<td style="text-align:right;">
1.977
</td>
<td style="text-align:right;">
23.726
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
Team WAR
</td>
<td style="text-align:right;">
1.022
</td>
<td style="text-align:right;">
0.055
</td>
<td style="text-align:right;">
18.630
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Plot a scatterplot along with the line of best fit.</li>
</ol>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="linear-regression.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb489-2"><a href="linear-regression.html#cb489-2" aria-hidden="true" tabindex="-1"></a>mlb22_war <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>WAR,<span class="at">y=</span>Wins)) <span class="sc">+</span></span>
<span id="cb489-3"><a href="linear-regression.html#cb489-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb489-4"><a href="linear-regression.html#cb489-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb489-5"><a href="linear-regression.html#cb489-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_regline_equation</span>(<span class="at">label.x.npc =</span> <span class="fl">0.3</span>,<span class="at">label.y.npc =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb489-6"><a href="linear-regression.html#cb489-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Team Wins vs. Team WAR&quot;</span>,</span>
<span id="cb489-7"><a href="linear-regression.html#cb489-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;2022 MLB Season | Teams&quot;</span>,</span>
<span id="cb489-8"><a href="linear-regression.html#cb489-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data: Baseball Reference&quot;</span>, </span>
<span id="cb489-9"><a href="linear-regression.html#cb489-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Team WAR&quot;</span>,</span>
<span id="cb489-10"><a href="linear-regression.html#cb489-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Team Wins&quot;</span>) <span class="sc">+</span></span>
<span id="cb489-11"><a href="linear-regression.html#cb489-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-232-1.png" width="672" />
</p>
</div>
<div id="residual-analysis" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Residual Analysis<a href="linear-regression.html#residual-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is important to check model assumptions. If assumptions are violated, then our inferences may be flawed.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Complete residual analysis of the SLR model.</li>
</ol>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="linear-regression.html#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with the residuals</span></span>
<span id="cb490-2"><a href="linear-regression.html#cb490-2" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">fitted</span>(model), <span class="at">y =</span> <span class="fu">residuals</span>(model))</span>
<span id="cb490-3"><a href="linear-regression.html#cb490-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-4"><a href="linear-regression.html#cb490-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a residual plot using ggplot2</span></span>
<span id="cb490-5"><a href="linear-regression.html#cb490-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residuals, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb490-6"><a href="linear-regression.html#cb490-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb490-7"><a href="linear-regression.html#cb490-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb490-8"><a href="linear-regression.html#cb490-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Fitted values&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residuals&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Residual plot&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-233-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="linear-regression.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a QQ-plot of the residuals using ggplot2</span></span>
<span id="cb491-2"><a href="linear-regression.html#cb491-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residuals, <span class="fu">aes</span>(<span class="at">sample =</span> y)) <span class="sc">+</span></span>
<span id="cb491-3"><a href="linear-regression.html#cb491-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb491-4"><a href="linear-regression.html#cb491-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb491-5"><a href="linear-regression.html#cb491-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Theoretical Quantiles&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Sample Quantiles&quot;</span>, <span class="at">title =</span> <span class="st">&quot;QQ-plot of Residuals&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-234-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>In 2022, the Colorado Rockies were 68-94 and accumulated a total of 21.2 team wins above replacement (WAR). Estimate the Rockies team wins from their team WAR and compare this to their actual win total.</li>
</ol>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="linear-regression.html#cb492-1" aria-hidden="true" tabindex="-1"></a>mlb22_war <span class="ot">&lt;-</span> mlb22_war <span class="sc">%&gt;%</span></span>
<span id="cb492-2"><a href="linear-regression.html#cb492-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xWins =</span> <span class="fu">predict</span>(model,<span class="fu">data.frame</span>(<span class="at">WAR=</span>mlb22_war<span class="sc">$</span>WAR)))</span>
<span id="cb492-3"><a href="linear-regression.html#cb492-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-4"><a href="linear-regression.html#cb492-4" aria-hidden="true" tabindex="-1"></a>( xWins <span class="ot">&lt;-</span> <span class="fu">predict</span>(model,<span class="fu">data.frame</span>(<span class="at">WAR=</span><span class="fl">21.2</span>)) )</span></code></pre></div>
<pre><code>##        1 
## 68.57095</code></pre>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="linear-regression.html#cb494-1" aria-hidden="true" tabindex="-1"></a>mlb22_war <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Team<span class="sc">==</span><span class="st">&quot;Colorado Rockies&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   Team               WAR  Wins xWins
##   &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Colorado Rockies  21.2    68  68.6</code></pre>
<div style="page-break-after: always;"></div>
</div>
<div id="polynomial-regression" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Polynomial Regression<a href="linear-regression.html#polynomial-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="example">
<p><span id="exm:unlabeled-div-211" class="example"><strong>Example 8.4  </strong></span>Ken Griffey Jr. was a baseball hall of fame outfielder from 1989–2009. For each of his of his career, the number of home runs per 100 at-bats is record. This data is found in <code>griffey_hr.csv</code>. (From )</p>
</div>
<ol style="list-style-type: lower-alpha">
<li>Output this dataset to a kable table.</li>
</ol>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="linear-regression.html#cb496-1" aria-hidden="true" tabindex="-1"></a>griffey <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/griffey_hr.csv&quot;</span>)</span>
<span id="cb496-2"><a href="linear-regression.html#cb496-2" aria-hidden="true" tabindex="-1"></a>griffey <span class="ot">&lt;-</span> griffey <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Year =</span> Year<span class="dv">-1988</span>,<span class="st">`</span><span class="at">HR/100AB</span><span class="st">`</span> <span class="ot">=</span> HR) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Year,<span class="st">`</span><span class="at">HR/100AB</span><span class="st">`</span>)</span>
<span id="cb496-3"><a href="linear-regression.html#cb496-3" aria-hidden="true" tabindex="-1"></a>griffey <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
Year
</th>
<th style="text-align:right;">
HR/100AB
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.52
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.69
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4.01
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4.78
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7.73
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
9.24
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6.54
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8.99
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9.21
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8.85
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
7.92
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
7.69
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
6.04
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
4.06
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
7.83
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
6.67
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
7.13
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
6.31
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
5.68
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
3.67
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
4.91
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Fit a SLR model between HR/AB and Year.</li>
</ol>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="linear-regression.html#cb497-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">HR/100AB</span><span class="st">`</span><span class="sc">~</span>Year,<span class="at">data=</span>griffey)</span>
<span id="cb497-2"><a href="linear-regression.html#cb497-2" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb497-3"><a href="linear-regression.html#cb497-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb497-4"><a href="linear-regression.html#cb497-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value),</span>
<span id="cb497-5"><a href="linear-regression.html#cb497-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Year&quot;</span>)</span>
<span id="cb497-6"><a href="linear-regression.html#cb497-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb497-7"><a href="linear-regression.html#cb497-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb497-8"><a href="linear-regression.html#cb497-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;SLR Model Estimating HR/100AB using Year&quot;</span>,</span>
<span id="cb497-9"><a href="linear-regression.html#cb497-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb497-10"><a href="linear-regression.html#cb497-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-237">Table 8.7: </span>SLR Model Estimating HR/100AB using Year
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
6.342
</td>
<td style="text-align:right;">
0.910
</td>
<td style="text-align:right;">
6.969
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
Year
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.072
</td>
<td style="text-align:right;">
0.077
</td>
<td style="text-align:left;">
0.940
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Plot the SLR model and comment on the model fit.</li>
</ol>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="linear-regression.html#cb498-1" aria-hidden="true" tabindex="-1"></a>griffey <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Year,<span class="at">y=</span><span class="st">`</span><span class="at">HR/100AB</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb498-2"><a href="linear-regression.html#cb498-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb498-3"><a href="linear-regression.html#cb498-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb498-4"><a href="linear-regression.html#cb498-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_regline_equation</span>(<span class="at">label.x.npc =</span> <span class="fl">0.3</span>,<span class="at">label.y.npc =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb498-5"><a href="linear-regression.html#cb498-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Home Runs Per 100 At-Bats vs. Year&quot;</span>,</span>
<span id="cb498-6"><a href="linear-regression.html#cb498-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Ken Griffey Jr.&#39;s Career&quot;</span>,</span>
<span id="cb498-7"><a href="linear-regression.html#cb498-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data: Baseball Reference, Analytic Methods in Sports&quot;</span>, </span>
<span id="cb498-8"><a href="linear-regression.html#cb498-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb498-9"><a href="linear-regression.html#cb498-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Home Runs per 100 AB&quot;</span>) <span class="sc">+</span></span>
<span id="cb498-10"><a href="linear-regression.html#cb498-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-238-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Plot the residuals as a function of fitted values for the SLR model. Is the linearity assumption appropriate?</li>
</ol>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="linear-regression.html#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with the residuals</span></span>
<span id="cb499-2"><a href="linear-regression.html#cb499-2" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">fitted</span>(model), <span class="at">y =</span> <span class="fu">residuals</span>(model))</span>
<span id="cb499-3"><a href="linear-regression.html#cb499-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-4"><a href="linear-regression.html#cb499-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a residual plot using ggplot2</span></span>
<span id="cb499-5"><a href="linear-regression.html#cb499-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residuals, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb499-6"><a href="linear-regression.html#cb499-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb499-7"><a href="linear-regression.html#cb499-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb499-8"><a href="linear-regression.html#cb499-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Fitted values&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residuals&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Residual plot&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Repeat (b)-(c) using a quadratic model.</li>
</ol>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="linear-regression.html#cb500-1" aria-hidden="true" tabindex="-1"></a>model_quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">HR/100AB</span><span class="st">`</span><span class="sc">~</span>Year<span class="sc">+</span><span class="fu">I</span>(Year<span class="sc">^</span><span class="dv">2</span>),<span class="at">data=</span>griffey)</span>
<span id="cb500-2"><a href="linear-regression.html#cb500-2" aria-hidden="true" tabindex="-1"></a>model_quad <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb500-3"><a href="linear-regression.html#cb500-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb500-4"><a href="linear-regression.html#cb500-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value),</span>
<span id="cb500-5"><a href="linear-regression.html#cb500-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Year&quot;</span>,<span class="st">&quot;Year^2&quot;</span>)</span>
<span id="cb500-6"><a href="linear-regression.html#cb500-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb500-7"><a href="linear-regression.html#cb500-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb500-8"><a href="linear-regression.html#cb500-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;SLR Model Estimating Home Runs per 100 At-Bats using Year&quot;</span>,</span>
<span id="cb500-9"><a href="linear-regression.html#cb500-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb500-10"><a href="linear-regression.html#cb500-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-240">Table 8.8: </span>SLR Model Estimating Home Runs per 100 At-Bats using Year
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
2.693
</td>
<td style="text-align:right;">
1.005
</td>
<td style="text-align:right;">
2.680
</td>
<td style="text-align:left;">
0.015
</td>
</tr>
<tr>
<td style="text-align:left;">
Year
</td>
<td style="text-align:right;">
0.957
</td>
<td style="text-align:right;">
0.210
</td>
<td style="text-align:right;">
4.549
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
Year^2
</td>
<td style="text-align:right;">
-0.043
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
-4.657
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="linear-regression.html#cb501-1" aria-hidden="true" tabindex="-1"></a>griffey <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Year,<span class="at">y=</span><span class="st">`</span><span class="at">HR/100AB</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb501-2"><a href="linear-regression.html#cb501-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb501-3"><a href="linear-regression.html#cb501-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb501-4"><a href="linear-regression.html#cb501-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ken Griffey Jr.&#39;s Career&quot;</span>,</span>
<span id="cb501-5"><a href="linear-regression.html#cb501-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Home Runs Per 100 At-Bats vs. Year&quot;</span>,</span>
<span id="cb501-6"><a href="linear-regression.html#cb501-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data: Baseball Reference, Analytic Methods in Sports&quot;</span>, </span>
<span id="cb501-7"><a href="linear-regression.html#cb501-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb501-8"><a href="linear-regression.html#cb501-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Home Runs Per 100 At-Bats&quot;</span>) <span class="sc">+</span></span>
<span id="cb501-9"><a href="linear-regression.html#cb501-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-241-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="variable-transformations" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Variable Transformations<a href="linear-regression.html#variable-transformations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sometimes a variable transformation (either predictor or response) may be necessary to meet our model assumptions.</p>
<div class="example">
<p><span id="exm:unlabeled-div-212" class="example"><strong>Example 8.5  </strong></span>For the 2011-2012 NHL season, data was collected for all forwards that played at least 60 games and average at least 6 minutes per game.</p>
</div>
<ol style="list-style-type: lower-alpha">
<li>Create a kable table with the first ten entries.</li>
</ol>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="linear-regression.html#cb502-1" aria-hidden="true" tabindex="-1"></a>nhl_toi <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/nhl_toi_11-12.csv&quot;</span>)</span>
<span id="cb502-2"><a href="linear-regression.html#cb502-2" aria-hidden="true" tabindex="-1"></a>nhl_toi <span class="ot">&lt;-</span> nhl_toi <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">PPG =</span> P<span class="sc">/</span>GP)</span>
<span id="cb502-3"><a href="linear-regression.html#cb502-3" aria-hidden="true" tabindex="-1"></a>nhl_toi <span class="ot">&lt;-</span> nhl_toi <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">&quot;Name&quot;</span>)</span>
<span id="cb502-4"><a href="linear-regression.html#cb502-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-5"><a href="linear-regression.html#cb502-5" aria-hidden="true" tabindex="-1"></a>nhl_toi <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
GP
</th>
<th style="text-align:right;">
P
</th>
<th style="text-align:right;">
TOI
</th>
<th style="text-align:right;">
PPG
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Daniel Winnik
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
16.700
</td>
<td style="text-align:right;">
0.274
</td>
</tr>
<tr>
<td style="text-align:left;">
Cody Hodgson
</td>
<td style="text-align:right;">
83
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
13.817
</td>
<td style="text-align:right;">
0.494
</td>
</tr>
<tr>
<td style="text-align:left;">
Steven Stamkos
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
22.017
</td>
<td style="text-align:right;">
1.183
</td>
</tr>
<tr>
<td style="text-align:left;">
Ryan Getzlaf
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
21.600
</td>
<td style="text-align:right;">
0.695
</td>
</tr>
<tr>
<td style="text-align:left;">
Eric Staal
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
21.550
</td>
<td style="text-align:right;">
0.854
</td>
</tr>
<tr>
<td style="text-align:left;">
Zach Parise
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
21.483
</td>
<td style="text-align:right;">
0.841
</td>
</tr>
<tr>
<td style="text-align:left;">
Anze Kopitar
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
21.333
</td>
<td style="text-align:right;">
0.927
</td>
</tr>
<tr>
<td style="text-align:left;">
Dany Heatley
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
20.950
</td>
<td style="text-align:right;">
0.646
</td>
</tr>
<tr>
<td style="text-align:left;">
Joe Pavelski
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
20.617
</td>
<td style="text-align:right;">
0.744
</td>
</tr>
<tr>
<td style="text-align:left;">
Jarome Iginla
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
20.600
</td>
<td style="text-align:right;">
0.817
</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: lower-alpha">
<li>Fit a SLR model with Points Per Game (PPG) as the dependent variable and Time on Ice (TOI) as the independent variable.</li>
</ol>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="linear-regression.html#cb503-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(PPG<span class="sc">~</span>TOI,<span class="at">data=</span>nhl_toi)</span>
<span id="cb503-2"><a href="linear-regression.html#cb503-2" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb503-3"><a href="linear-regression.html#cb503-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb503-4"><a href="linear-regression.html#cb503-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value),</span>
<span id="cb503-5"><a href="linear-regression.html#cb503-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;TOI&quot;</span>)</span>
<span id="cb503-6"><a href="linear-regression.html#cb503-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb503-7"><a href="linear-regression.html#cb503-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb503-8"><a href="linear-regression.html#cb503-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;SLR Model Estimating Points Per Game Using Time on Ice&quot;</span>,</span>
<span id="cb503-9"><a href="linear-regression.html#cb503-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb503-10"><a href="linear-regression.html#cb503-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-243">Table 8.9: </span>SLR Model Estimating Points Per Game Using Time on Ice
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
-0.505
</td>
<td style="text-align:right;">
0.037
</td>
<td style="text-align:right;">
-13.503
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
TOI
</td>
<td style="text-align:right;">
0.064
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
27.622
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Plot the SLR model and assess the quality of the model.</li>
</ol>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="linear-regression.html#cb504-1" aria-hidden="true" tabindex="-1"></a>nhl_toi <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>TOI,<span class="at">y=</span>PPG)) <span class="sc">+</span></span>
<span id="cb504-2"><a href="linear-regression.html#cb504-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb504-3"><a href="linear-regression.html#cb504-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb504-4"><a href="linear-regression.html#cb504-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_regline_equation</span>(<span class="at">label.x.npc =</span> <span class="fl">0.3</span>,<span class="at">label.y.npc =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb504-5"><a href="linear-regression.html#cb504-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Points Per Game vs. Time on Ice&quot;</span>,</span>
<span id="cb504-6"><a href="linear-regression.html#cb504-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;NHL Forwards | 2011-2012 Season&quot;</span>,</span>
<span id="cb504-7"><a href="linear-regression.html#cb504-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data: Analytic Methods in Sports&quot;</span>, </span>
<span id="cb504-8"><a href="linear-regression.html#cb504-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Time on Ice (TOI)&quot;</span>,</span>
<span id="cb504-9"><a href="linear-regression.html#cb504-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Points Per Game (PPG)&quot;</span>) <span class="sc">+</span></span>
<span id="cb504-10"><a href="linear-regression.html#cb504-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-244-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Generate a fitted values versus residuals plot and use it to determine the appropriateness of the linearity assumption.</li>
</ol>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="linear-regression.html#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with the residuals</span></span>
<span id="cb505-2"><a href="linear-regression.html#cb505-2" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">fitted</span>(model), <span class="at">y =</span> <span class="fu">residuals</span>(model))</span>
<span id="cb505-3"><a href="linear-regression.html#cb505-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-4"><a href="linear-regression.html#cb505-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a residual plot using ggplot2</span></span>
<span id="cb505-5"><a href="linear-regression.html#cb505-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residuals, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb505-6"><a href="linear-regression.html#cb505-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb505-7"><a href="linear-regression.html#cb505-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb505-8"><a href="linear-regression.html#cb505-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Fitted values&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residuals&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Residual plot&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-245-1.png" width="672" />
</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Log-transform PPG and refit the SLR model.</li>
</ol>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="linear-regression.html#cb506-1" aria-hidden="true" tabindex="-1"></a>nhl_toi <span class="ot">&lt;-</span> nhl_toi <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">logPPG =</span> <span class="fu">log</span>(PPG))</span>
<span id="cb506-2"><a href="linear-regression.html#cb506-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(logPPG<span class="sc">~</span>TOI,<span class="at">data=</span>nhl_toi)</span>
<span id="cb506-3"><a href="linear-regression.html#cb506-3" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb506-4"><a href="linear-regression.html#cb506-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb506-5"><a href="linear-regression.html#cb506-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value),</span>
<span id="cb506-6"><a href="linear-regression.html#cb506-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;TOI&quot;</span>)</span>
<span id="cb506-7"><a href="linear-regression.html#cb506-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb506-8"><a href="linear-regression.html#cb506-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb506-9"><a href="linear-regression.html#cb506-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;SLR Model Estimating Log Points Per Game Using Time on Ice&quot;</span>,</span>
<span id="cb506-10"><a href="linear-regression.html#cb506-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb506-11"><a href="linear-regression.html#cb506-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-246">Table 8.10: </span>SLR Model Estimating Log Points Per Game Using Time on Ice
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
-3.39
</td>
<td style="text-align:right;">
0.089
</td>
<td style="text-align:right;">
-38.157
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
TOI
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
29.191
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<ol start="6" style="list-style-type: lower-alpha">
<li>Plot the log-transformed model. Does the model seem appropriate?</li>
</ol>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="linear-regression.html#cb507-1" aria-hidden="true" tabindex="-1"></a>nhl_toi <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>TOI,<span class="at">y=</span>logPPG)) <span class="sc">+</span></span>
<span id="cb507-2"><a href="linear-regression.html#cb507-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb507-3"><a href="linear-regression.html#cb507-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>,<span class="at">se=</span>F) <span class="sc">+</span> </span>
<span id="cb507-4"><a href="linear-regression.html#cb507-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Log Points Per Game vs. Time on Ice&quot;</span>,</span>
<span id="cb507-5"><a href="linear-regression.html#cb507-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;NHL Forwards | 2011-2012 Season&quot;</span>,</span>
<span id="cb507-6"><a href="linear-regression.html#cb507-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Analytic Methods in Sports&quot;</span>, </span>
<span id="cb507-7"><a href="linear-regression.html#cb507-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Time on Ice (TOI)&quot;</span>,</span>
<span id="cb507-8"><a href="linear-regression.html#cb507-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Points Per Game (logPPG)&quot;</span>) <span class="sc">+</span></span>
<span id="cb507-9"><a href="linear-regression.html#cb507-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic2</span>() <span class="sc">+</span></span>
<span id="cb507-10"><a href="linear-regression.html#cb507-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">&quot;exp&quot;</span>)  <span class="sc">+</span></span>
<span id="cb507-11"><a href="linear-regression.html#cb507-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-247-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<ol start="7" style="list-style-type: lower-alpha">
<li>Generate a fitted values versus residuals plot and use it to determine the appropriateness of the linearity assumption.</li>
</ol>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="linear-regression.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with the residuals</span></span>
<span id="cb508-2"><a href="linear-regression.html#cb508-2" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">fitted</span>(model), <span class="at">y =</span> <span class="fu">residuals</span>(model))</span>
<span id="cb508-3"><a href="linear-regression.html#cb508-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-4"><a href="linear-regression.html#cb508-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a residual plot using ggplot2</span></span>
<span id="cb508-5"><a href="linear-regression.html#cb508-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residuals, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb508-6"><a href="linear-regression.html#cb508-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb508-7"><a href="linear-regression.html#cb508-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb508-8"><a href="linear-regression.html#cb508-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Fitted values&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residuals&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Residual plot&quot;</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-248-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="multiple-regression-and-model-selection" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Multiple Regression and Model Selection<a href="linear-regression.html#multiple-regression-and-model-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose we want to build a multiple regression model with a number of predictor variables. Which predictor variables should we include in our model?</p>
<p>There are many ways to do model selection. We will focus on all</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="linear-regression.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb509-2"><a href="linear-regression.html#cb509-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.baseball-reference.com/leagues/majors/2022.shtml&quot;</span></span>
<span id="cb509-3"><a href="linear-regression.html#cb509-3" aria-hidden="true" tabindex="-1"></a>site <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb509-4"><a href="linear-regression.html#cb509-4" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> site <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="st">&quot;#teams_standard_batting&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_table</span>()</span>
<span id="cb509-5"><a href="linear-regression.html#cb509-5" aria-hidden="true" tabindex="-1"></a>raw_data <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">booktabs=</span>T)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Tm
</th>
<th style="text-align:left;">
X.Bat
</th>
<th style="text-align:left;">
BatAge
</th>
<th style="text-align:left;">
R.G
</th>
<th style="text-align:left;">
G
</th>
<th style="text-align:left;">
PA
</th>
<th style="text-align:left;">
AB
</th>
<th style="text-align:left;">
R
</th>
<th style="text-align:left;">
H
</th>
<th style="text-align:left;">
X2B
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Arizona Diamondbacks
</td>
<td style="text-align:left;">
57
</td>
<td style="text-align:left;">
26.5
</td>
<td style="text-align:left;">
4.33
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6027
</td>
<td style="text-align:left;">
5351
</td>
<td style="text-align:left;">
702
</td>
<td style="text-align:left;">
1232
</td>
<td style="text-align:left;">
262
</td>
</tr>
<tr>
<td style="text-align:left;">
Atlanta Braves
</td>
<td style="text-align:left;">
53
</td>
<td style="text-align:left;">
27.5
</td>
<td style="text-align:left;">
4.87
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6082
</td>
<td style="text-align:left;">
5509
</td>
<td style="text-align:left;">
789
</td>
<td style="text-align:left;">
1394
</td>
<td style="text-align:left;">
298
</td>
</tr>
<tr>
<td style="text-align:left;">
Baltimore Orioles
</td>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
27.0
</td>
<td style="text-align:left;">
4.16
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6049
</td>
<td style="text-align:left;">
5429
</td>
<td style="text-align:left;">
674
</td>
<td style="text-align:left;">
1281
</td>
<td style="text-align:left;">
275
</td>
</tr>
<tr>
<td style="text-align:left;">
Boston Red Sox
</td>
<td style="text-align:left;">
54
</td>
<td style="text-align:left;">
28.8
</td>
<td style="text-align:left;">
4.54
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6144
</td>
<td style="text-align:left;">
5539
</td>
<td style="text-align:left;">
735
</td>
<td style="text-align:left;">
1427
</td>
<td style="text-align:left;">
352
</td>
</tr>
<tr>
<td style="text-align:left;">
Chicago Cubs
</td>
<td style="text-align:left;">
64
</td>
<td style="text-align:left;">
27.9
</td>
<td style="text-align:left;">
4.06
</td>
<td style="text-align:left;">
162
</td>
<td style="text-align:left;">
6072
</td>
<td style="text-align:left;">
5425
</td>
<td style="text-align:left;">
657
</td>
<td style="text-align:left;">
1293
</td>
<td style="text-align:left;">
265
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="linear-regression.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert from character to numeric</span></span>
<span id="cb510-2"><a href="linear-regression.html#cb510-2" aria-hidden="true" tabindex="-1"></a>mlb_2022 <span class="ot">&lt;-</span> raw_data <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.character, as.numeric)</span>
<span id="cb510-3"><a href="linear-regression.html#cb510-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-4"><a href="linear-regression.html#cb510-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove some unnecessary columns</span></span>
<span id="cb510-5"><a href="linear-regression.html#cb510-5" aria-hidden="true" tabindex="-1"></a>mlb_2022 <span class="ot">&lt;-</span> mlb_2022 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Tm,<span class="sc">-</span>X.Bat,<span class="sc">-</span>BatAge,<span class="sc">-</span>G,<span class="sc">-</span>R,<span class="sc">-</span>AB,<span class="sc">-</span>PA,<span class="sc">-</span>OPS.,<span class="sc">-</span>RBI,<span class="sc">-</span>IBB) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb510-6"><a href="linear-regression.html#cb510-6" aria-hidden="true" tabindex="-1"></a>mlb_2022 <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">booktabs=</span>T)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
R.G
</th>
<th style="text-align:right;">
H
</th>
<th style="text-align:right;">
X2B
</th>
<th style="text-align:right;">
X3B
</th>
<th style="text-align:right;">
HR
</th>
<th style="text-align:right;">
SB
</th>
<th style="text-align:right;">
CS
</th>
<th style="text-align:right;">
BB
</th>
<th style="text-align:right;">
SO
</th>
<th style="text-align:right;">
BA
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4.33
</td>
<td style="text-align:right;">
1232
</td>
<td style="text-align:right;">
262
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
173
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
531
</td>
<td style="text-align:right;">
1341
</td>
<td style="text-align:right;">
0.230
</td>
</tr>
<tr>
<td style="text-align:right;">
4.87
</td>
<td style="text-align:right;">
1394
</td>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
243
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
470
</td>
<td style="text-align:right;">
1498
</td>
<td style="text-align:right;">
0.253
</td>
</tr>
<tr>
<td style="text-align:right;">
4.16
</td>
<td style="text-align:right;">
1281
</td>
<td style="text-align:right;">
275
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
171
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
476
</td>
<td style="text-align:right;">
1390
</td>
<td style="text-align:right;">
0.236
</td>
</tr>
<tr>
<td style="text-align:right;">
4.54
</td>
<td style="text-align:right;">
1427
</td>
<td style="text-align:right;">
352
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
155
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
478
</td>
<td style="text-align:right;">
1373
</td>
<td style="text-align:right;">
0.258
</td>
</tr>
<tr>
<td style="text-align:right;">
4.06
</td>
<td style="text-align:right;">
1293
</td>
<td style="text-align:right;">
265
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
159
</td>
<td style="text-align:right;">
111
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
507
</td>
<td style="text-align:right;">
1448
</td>
<td style="text-align:right;">
0.238
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="linear-regression.html#cb511-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(R.G<span class="sc">~</span>.,<span class="at">data=</span>mlb_2022)</span>
<span id="cb511-2"><a href="linear-regression.html#cb511-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb511-3"><a href="linear-regression.html#cb511-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb511-4"><a href="linear-regression.html#cb511-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value)) <span class="sc">%&gt;%</span></span>
<span id="cb511-5"><a href="linear-regression.html#cb511-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb511-6"><a href="linear-regression.html#cb511-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;MR Model Estimating Runs Per Game Using Multiple Variables&quot;</span>,</span>
<span id="cb511-7"><a href="linear-regression.html#cb511-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb511-8"><a href="linear-regression.html#cb511-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-251">Table 8.11: </span>MR Model Estimating Runs Per Game Using Multiple Variables
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.754
</td>
<td style="text-align:right;">
1.519
</td>
<td style="text-align:right;">
0.496
</td>
<td style="text-align:left;">
0.629
</td>
</tr>
<tr>
<td style="text-align:left;">
H
</td>
<td style="text-align:right;">
0.012
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
4.147
</td>
<td style="text-align:left;">
0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
X2B
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
0.436
</td>
<td style="text-align:left;">
0.671
</td>
</tr>
<tr>
<td style="text-align:left;">
X3B
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:right;">
0.260
</td>
<td style="text-align:left;">
0.799
</td>
</tr>
<tr>
<td style="text-align:left;">
HR
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
0.387
</td>
<td style="text-align:left;">
0.706
</td>
</tr>
<tr>
<td style="text-align:left;">
SB
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
-0.281
</td>
<td style="text-align:left;">
0.784
</td>
</tr>
<tr>
<td style="text-align:left;">
CS
</td>
<td style="text-align:right;">
-0.002
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
-0.577
</td>
<td style="text-align:left;">
0.574
</td>
</tr>
<tr>
<td style="text-align:left;">
BB
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.968
</td>
<td style="text-align:left;">
0.352
</td>
</tr>
<tr>
<td style="text-align:left;">
SO
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
-0.303
</td>
<td style="text-align:left;">
0.767
</td>
</tr>
<tr>
<td style="text-align:left;">
BA
</td>
<td style="text-align:right;">
-52.967
</td>
<td style="text-align:right;">
35.927
</td>
<td style="text-align:right;">
-1.474
</td>
<td style="text-align:left;">
0.166
</td>
</tr>
<tr>
<td style="text-align:left;">
OBP
</td>
<td style="text-align:right;">
36.428
</td>
<td style="text-align:right;">
39.670
</td>
<td style="text-align:right;">
0.918
</td>
<td style="text-align:left;">
0.377
</td>
</tr>
<tr>
<td style="text-align:left;">
SLG
</td>
<td style="text-align:right;">
8.699
</td>
<td style="text-align:right;">
51.196
</td>
<td style="text-align:right;">
0.170
</td>
<td style="text-align:left;">
0.868
</td>
</tr>
<tr>
<td style="text-align:left;">
OPS
</td>
<td style="text-align:right;">
-16.641
</td>
<td style="text-align:right;">
35.971
</td>
<td style="text-align:right;">
-0.463
</td>
<td style="text-align:left;">
0.652
</td>
</tr>
<tr>
<td style="text-align:left;">
TB
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
GDP
</td>
<td style="text-align:right;">
-0.004
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
-4.588
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
HBP
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
1.091
</td>
<td style="text-align:left;">
0.297
</td>
</tr>
<tr>
<td style="text-align:left;">
SH
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
1.412
</td>
<td style="text-align:left;">
0.183
</td>
</tr>
<tr>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
3.300
</td>
<td style="text-align:left;">
0.006
</td>
</tr>
<tr>
<td style="text-align:left;">
LOB
</td>
<td style="text-align:right;">
-0.005
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
-7.013
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div id="model-selection-using-bic" class="section level3 hasAnchor" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Model Selection using BIC<a href="linear-regression.html#model-selection-using-bic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="linear-regression.html#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb512-2"><a href="linear-regression.html#cb512-2" aria-hidden="true" tabindex="-1"></a>regsubsets.out <span class="ot">&lt;-</span></span>
<span id="cb512-3"><a href="linear-regression.html#cb512-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">regsubsets</span>(<span class="st">`</span><span class="at">R.G</span><span class="st">`</span><span class="sc">~</span>.,</span>
<span id="cb512-4"><a href="linear-regression.html#cb512-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> mlb_2022,</span>
<span id="cb512-5"><a href="linear-regression.html#cb512-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">nbest =</span> <span class="dv">1</span>,</span>
<span id="cb512-6"><a href="linear-regression.html#cb512-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">nvmax =</span> <span class="dv">10</span>,</span>
<span id="cb512-7"><a href="linear-regression.html#cb512-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">&quot;exhaustive&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in leaps.setup(x, y, wt = wt, nbest = nbest, nvmax = nvmax, force.in =
## force.in, : 1 linear dependencies found</code></pre>
<pre><code>## Reordering variables and trying again:</code></pre>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="linear-regression.html#cb515-1" aria-hidden="true" tabindex="-1"></a>summary.out <span class="ot">&lt;-</span> <span class="fu">summary</span>(regsubsets.out)</span>
<span id="cb515-2"><a href="linear-regression.html#cb515-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-3"><a href="linear-regression.html#cb515-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(summary.out<span class="sc">$</span>bic, <span class="at">xlab =</span> <span class="st">&quot;Number of Variables&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;BIC&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb515-4"><a href="linear-regression.html#cb515-4" aria-hidden="true" tabindex="-1"></a>bic_min <span class="ot">=</span> <span class="fu">which.min</span>(summary.out<span class="sc">$</span>bic) <span class="co"># 6</span></span>
<span id="cb515-5"><a href="linear-regression.html#cb515-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(bic_min, summary.out<span class="sc">$</span>bic[bic_min], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="textbook_files/figure-html/unnamed-chunk-252-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="linear-regression.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with only one predictor</span></span>
<span id="cb516-2"><a href="linear-regression.html#cb516-2" aria-hidden="true" tabindex="-1"></a>summary.out<span class="sc">$</span>which[<span class="dv">1</span>,]</span></code></pre></div>
<pre><code>## (Intercept)           H         X2B         X3B          HR          SB 
##        TRUE       FALSE       FALSE       FALSE       FALSE       FALSE 
##          CS          BB          SO          BA         OBP         SLG 
##       FALSE       FALSE       FALSE       FALSE       FALSE       FALSE 
##         OPS          TB         GDP         HBP          SH          SF 
##        TRUE       FALSE       FALSE       FALSE       FALSE       FALSE 
##         LOB 
##       FALSE</code></pre>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="linear-regression.html#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with lowest BIC</span></span>
<span id="cb518-2"><a href="linear-regression.html#cb518-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which.min</span>(summary.out<span class="sc">$</span>bic)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="linear-regression.html#cb520-1" aria-hidden="true" tabindex="-1"></a>summary.out<span class="sc">$</span>which[<span class="fu">which.min</span>(summary.out<span class="sc">$</span>bic),]</span></code></pre></div>
<pre><code>## (Intercept)           H         X2B         X3B          HR          SB 
##        TRUE       FALSE       FALSE       FALSE       FALSE       FALSE 
##          CS          BB          SO          BA         OBP         SLG 
##        TRUE       FALSE       FALSE        TRUE        TRUE        TRUE 
##         OPS          TB         GDP         HBP          SH          SF 
##       FALSE        TRUE        TRUE       FALSE        TRUE        TRUE 
##         LOB 
##        TRUE</code></pre>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="linear-regression.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with highest Adj R^2</span></span>
<span id="cb522-2"><a href="linear-regression.html#cb522-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(summary.out<span class="sc">$</span>adjr2)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="linear-regression.html#cb524-1" aria-hidden="true" tabindex="-1"></a>summary.out<span class="sc">$</span>which[<span class="fu">which.max</span>(summary.out<span class="sc">$</span>adjr2),]</span></code></pre></div>
<pre><code>## (Intercept)           H         X2B         X3B          HR          SB 
##        TRUE        TRUE       FALSE       FALSE       FALSE       FALSE 
##          CS          BB          SO          BA         OBP         SLG 
##        TRUE       FALSE       FALSE        TRUE        TRUE       FALSE 
##         OPS          TB         GDP         HBP          SH          SF 
##        TRUE        TRUE        TRUE       FALSE        TRUE        TRUE 
##         LOB 
##        TRUE</code></pre>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="linear-regression.html#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model chosen to minimize BIC</span></span>
<span id="cb526-2"><a href="linear-regression.html#cb526-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(R.G<span class="sc">~</span>CS<span class="sc">+</span>BA<span class="sc">+</span>OBP<span class="sc">+</span>SLG<span class="sc">+</span>TB<span class="sc">+</span>GDP<span class="sc">+</span>SH<span class="sc">+</span>SF<span class="sc">+</span>LOB,<span class="at">data=</span>mlb_2022)</span>
<span id="cb526-3"><a href="linear-regression.html#cb526-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb526-4"><a href="linear-regression.html#cb526-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb526-5"><a href="linear-regression.html#cb526-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value)) <span class="sc">%&gt;%</span></span>
<span id="cb526-6"><a href="linear-regression.html#cb526-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">booktabs=</span>T,<span class="at">digits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb526-7"><a href="linear-regression.html#cb526-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;MR Model Estimating Runs Per Game Using Multiple Variables&quot;</span>,</span>
<span id="cb526-8"><a href="linear-regression.html#cb526-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Predictor&quot;</span>, <span class="st">&quot;Estimate&quot;</span>, <span class="st">&quot;Std Error&quot;</span>, <span class="st">&quot;t stat&quot;</span>, <span class="st">&quot;p-value&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb526-9"><a href="linear-regression.html#cb526-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-256">Table 8.12: </span>MR Model Estimating Runs Per Game Using Multiple Variables
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std Error
</th>
<th style="text-align:right;">
t stat
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
-0.382
</td>
<td style="text-align:right;">
0.420
</td>
<td style="text-align:right;">
-0.909
</td>
<td style="text-align:left;">
0.374
</td>
</tr>
<tr>
<td style="text-align:left;">
CS
</td>
<td style="text-align:right;">
-0.004
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
-2.582
</td>
<td style="text-align:left;">
0.018
</td>
</tr>
<tr>
<td style="text-align:left;">
BA
</td>
<td style="text-align:right;">
-25.454
</td>
<td style="text-align:right;">
2.544
</td>
<td style="text-align:right;">
-10.004
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
OBP
</td>
<td style="text-align:right;">
47.597
</td>
<td style="text-align:right;">
3.190
</td>
<td style="text-align:right;">
14.920
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
SLG
</td>
<td style="text-align:right;">
-43.279
</td>
<td style="text-align:right;">
4.999
</td>
<td style="text-align:right;">
-8.658
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
TB
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
10.082
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
GDP
</td>
<td style="text-align:right;">
-0.003
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
-5.654
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
SH
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
2.540
</td>
<td style="text-align:left;">
0.019
</td>
</tr>
<tr>
<td style="text-align:left;">
SF
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
6.207
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
LOB
</td>
<td style="text-align:right;">
-0.005
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
-10.590
</td>
<td style="text-align:left;">
&lt;0.001
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="confounding-variables" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Confounding Variables<a href="linear-regression.html#confounding-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="definition">
<p><span id="def:unlabeled-div-213" class="definition"><strong>Definition 8.3  </strong></span>A <strong><em>confounding variable</em></strong> is a variable that is correlated to a predictor variable and response variable that causes a spurious association.</p>
</div>
<div class="example">
<p><span id="exm:unlabeled-div-214" class="example"><strong>Example 8.6  </strong></span>A statistician hypothesizes that an NBA team’s draft position can be used to predict the number of regular-season wins for the team for the upcoming season. To investigate the relationship, they decide to estimate the following simple linear regression model:</p>
<p><span class="math inline">\(Wins\ = \beta_0 + \beta_1(Draft\ Position) + \epsilon_i\)</span></p>
<p>Using 2021-22 NBA data, the estimated intercept and slope for the model are:</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="linear-regression.html#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data: https://en.wikipedia.org/wiki/2021_NBA_draft</span></span>
<span id="cb527-2"><a href="linear-regression.html#cb527-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-3"><a href="linear-regression.html#cb527-3" aria-hidden="true" tabindex="-1"></a>NBA_Data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/NBA_Draft_and_Win_Data.csv&quot;</span>)</span>
<span id="cb527-4"><a href="linear-regression.html#cb527-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-5"><a href="linear-regression.html#cb527-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Wins_2021_2022 <span class="sc">~</span> Draft_Position_2021, <span class="at">data=</span>NBA_Data)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Wins_2021_2022 ~ Draft_Position_2021, data = NBA_Data)
## 
## Coefficients:
##         (Intercept)  Draft_Position_2021  
##             30.2621               0.6928</code></pre>
<p>Interpret the estimated slope in this model.</p>
</div>
<p>Recognizing that the SLR model may lead to erroneous lines of logic, the statistician decides to tackle the confounding by adding the wins for the team in the previous season to the model as a covariate. The theoretical model being estimated is now as follows:</p>
<p><span class="math inline">\(Wins\ = \beta_0 + \beta_1(Draft\ Position) + \beta_2(Previous\ Season\ Wins) + \epsilon_i\)</span></p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="linear-regression.html#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Wins_2021_2022 <span class="sc">~</span> Draft_Position_2021 <span class="sc">+</span> Wins_2020_2021_Scaled, <span class="at">data=</span>NBA_Data)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Wins_2021_2022 ~ Draft_Position_2021 + Wins_2020_2021_Scaled, 
##     data = NBA_Data)
## 
## Coefficients:
##           (Intercept)    Draft_Position_2021  Wins_2020_2021_Scaled  
##               -12.731                 -1.859                  2.013</code></pre>
<p>When controlling for an NBA team’s wins in the previous season, the sign for the slope coefficient for draft position flips to a negative. This suggests that for teams with the same winning percentage in the previous season, a lower draft position is associated with more wins in the following season. The results of this model, which included an important confounding variable, aligned with the conventional wisdom that lower draft positions are helpful for a team’s future success.</p>
<div style="page-break-after: always;"></div>
</div>
<div id="interaction" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Interaction<a href="linear-regression.html#interaction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(AM, page 222, strikeout rate vs. movement and velocity)</p>
</div>
<div id="confounding-variables-1" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> Confounding Variables<a href="linear-regression.html#confounding-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="logistic-regression" class="section level2 hasAnchor" number="8.9">
<h2><span class="header-section-number">8.9</span> Logistic Regression<a href="linear-regression.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sack-and-interception-probability-models" class="section level3 hasAnchor" number="8.9.1">
<h3><span class="header-section-number">8.9.1</span> Sack and Interception Probability Models<a href="linear-regression.html#sack-and-interception-probability-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(Mathletics, chapter 27, page 230)
(Mathletics, chapter 1, page 13)</p>
</div>
<div id="soccer-goal-logistic-model" class="section level3 hasAnchor" number="8.9.2">
<h3><span class="header-section-number">8.9.2</span> Soccer Goal Logistic Model<a href="linear-regression.html#soccer-goal-logistic-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(Mathletics, chapter 39, page 354)</p>
</div>
<div id="field-goal-success" class="section level3 hasAnchor" number="8.9.3">
<h3><span class="header-section-number">8.9.3</span> Field Goal Success<a href="linear-regression.html#field-goal-success" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(AM, page 266)</p>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-acquisition.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="principal-component-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aaron-nielsen/SportsAnalyticsBook/edit/master/08-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["textbook.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
